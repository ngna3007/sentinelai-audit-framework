PCI DSS 4_0_1 Requirement Control 6.4.3 Defined Approach Requirements: All payment page scripts that are loaded and executed in the consumer’s browser are managed as follows: A method is implemented to confirm that each script is authorized. A method is implemented to assure the integrity of each script. An inventory of all scripts is maintained with written business or technical justification as to why each is necessary. Customized Approach Objective: Unauthorized code cannot be executed in the payment page as it is rendered in the consumer’s browser. Testing Procedures: Testing Procedure 6.4.3.a: Examine policies and procedures to verify that processes are defined for managing all payment page scripts that are loaded and executed in the consumer’s browser, in accordance with all elements specified in this requirement. Testing Procedure 6.4.3.b: Interview responsible personnel and examine inventory records and system configurations to verify that all payment page scripts that are loaded and executed in the consumer’s browser are managed in accordance with all elements specified in this requirement. Guidance: Purpose: Scripts loaded and executed in the payment page can have their functionality altered without the entity’s knowledge and can also have the functionality to load additional external scripts (for example, advertising and tracking, tag management systems). such seemingly harmless scripts can be used by potential attackers to upload malicious scripts that can read and exfiltrate cardholder data from the consumer browser. ensuring that the functionality of all such scripts is understood to be necessary for the operation of the payment page minimizes the number of scripts that could be tampered with. ensuring that scripts have been explicitly authorized reduces the probability of unnecessary scripts being added to the payment page without appropriate management approval. where it is impractical for such authorization to occur before a script is changed or a new script is added to the page, the authorization should be confirmed as soon as possible after a change is made. using techniques to prevent tampering with the script will minimize the probability of the script being modified to carry out unauthorized behavior, such as skimming the cardholder data from the payment page. . Examples: The integrity of scripts can be enforced by several different mechanisms including, but not limited to: sub-resource integrity (sri), which allows the consumer browser to validate that a script has not been tampered with. a csp, which limits the locations the consumer browser can load a script from and transmit account data to. proprietary script or tag-management systems, which can prevent malicious script execution. Good Practice: Scripts may be authorized by manual or automated (e.g., workflow) processes. where the payment page will be loaded into an inline frame (iframe), restricting the location that the payment page can be loaded from, using the parent page’s content security policy (csp) can help prevent unauthorized content being substituted for the payment page. where an entity includes a tpsp’s/payment processor’s embedded payment page/form on its webpage, the entity should expect the tpsp/payment processor to provide evidence that the tpsp/payment processor is meeting this requirement, in accordance with the tpsp’s/payment processor’s pci dss assessment and requirement 12.9.