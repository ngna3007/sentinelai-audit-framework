AWS Config Developer Guide

Template

The template is available on GitHub: Operational Best Practices for PCI DSS 4.0 (Excluding global 
resource types).

Operational Best Practices for PCI DSS 4.0 (Including global resource 
types)

Conformance packs provide a general-purpose compliance framework designed to enable you 
to create security, operational or cost-optimization governance checks using managed or custom 
AWS Config rules and AWS Config remediation actions. Conformance Packs, as sample templates, 
are not designed to fully ensure compliance with a specific governance or compliance standard. 
You are responsible for making your own assessment of whether your use of the Services meets 
applicable legal and regulatory requirements.

The following provides a sample mapping between the Payment Card Industry Data Security 
Standard (PCI DSS) 4.0 (Excluding global resource types) and AWS managed Config rules. Each AWS 
Config rule applies to a specific AWS resource, and relates to one or more PCI DSS controls. A PCI 
DSS control can be related to multiple Config rules. Refer to the table below for more detail and 
guidance related to these mappings.

Control ID Control Description AWS Config Rule Guidance

1.2.5 Network security cloudfront-security- Ensure that Amazon 
controls (NSCs) policy-check CloudFront distribut 
are configured and ions are using a 
maintained. (PCI- minimum security 
DSS-v4.0) policy and cipher 

suite of TLSv1.2 or 
greater for viewer 
connections. This 
rule is NON_COMPL 
IANT for a CloudFron 
t distribution if 
the minimumPr 
otocolVersion is 
below TLSv1.2_2018.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13907



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.5 Network security cloudfront-sni-ena Ensure that Amazon 
controls (NSCs) bled CloudFront distribut 
are configured and ions are using a 
maintained. (PCI- custom SSL certifica 
DSS-v4.0) te and are configure 

d to use SNI to serve 
HTTPS requests. The 
rule is NON_COMPL 
IANT if a custom 
SSL certificate is 
associated but the 
SSL support method 
is a dedicated IP 
address.

1.2.5 Network security transfer-family-se Ensure that a 
controls (NSCs) rver-no-ftp server created 
are configured and with AWS Transfer 
maintained. (PCI- Family does not use 
DSS-v4.0) FTP for endpoint 

connection. The 
rule is NON_COMPL 
IANT if the server 
protocol for endpoint 
connection is FTP-
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13908



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.5 Network security cloudfront-no-depr Ensure that 
controls (NSCs) ecated-ssl-protocols CloudFront distribut 
are configured and ions are not using 
maintained. (PCI- deprecated SSL 
DSS-v4.0) protocols for HTTPS 

communication 
between CloudFron 
t edge locations and 
custom origins. This 
rule is NON_COMPL 
IANT for a CloudFron 
t distribution if 
any'OriginSslProto 
cols' includes'SSLv3'.

1.2.5 Network security cloudfront-traffic-to- Ensure that Amazon 
controls (NSCs) origin-encrypted CloudFront distribut 
are configured and ions are encryptin 
maintained. (PCI- g traffic to custom 
DSS-v4.0) origins. The rule is 

NON_COMPLIANT 
if'OriginProtocolP 
olicy' is'http-only' or 
if'OriginProtocolP 
olicy' is'match-viewer' 
and'ViewerProtocol 
Policy' is'allow-all'.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13909



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.5 Network security cloudfront-viewer- Ensure that your 
controls (NSCs) policy-https Amazon CloudFron 
are configured and t distributions use 
maintained. (PCI- HTTPS (directly or 
DSS-v4.0) via a redirection). The 

rule is NON_COMPL 
IANT if the value of 
ViewerProtocolPoli 
cy is set to 'allow-al 
l' for the DefaultCa 
cheBehavior or for 
the CacheBehaviors.

1.2.8 Network security api-gw-endpoint-ty Ensure that Amazon 
controls (NSCs) pe-check API Gateway APIs are 
are configured and of the type specified 
maintained. (PCI- in the rule parameter 
DSS-v4.0) 'endpointConfigura 

tionType'. The rule 
returns NON_COMPL 
IANT if the REST 
API does not match 
the endpoint type 
configured in the rule 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13910



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.8 Network security cloudfront-associa Ensure that Amazon 
controls (NSCs) ted-with-waf CloudFront distribut 
are configured and ions are associate 
maintained. (PCI- d with either web 
DSS-v4.0) application firewall 

(WAF) or WAFv2 web 
access control lists 
(ACLs). The rule is 
NON_COMPLIANT if a 
CloudFront distribut 
ion is not associated 
with a WAF web ACL.

1.2.8 Network security cloudfront-custom- Ensure that the 
controls (NSCs) ssl-certificate certificate associate 
are configured and d with an Amazon 
maintained. (PCI- CloudFront distribut 
DSS-v4.0) ion is not the default 

SSL certificate. The 
rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13911



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.8 Network security netfw-policy-defau Ensure that an AWS 
controls (NSCs) lt-action-fragment- Network Firewall 
are configured and packets policy is configured 
maintained. (PCI- with a user defined 
DSS-v4.0) stateless default 

action for fragmente 
d packets. The rule 
is NON_COMPLIANT 
if stateless default 
action for fragmente 
d packets does not 
match with user 
defined default 
action.

1.2.8 Network security rds-db-security-gr Ensure that the 
controls (NSCs) oup-not-allowed Amazon Relationa 
are configured and l Database Service 
maintained. (PCI- (Amazon RDS) DB 
DSS-v4.0) security groups is the 

default one. The rule 
is NON_COMPLIANT 
if there are any DB 
security groups that 
are not the default 
DB security group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13912



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.8 Network security ec2-transit-gatewa Ensure that Amazon 
controls (NSCs) y-auto-vpc-attach- Elastic Compute 
are configured and disabled Cloud (Amazon EC2) 
maintained. (PCI- Transit Gateways do 
DSS-v4.0) not have 'AutoAcce 

ptSharedAttachment 
s' enabled. The rule is 
NON_COMPLIANT for 
a Transit Gateway if 
'AutoAcceptSharedA 
ttachments' is set to 
'enable'.

1.2.8 Network security eks-endpoint-no-pu Ensure that the 
controls (NSCs) blic-access Amazon Elastic 
are configured and Kubernetes Service 
maintained. (PCI- (Amazon EKS) 
DSS-v4.0) endpoint is not 

publicly accessibl 
e. The rule is 
NON_COMPLIANT 
if the endpoint is 
publicly accessible.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13913



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.8 Network security restricted-ssh Note: For this rule, 
controls (NSCs) the rule identifie 
are configured and r (INCOMING 
maintained. (PCI- _SSH_DISABLED) 
DSS-v4.0) and rule name 

(restricted-ssh) are 
different. Ensure 
that the incoming 
SSH traffic for the 
security groups is 
accessible. The rule 
is COMPLIANT if the 
IP addresses of the 
incoming SSH traffic 
in the security groups 
are restricted (CIDR 
other than 0.0.0.0/0 
or ::/0). Otherwise, 
NON_COMPLIANT.

1.2.8 Network security appsync-associated- Ensure that AWS 
controls (NSCs) with-waf AppSync APIs are 
are configured and associated with 
maintained. (PCI- AWS WAFv2 web 
DSS-v4.0) access control lists 

(ACLs). The rule is 
NON_COMPLIANT for 
an AWS AppSync API 
if it is not associated 
with a web ACL.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13914



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.8 Network security docdb-cluster-snap Ensure that Amazon 
controls (NSCs) shot-public-prohib DocumentDB manual 
are configured and ited cluster snapshots 
maintained. (PCI- are not public. The 
DSS-v4.0) rule is NON_COMPL 

IANT if any Amazon 
DocumentDB manual 
cluster snapshots are 
public.

1.2.8 Network security codebuild-project- Ensure that the 
controls (NSCs) source-repo-url-check Bitbucket source 
are configured and repository URL 
maintained. (PCI- DOES NOT contain 
DSS-v4.0) sign-in credentials 

or not. The rule is 
NON_COMPLIANT if 
the URL contains any 
sign-in information 
and COMPLIANT if it 
doesn't.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13915



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.8 Network security elb-acm-certificate- Ensure that the 
controls (NSCs) required Classic Load 
are configured and Balancers use SSL 
maintained. (PCI- certificates provided 
DSS-v4.0) by AWS Certifica 

te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

1.2.8 Network security emr-block-public-a Ensure that an 
controls (NSCs) ccess account with Amazon 
are configured and EMR has block public 
maintained. (PCI- access settings 
DSS-v4.0) enabled. The rule is 

NON_COMPLIANT if 
BlockPublicSecurit 
yGroupRules is false, 
or if true, ports other 
than Port 22 are 
listed in Permitted 
PublicSecurityGrou 
pRuleRanges.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13916



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.8 Network security nacl-no-unrestricted- Ensure that default 
controls (NSCs) ssh-rdp ports for SSH/RDP 
are configured and ingress traffic for 
maintained. (PCI- network access 
DSS-v4.0) control lists (NACLs) 

are restricted. The 
rule is NON_COMPL 
IANT if a NACL 
inbound entry allows 
a source TCP or UDP 
CIDR block for ports 
22 or 3389.

1.2.8 Network security waf-global-webacl- Ensure that a WAF 
controls (NSCs) not-empty Global Web ACL 
are configured and contains some 
maintained. (PCI- WAF rules or rule 
DSS-v4.0) groups. This rule is 

NON_COMPLIANT if 
a Web ACL does not 
contain any WAF rule 
or rule group.

1.2.8 Network security waf-global-rulegro Ensure that an AWS 
controls (NSCs) up-not-empty WAF Classic rule 
are configured and group contains some 
maintained. (PCI- rules. The rule is 
DSS-v4.0) NON_COMPLIANT 

if there are no rules 
present within a rule 
group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13917



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.8 Network security waf-global-rule-not- Ensure that an 
controls (NSCs) empty AWS WAF global 
are configured and rule contains some 
maintained. (PCI- conditions. The rule 
DSS-v4.0) is NON_COMPLIANT 

if no conditions are 
present within the 
WAF global rule.

1.2.8 Network security ec2-client-vpn-not- Ensure that the 
controls (NSCs) authorize-all AWS Client VPN 
are configured and authorization rules 
maintained. (PCI- does not authorize 
DSS-v4.0) connection access for 

all clients. The rule is 
NON_COMPLIANT if 
'AccessAll' is present 
and set to true.

1.2.8 Network security internet-gateway-a Ensure that internet 
controls (NSCs) uthorized-vpc-only gateways are 
are configured and attached to an 
maintained. (PCI- authorized virtual 
DSS-v4.0) private cloud 

(Amazon VPC). The 
rule is NON_COMPL 
IANT if internet 
gateways are 
attached to an 
unauthorized VPC.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13918



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.2.8 Network security s3-access-point-pu Ensure that Amazon 
controls (NSCs) blic-access-blocks S3 access points have 
are configured and block public access 
maintained. (PCI- settings enabled. The 
DSS-v4.0) rule is NON_COMPL 

IANT if block public 
access settings are 
not enabled for S3 
access points.

1.2.8 Network security s3-account-level-p Ensure that the 
controls (NSCs) ublic-access-blocks required public 
are configured and access block settings 
maintained. (PCI- are configured 
DSS-v4.0) from account level. 

The rule is only 
NON_COMPLIANT 
when the fields set 
below do not match 
the corresponding 
fields in the configura 
tion item.

1.3.1 Network access api-gw-endpoint-ty Ensure that Amazon 
to and from the pe-check API Gateway APIs are 
cardholder data of the type specified 
environment is in the rule parameter 
restricted. (PCI-DSS- 'endpointConfigura 
v4.0) tionType'. The rule 

returns NON_COMPL 
IANT if the REST 
API does not match 
the endpoint type 
configured in the rule 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13919



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.1 Network access cloudfront-associa Ensure that Amazon 
to and from the ted-with-waf CloudFront distribut 
cardholder data ions are associate 
environment is d with either web 
restricted. (PCI-DSS- application firewall 
v4.0) (WAF) or WAFv2 web 

access control lists 
(ACLs). The rule is 
NON_COMPLIANT if a 
CloudFront distribut 
ion is not associated 
with a WAF web ACL.

1.3.1 Network access cloudfront-custom- Ensure that the 
to and from the ssl-certificate certificate associate 
cardholder data d with an Amazon 
environment is CloudFront distribut 
restricted. (PCI-DSS- ion is not the default 
v4.0) SSL certificate. The 

rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13920



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.1 Network access netfw-policy-defau Ensure that an AWS 
to and from the lt-action-fragment- Network Firewall 
cardholder data packets policy is configured 
environment is with a user defined 
restricted. (PCI-DSS- stateless default 
v4.0) action for fragmente 

d packets. The rule 
is NON_COMPLIANT 
if stateless default 
action for fragmente 
d packets does not 
match with user 
defined default 
action.

1.3.1 Network access rds-db-security-gr Ensure that the 
to and from the oup-not-allowed Amazon Relationa 
cardholder data l Database Service 
environment is (Amazon RDS) DB 
restricted. (PCI-DSS- security groups is the 
v4.0) default one. The rule 

is NON_COMPLIANT 
if there are any DB 
security groups that 
are not the default 
DB security group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13921



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.1 Network access redshift-enhanced- Ensure that Amazon 
to and from the vpc-routing-enabled Redshift clusters have 
cardholder data 'enhancedVpcRoutin 
environment is g' enabled. The rule is 
restricted. (PCI-DSS- NON_COMPLIANT if 
v4.0) 'enhancedVpcRoutin 

g' is not enabled 
or if the configura 
tion.enhancedVpcRo 
uting field is 'false'.

1.3.1 Network access ec2-transit-gatewa Ensure that Amazon 
to and from the y-auto-vpc-attach- Elastic Compute 
cardholder data disabled Cloud (Amazon EC2) 
environment is Transit Gateways do 
restricted. (PCI-DSS- not have 'AutoAcce 
v4.0) ptSharedAttachment 

s' enabled. The rule is 
NON_COMPLIANT for 
a Transit Gateway if 
'AutoAcceptSharedA 
ttachments' is set to 
'enable'.

1.3.1 Network access eks-endpoint-no-pu Ensure that the 
to and from the blic-access Amazon Elastic 
cardholder data Kubernetes Service 
environment is (Amazon EKS) 
restricted. (PCI-DSS- endpoint is not 
v4.0) publicly accessibl 

e. The rule is 
NON_COMPLIANT 
if the endpoint is 
publicly accessible.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13922



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.1 Network access restricted-ssh Note: For this rule, 
to and from the the rule identifie 
cardholder data r (INCOMING 
environment is _SSH_DISABLED) 
restricted. (PCI-DSS- and rule name 
v4.0) (restricted-ssh) are 

different. Ensure 
that the incoming 
SSH traffic for the 
security groups is 
accessible. The rule 
is COMPLIANT if the 
IP addresses of the 
incoming SSH traffic 
in the security groups 
are restricted (CIDR 
other than 0.0.0.0/0 
or ::/0). Otherwise, 
NON_COMPLIANT.

1.3.1 Network access appsync-associated- Ensure that AWS 
to and from the with-waf AppSync APIs are 
cardholder data associated with 
environment is AWS WAFv2 web 
restricted. (PCI-DSS- access control lists 
v4.0) (ACLs). The rule is 

NON_COMPLIANT for 
an AWS AppSync API 
if it is not associated 
with a web ACL.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13923



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.1 Network access docdb-cluster-snap Ensure that Amazon 
to and from the shot-public-prohib DocumentDB manual 
cardholder data ited cluster snapshots 
environment is are not public. The 
restricted. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if any Amazon 

DocumentDB manual 
cluster snapshots are 
public.

1.3.1 Network access codebuild-project- Ensure that the 
to and from the source-repo-url-check Bitbucket source 
cardholder data repository URL 
environment is DOES NOT contain 
restricted. (PCI-DSS- sign-in credentials 
v4.0) or not. The rule is 

NON_COMPLIANT if 
the URL contains any 
sign-in information 
and COMPLIANT if it 
doesn't.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13924



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.1 Network access elb-acm-certificate- Ensure that the 
to and from the required Classic Load 
cardholder data Balancers use SSL 
environment is certificates provided 
restricted. (PCI-DSS- by AWS Certifica 
v4.0) te Manager. To use 

this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

1.3.1 Network access emr-block-public-a Ensure that an 
to and from the ccess account with Amazon 
cardholder data EMR has block public 
environment is access settings 
restricted. (PCI-DSS- enabled. The rule is 
v4.0) NON_COMPLIANT if 

BlockPublicSecurit 
yGroupRules is false, 
or if true, ports other 
than Port 22 are 
listed in Permitted 
PublicSecurityGrou 
pRuleRanges.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13925



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.1 Network access nacl-no-unrestricted- Ensure that default 
to and from the ssh-rdp ports for SSH/RDP 
cardholder data ingress traffic for 
environment is network access 
restricted. (PCI-DSS- control lists (NACLs) 
v4.0) are restricted. The 

rule is NON_COMPL 
IANT if a NACL 
inbound entry allows 
a source TCP or UDP 
CIDR block for ports 
22 or 3389.

1.3.1 Network access waf-global-webacl- Ensure that a WAF 
to and from the not-empty Global Web ACL 
cardholder data contains some 
environment is WAF rules or rule 
restricted. (PCI-DSS- groups. This rule is 
v4.0) NON_COMPLIANT if 

a Web ACL does not 
contain any WAF rule 
or rule group.

1.3.1 Network access waf-global-rulegro Ensure that an AWS 
to and from the up-not-empty WAF Classic rule 
cardholder data group contains some 
environment is rules. The rule is 
restricted. (PCI-DSS- NON_COMPLIANT 
v4.0) if there are no rules 

present within a rule 
group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13926



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.1 Network access waf-global-rule-not- Ensure that an 
to and from the empty AWS WAF global 
cardholder data rule contains some 
environment is conditions. The rule 
restricted. (PCI-DSS- is NON_COMPLIANT 
v4.0) if no conditions are 

present within the 
WAF global rule.

1.3.1 Network access ec2-client-vpn-not- Ensure that the 
to and from the authorize-all AWS Client VPN 
cardholder data authorization rules 
environment is does not authorize 
restricted. (PCI-DSS- connection access for 
v4.0) all clients. The rule is 

NON_COMPLIANT if 
'AccessAll' is present 
and set to true.

1.3.1 Network access internet-gateway-a Ensure that internet 
to and from the uthorized-vpc-only gateways are 
cardholder data attached to an 
environment is authorized virtual 
restricted. (PCI-DSS- private cloud 
v4.0) (Amazon VPC). The 

rule is NON_COMPL 
IANT if internet 
gateways are 
attached to an 
unauthorized VPC.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13927



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.1 Network access s3-access-point-pu Ensure that Amazon 
to and from the blic-access-blocks S3 access points have 
cardholder data block public access 
environment is settings enabled. The 
restricted. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if block public 

access settings are 
not enabled for S3 
access points.

1.3.1 Network access s3-account-level-p Ensure that the 
to and from the ublic-access-blocks required public 
cardholder data access block settings 
environment is are configured 
restricted. (PCI-DSS- from account level. 
v4.0) The rule is only 

NON_COMPLIANT 
when the fields set 
below do not match 
the corresponding 
fields in the configura 
tion item.

1.3.2 Network access api-gw-endpoint-ty Ensure that Amazon 
to and from the pe-check API Gateway APIs are 
cardholder data of the type specified 
environment is in the rule parameter 
restricted. (PCI-DSS- 'endpointConfigura 
v4.0) tionType'. The rule 

returns NON_COMPL 
IANT if the REST 
API does not match 
the endpoint type 
configured in the rule 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13928



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.2 Network access cloudfront-associa Ensure that Amazon 
to and from the ted-with-waf CloudFront distribut 
cardholder data ions are associate 
environment is d with either web 
restricted. (PCI-DSS- application firewall 
v4.0) (WAF) or WAFv2 web 

access control lists 
(ACLs). The rule is 
NON_COMPLIANT if a 
CloudFront distribut 
ion is not associated 
with a WAF web ACL.

1.3.2 Network access cloudfront-custom- Ensure that the 
to and from the ssl-certificate certificate associate 
cardholder data d with an Amazon 
environment is CloudFront distribut 
restricted. (PCI-DSS- ion is not the default 
v4.0) SSL certificate. The 

rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13929



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.2 Network access netfw-policy-defau Ensure that an AWS 
to and from the lt-action-fragment- Network Firewall 
cardholder data packets policy is configured 
environment is with a user defined 
restricted. (PCI-DSS- stateless default 
v4.0) action for fragmente 

d packets. The rule 
is NON_COMPLIANT 
if stateless default 
action for fragmente 
d packets does not 
match with user 
defined default 
action.

1.3.2 Network access rds-db-security-gr Ensure that the 
to and from the oup-not-allowed Amazon Relationa 
cardholder data l Database Service 
environment is (Amazon RDS) DB 
restricted. (PCI-DSS- security groups is the 
v4.0) default one. The rule 

is NON_COMPLIANT 
if there are any DB 
security groups that 
are not the default 
DB security group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13930



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.2 Network access redshift-enhanced- Ensure that Amazon 
to and from the vpc-routing-enabled Redshift clusters have 
cardholder data 'enhancedVpcRoutin 
environment is g' enabled. The rule is 
restricted. (PCI-DSS- NON_COMPLIANT if 
v4.0) 'enhancedVpcRoutin 

g' is not enabled 
or if the configura 
tion.enhancedVpcRo 
uting field is 'false'.

1.3.2 Network access ec2-transit-gatewa Ensure that Amazon 
to and from the y-auto-vpc-attach- Elastic Compute 
cardholder data disabled Cloud (Amazon EC2) 
environment is Transit Gateways do 
restricted. (PCI-DSS- not have 'AutoAcce 
v4.0) ptSharedAttachment 

s' enabled. The rule is 
NON_COMPLIANT for 
a Transit Gateway if 
'AutoAcceptSharedA 
ttachments' is set to 
'enable'.

1.3.2 Network access eks-endpoint-no-pu Ensure that the 
to and from the blic-access Amazon Elastic 
cardholder data Kubernetes Service 
environment is (Amazon EKS) 
restricted. (PCI-DSS- endpoint is not 
v4.0) publicly accessibl 

e. The rule is 
NON_COMPLIANT 
if the endpoint is 
publicly accessible.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13931



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.2 Network access restricted-ssh Note: For this rule, 
to and from the the rule identifie 
cardholder data r (INCOMING 
environment is _SSH_DISABLED) 
restricted. (PCI-DSS- and rule name 
v4.0) (restricted-ssh) are 

different. Ensure 
that the incoming 
SSH traffic for the 
security groups is 
accessible. The rule 
is COMPLIANT if the 
IP addresses of the 
incoming SSH traffic 
in the security groups 
are restricted (CIDR 
other than 0.0.0.0/0 
or ::/0). Otherwise, 
NON_COMPLIANT.

1.3.2 Network access appsync-associated- Ensure that AWS 
to and from the with-waf AppSync APIs are 
cardholder data associated with 
environment is AWS WAFv2 web 
restricted. (PCI-DSS- access control lists 
v4.0) (ACLs). The rule is 

NON_COMPLIANT for 
an AWS AppSync API 
if it is not associated 
with a web ACL.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13932



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.2 Network access docdb-cluster-snap Ensure that Amazon 
to and from the shot-public-prohib DocumentDB manual 
cardholder data ited cluster snapshots 
environment is are not public. The 
restricted. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if any Amazon 

DocumentDB manual 
cluster snapshots are 
public.

1.3.2 Network access codebuild-project- Ensure that the 
to and from the source-repo-url-check Bitbucket source 
cardholder data repository URL 
environment is DOES NOT contain 
restricted. (PCI-DSS- sign-in credentials 
v4.0) or not. The rule is 

NON_COMPLIANT if 
the URL contains any 
sign-in information 
and COMPLIANT if it 
doesn't.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13933



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.2 Network access elb-acm-certificate- Ensure that the 
to and from the required Classic Load 
cardholder data Balancers use SSL 
environment is certificates provided 
restricted. (PCI-DSS- by AWS Certifica 
v4.0) te Manager. To use 

this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

1.3.2 Network access emr-block-public-a Ensure that an 
to and from the ccess account with Amazon 
cardholder data EMR has block public 
environment is access settings 
restricted. (PCI-DSS- enabled. The rule is 
v4.0) NON_COMPLIANT if 

BlockPublicSecurit 
yGroupRules is false, 
or if true, ports other 
than Port 22 are 
listed in Permitted 
PublicSecurityGrou 
pRuleRanges.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13934



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.2 Network access nacl-no-unrestricted- Ensure that default 
to and from the ssh-rdp ports for SSH/RDP 
cardholder data ingress traffic for 
environment is network access 
restricted. (PCI-DSS- control lists (NACLs) 
v4.0) are restricted. The 

rule is NON_COMPL 
IANT if a NACL 
inbound entry allows 
a source TCP or UDP 
CIDR block for ports 
22 or 3389.

1.3.2 Network access waf-global-webacl- Ensure that a WAF 
to and from the not-empty Global Web ACL 
cardholder data contains some 
environment is WAF rules or rule 
restricted. (PCI-DSS- groups. This rule is 
v4.0) NON_COMPLIANT if 

a Web ACL does not 
contain any WAF rule 
or rule group.

1.3.2 Network access waf-global-rulegro Ensure that an AWS 
to and from the up-not-empty WAF Classic rule 
cardholder data group contains some 
environment is rules. The rule is 
restricted. (PCI-DSS- NON_COMPLIANT 
v4.0) if there are no rules 

present within a rule 
group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13935



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.2 Network access waf-global-rule-not- Ensure that an 
to and from the empty AWS WAF global 
cardholder data rule contains some 
environment is conditions. The rule 
restricted. (PCI-DSS- is NON_COMPLIANT 
v4.0) if no conditions are 

present within the 
WAF global rule.

1.3.2 Network access ec2-client-vpn-not- Ensure that the 
to and from the authorize-all AWS Client VPN 
cardholder data authorization rules 
environment is does not authorize 
restricted. (PCI-DSS- connection access for 
v4.0) all clients. The rule is 

NON_COMPLIANT if 
'AccessAll' is present 
and set to true.

1.3.2 Network access internet-gateway-a Ensure that internet 
to and from the uthorized-vpc-only gateways are 
cardholder data attached to an 
environment is authorized virtual 
restricted. (PCI-DSS- private cloud 
v4.0) (Amazon VPC). The 

rule is NON_COMPL 
IANT if internet 
gateways are 
attached to an 
unauthorized VPC.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13936



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.3.2 Network access s3-access-point-pu Ensure that Amazon 
to and from the blic-access-blocks S3 access points have 
cardholder data block public access 
environment is settings enabled. The 
restricted. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if block public 

access settings are 
not enabled for S3 
access points.

1.3.2 Network access s3-account-level-p Ensure that the 
to and from the ublic-access-blocks required public 
cardholder data access block settings 
environment is are configured 
restricted. (PCI-DSS- from account level. 
v4.0) The rule is only 

NON_COMPLIANT 
when the fields set 
below do not match 
the corresponding 
fields in the configura 
tion item.

1.4.1 Network connections api-gw-endpoint-ty Ensure that Amazon 
between trusted and pe-check API Gateway APIs are 
untrusted networks of the type specified 
are controlled. (PCI- in the rule parameter 
DSS-v4.0) 'endpointConfigura 

tionType'. The rule 
returns NON_COMPL 
IANT if the REST 
API does not match 
the endpoint type 
configured in the rule 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13937



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.1 Network connections redshift-enhanced- Ensure that Amazon 
between trusted and vpc-routing-enabled Redshift clusters have 
untrusted networks 'enhancedVpcRoutin 
are controlled. (PCI- g' enabled. The rule is 
DSS-v4.0) NON_COMPLIANT if 

'enhancedVpcRoutin 
g' is not enabled 
or if the configura 
tion.enhancedVpcRo 
uting field is 'false'.

1.4.1 Network connections internet-gateway-a Ensure that internet 
between trusted and uthorized-vpc-only gateways are 
untrusted networks attached to an 
are controlled. (PCI- authorized virtual 
DSS-v4.0) private cloud 

(Amazon VPC). The 
rule is NON_COMPL 
IANT if internet 
gateways are 
attached to an 
unauthorized VPC.

1.4.2 Network connections api-gw-endpoint-ty Ensure that Amazon 
between trusted and pe-check API Gateway APIs are 
untrusted networks of the type specified 
are controlled. (PCI- in the rule parameter 
DSS-v4.0) 'endpointConfigura 

tionType'. The rule 
returns NON_COMPL 
IANT if the REST 
API does not match 
the endpoint type 
configured in the rule 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13938



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.2 Network connections cloudfront-associa Ensure that Amazon 
between trusted and ted-with-waf CloudFront distribut 
untrusted networks ions are associate 
are controlled. (PCI- d with either web 
DSS-v4.0) application firewall 

(WAF) or WAFv2 web 
access control lists 
(ACLs). The rule is 
NON_COMPLIANT if a 
CloudFront distribut 
ion is not associated 
with a WAF web ACL.

1.4.2 Network connections cloudfront-custom- Ensure that the 
between trusted and ssl-certificate certificate associate 
untrusted networks d with an Amazon 
are controlled. (PCI- CloudFront distribut 
DSS-v4.0) ion is not the default 

SSL certificate. The 
rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13939



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.2 Network connections netfw-policy-defau Ensure that an AWS 
between trusted and lt-action-fragment- Network Firewall 
untrusted networks packets policy is configured 
are controlled. (PCI- with a user defined 
DSS-v4.0) stateless default 

action for fragmente 
d packets. The rule 
is NON_COMPLIANT 
if stateless default 
action for fragmente 
d packets does not 
match with user 
defined default 
action.

1.4.2 Network connections rds-db-security-gr Ensure that the 
between trusted and oup-not-allowed Amazon Relationa 
untrusted networks l Database Service 
are controlled. (PCI- (Amazon RDS) DB 
DSS-v4.0) security groups is the 

default one. The rule 
is NON_COMPLIANT 
if there are any DB 
security groups that 
are not the default 
DB security group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13940



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.2 Network connections redshift-enhanced- Ensure that Amazon 
between trusted and vpc-routing-enabled Redshift clusters have 
untrusted networks 'enhancedVpcRoutin 
are controlled. (PCI- g' enabled. The rule is 
DSS-v4.0) NON_COMPLIANT if 

'enhancedVpcRoutin 
g' is not enabled 
or if the configura 
tion.enhancedVpcRo 
uting field is 'false'.

1.4.2 Network connections ec2-transit-gatewa Ensure that Amazon 
between trusted and y-auto-vpc-attach- Elastic Compute 
untrusted networks disabled Cloud (Amazon EC2) 
are controlled. (PCI- Transit Gateways do 
DSS-v4.0) not have 'AutoAcce 

ptSharedAttachment 
s' enabled. The rule is 
NON_COMPLIANT for 
a Transit Gateway if 
'AutoAcceptSharedA 
ttachments' is set to 
'enable'.

1.4.2 Network connections eks-endpoint-no-pu Ensure that the 
between trusted and blic-access Amazon Elastic 
untrusted networks Kubernetes Service 
are controlled. (PCI- (Amazon EKS) 
DSS-v4.0) endpoint is not 

publicly accessibl 
e. The rule is 
NON_COMPLIANT 
if the endpoint is 
publicly accessible.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13941



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.2 Network connections restricted-ssh Note: For this rule, 
between trusted and the rule identifie 
untrusted networks r (INCOMING 
are controlled. (PCI- _SSH_DISABLED) 
DSS-v4.0) and rule name 

(restricted-ssh) are 
different. Ensure 
that the incoming 
SSH traffic for the 
security groups is 
accessible. The rule 
is COMPLIANT if the 
IP addresses of the 
incoming SSH traffic 
in the security groups 
are restricted (CIDR 
other than 0.0.0.0/0 
or ::/0). Otherwise, 
NON_COMPLIANT.

1.4.2 Network connections appsync-associated- Ensure that AWS 
between trusted and with-waf AppSync APIs are 
untrusted networks associated with 
are controlled. (PCI- AWS WAFv2 web 
DSS-v4.0) access control lists 

(ACLs). The rule is 
NON_COMPLIANT for 
an AWS AppSync API 
if it is not associated 
with a web ACL.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13942



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.2 Network connections docdb-cluster-snap Ensure that Amazon 
between trusted and shot-public-prohib DocumentDB manual 
untrusted networks ited cluster snapshots 
are controlled. (PCI- are not public. The 
DSS-v4.0) rule is NON_COMPL 

IANT if any Amazon 
DocumentDB manual 
cluster snapshots are 
public.

1.4.2 Network connections codebuild-project- Ensure that the 
between trusted and source-repo-url-check Bitbucket source 
untrusted networks repository URL 
are controlled. (PCI- DOES NOT contain 
DSS-v4.0) sign-in credentials 

or not. The rule is 
NON_COMPLIANT if 
the URL contains any 
sign-in information 
and COMPLIANT if it 
doesn't.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13943



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.2 Network connections elb-acm-certificate- Ensure that the 
between trusted and required Classic Load 
untrusted networks Balancers use SSL 
are controlled. (PCI- certificates provided 
DSS-v4.0) by AWS Certifica 

te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

1.4.2 Network connections emr-block-public-a Ensure that an 
between trusted and ccess account with Amazon 
untrusted networks EMR has block public 
are controlled. (PCI- access settings 
DSS-v4.0) enabled. The rule is 

NON_COMPLIANT if 
BlockPublicSecurit 
yGroupRules is false, 
or if true, ports other 
than Port 22 are 
listed in Permitted 
PublicSecurityGrou 
pRuleRanges.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13944



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.2 Network connections nacl-no-unrestricted- Ensure that default 
between trusted and ssh-rdp ports for SSH/RDP 
untrusted networks ingress traffic for 
are controlled. (PCI- network access 
DSS-v4.0) control lists (NACLs) 

are restricted. The 
rule is NON_COMPL 
IANT if a NACL 
inbound entry allows 
a source TCP or UDP 
CIDR block for ports 
22 or 3389.

1.4.2 Network connections waf-global-webacl- Ensure that a WAF 
between trusted and not-empty Global Web ACL 
untrusted networks contains some 
are controlled. (PCI- WAF rules or rule 
DSS-v4.0) groups. This rule is 

NON_COMPLIANT if 
a Web ACL does not 
contain any WAF rule 
or rule group.

1.4.2 Network connections waf-global-rulegro Ensure that an AWS 
between trusted and up-not-empty WAF Classic rule 
untrusted networks group contains some 
are controlled. (PCI- rules. The rule is 
DSS-v4.0) NON_COMPLIANT 

if there are no rules 
present within a rule 
group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13945



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.2 Network connections waf-global-rule-not- Ensure that an 
between trusted and empty AWS WAF global 
untrusted networks rule contains some 
are controlled. (PCI- conditions. The rule 
DSS-v4.0) is NON_COMPLIANT 

if no conditions are 
present within the 
WAF global rule.

1.4.2 Network connections ec2-client-vpn-not- Ensure that the 
between trusted and authorize-all AWS Client VPN 
untrusted networks authorization rules 
are controlled. (PCI- does not authorize 
DSS-v4.0) connection access for 

all clients. The rule is 
NON_COMPLIANT if 
'AccessAll' is present 
and set to true.

1.4.2 Network connections internet-gateway-a Ensure that internet 
between trusted and uthorized-vpc-only gateways are 
untrusted networks attached to an 
are controlled. (PCI- authorized virtual 
DSS-v4.0) private cloud 

(Amazon VPC). The 
rule is NON_COMPL 
IANT if internet 
gateways are 
attached to an 
unauthorized VPC.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13946



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.2 Network connections s3-access-point-pu Ensure that Amazon 
between trusted and blic-access-blocks S3 access points have 
untrusted networks block public access 
are controlled. (PCI- settings enabled. The 
DSS-v4.0) rule is NON_COMPL 

IANT if block public 
access settings are 
not enabled for S3 
access points.

1.4.2 Network connections s3-account-level-p Ensure that the 
between trusted and ublic-access-blocks required public 
untrusted networks access block settings 
are controlled. (PCI- are configured 
DSS-v4.0) from account level. 

The rule is only 
NON_COMPLIANT 
when the fields set 
below do not match 
the corresponding 
fields in the configura 
tion item.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13947



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.3 Network connections netfw-policy-defau Ensure that an AWS 
between trusted and lt-action-fragment- Network Firewall 
untrusted networks packets policy is configured 
are controlled. (PCI- with a user defined 
DSS-v4.0) stateless default 

action for fragmente 
d packets. The rule 
is NON_COMPLIANT 
if stateless default 
action for fragmente 
d packets does not 
match with user 
defined default 
action.

1.4.3 Network connections netfw-policy-defau Ensure that an AWS 
between trusted and lt-action-fragment- Network Firewall 
untrusted networks packets policy is configured 
are controlled. (PCI- with a user defined 
DSS-v4.0) stateless default 

action for fragmente 
d packets. The rule 
is NON_COMPLIANT 
if stateless default 
action for fragmente 
d packets does not 
match with user 
defined default 
action.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13948



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.3 Network connections netfw-policy-default- Ensure that an AWS 
between trusted and action-full-packets Network Firewall 
untrusted networks policy is configured 
are controlled. (PCI- with a user defined 
DSS-v4.0) default stateless 

action for full 
packets. This rule is 
NON_COMPLIANT 
if default stateless 
action for full packets 
does not match with 
user defined default 
stateless action.

1.4.4 Network connections api-gw-endpoint-ty Ensure that Amazon 
between trusted and pe-check API Gateway APIs are 
untrusted networks of the type specified 
are controlled. (PCI- in the rule parameter 
DSS-v4.0) 'endpointConfigura 

tionType'. The rule 
returns NON_COMPL 
IANT if the REST 
API does not match 
the endpoint type 
configured in the rule 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13949



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.4 Network connections redshift-enhanced- Ensure that Amazon 
between trusted and vpc-routing-enabled Redshift clusters have 
untrusted networks 'enhancedVpcRoutin 
are controlled. (PCI- g' enabled. The rule is 
DSS-v4.0) NON_COMPLIANT if 

'enhancedVpcRoutin 
g' is not enabled 
or if the configura 
tion.enhancedVpcRo 
uting field is 'false'.

1.4.4 Network connections internet-gateway-a Ensure that internet 
between trusted and uthorized-vpc-only gateways are 
untrusted networks attached to an 
are controlled. (PCI- authorized virtual 
DSS-v4.0) private cloud 

(Amazon VPC). The 
rule is NON_COMPL 
IANT if internet 
gateways are 
attached to an 
unauthorized VPC.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13950



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.4.5 Network connections ecs-task-definition- Ensure that 
between trusted and pid-mode-check ECSTaskDefinitions 
untrusted networks are configured 
are controlled. (PCI- to share a host's 
DSS-v4.0) process namespace 

with its Amazon 
Elastic Container 
Service (Amazon 
ECS) containers. The 
rule is NON_COMPL 
IANT if the pidMode 
parameter is set 
to'host'.

1.4.5 Network connections ec2-launch-template- Ensure that Amazon 
between trusted and public-ip-disabled EC2 Launch 
untrusted networks Templates are not set 
are controlled. (PCI- to assign public IP 
DSS-v4.0) addresses to Network 

Interfaces. The rule 
is NON_COMPL 
IANT if the default 
version of an EC2 
Launch Template has 
at least 1 Network 
Interface with 
'AssociatePublicIp 
Address' set to 'true'.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13951



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.5.1 Risks to the CDE api-gw-endpoint-ty Ensure that Amazon 
from computing pe-check API Gateway APIs are 
devices that are able of the type specified 
to connect to both in the rule parameter 
untrusted networks 'endpointConfigura 
and the CDE are tionType'. The rule 
mitigated. (PCI-DSS- returns NON_COMPL 
v4.0) IANT if the REST 

API does not match 
the endpoint type 
configured in the rule 
parameter.

1.5.1 Risks to the CDE cloudfront-associa Ensure that Amazon 
from computing ted-with-waf CloudFront distribut 
devices that are able ions are associate 
to connect to both d with either web 
untrusted networks application firewall 
and the CDE are (WAF) or WAFv2 web 
mitigated. (PCI-DSS- access control lists 
v4.0) (ACLs). The rule is 

NON_COMPLIANT if a 
CloudFront distribut 
ion is not associated 
with a WAF web ACL.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13952



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.5.1 Risks to the CDE cloudfront-custom- Ensure that the 
from computing ssl-certificate certificate associate 
devices that are able d with an Amazon 
to connect to both CloudFront distribut 
untrusted networks ion is not the default 
and the CDE are SSL certificate. The 
mitigated. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if a CloudFront 

distribution uses the 
default SSL certifica 
te.

1.5.1 Risks to the CDE netfw-policy-defau Ensure that an AWS 
from computing lt-action-fragment- Network Firewall 
devices that are able packets policy is configured 
to connect to both with a user defined 
untrusted networks stateless default 
and the CDE are action for fragmente 
mitigated. (PCI-DSS- d packets. The rule 
v4.0) is NON_COMPLIANT 

if stateless default 
action for fragmente 
d packets does not 
match with user 
defined default 
action.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13953



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.5.1 Risks to the CDE rds-db-security-gr Ensure that the 
from computing oup-not-allowed Amazon Relationa 
devices that are able l Database Service 
to connect to both (Amazon RDS) DB 
untrusted networks security groups is the 
and the CDE are default one. The rule 
mitigated. (PCI-DSS- is NON_COMPLIANT 
v4.0) if there are any DB 

security groups that 
are not the default 
DB security group.

1.5.1 Risks to the CDE ec2-transit-gatewa Ensure that Amazon 
from computing y-auto-vpc-attach- Elastic Compute 
devices that are able disabled Cloud (Amazon EC2) 
to connect to both Transit Gateways do 
untrusted networks not have 'AutoAcce 
and the CDE are ptSharedAttachment 
mitigated. (PCI-DSS- s' enabled. The rule is 
v4.0) NON_COMPLIANT for 

a Transit Gateway if 
'AutoAcceptSharedA 
ttachments' is set to 
'enable'.

1.5.1 Risks to the CDE eks-endpoint-no-pu Ensure that the 
from computing blic-access Amazon Elastic 
devices that are able Kubernetes Service 
to connect to both (Amazon EKS) 
untrusted networks endpoint is not 
and the CDE are publicly accessibl 
mitigated. (PCI-DSS- e. The rule is 
v4.0) NON_COMPLIANT 

if the endpoint is 
publicly accessible.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13954



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.5.1 Risks to the CDE restricted-ssh Note: For this rule, 
from computing the rule identifie 
devices that are able r (INCOMING 
to connect to both _SSH_DISABLED) 
untrusted networks and rule name 
and the CDE are (restricted-ssh) are 
mitigated. (PCI-DSS- different. Ensure 
v4.0) that the incoming 

SSH traffic for the 
security groups is 
accessible. The rule 
is COMPLIANT if the 
IP addresses of the 
incoming SSH traffic 
in the security groups 
are restricted (CIDR 
other than 0.0.0.0/0 
or ::/0). Otherwise, 
NON_COMPLIANT.

1.5.1 Risks to the CDE appsync-associated- Ensure that AWS 
from computing with-waf AppSync APIs are 
devices that are able associated with 
to connect to both AWS WAFv2 web 
untrusted networks access control lists 
and the CDE are (ACLs). The rule is 
mitigated. (PCI-DSS- NON_COMPLIANT for 
v4.0) an AWS AppSync API 

if it is not associated 
with a web ACL.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13955



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.5.1 Risks to the CDE docdb-cluster-snap Ensure that Amazon 
from computing shot-public-prohib DocumentDB manual 
devices that are able ited cluster snapshots 
to connect to both are not public. The 
untrusted networks rule is NON_COMPL 
and the CDE are IANT if any Amazon 
mitigated. (PCI-DSS- DocumentDB manual 
v4.0) cluster snapshots are 

public.

1.5.1 Risks to the CDE codebuild-project- Ensure that the 
from computing source-repo-url-check Bitbucket source 
devices that are able repository URL 
to connect to both DOES NOT contain 
untrusted networks sign-in credentials 
and the CDE are or not. The rule is 
mitigated. (PCI-DSS- NON_COMPLIANT if 
v4.0) the URL contains any 

sign-in information 
and COMPLIANT if it 
doesn't.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13956



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.5.1 Risks to the CDE elb-acm-certificate- Ensure that the 
from computing required Classic Load 
devices that are able Balancers use SSL 
to connect to both certificates provided 
untrusted networks by AWS Certifica 
and the CDE are te Manager. To use 
mitigated. (PCI-DSS- this rule, use an SSL 
v4.0) or HTTPS listener 

with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

1.5.1 Risks to the CDE emr-block-public-a Ensure that an 
from computing ccess account with Amazon 
devices that are able EMR has block public 
to connect to both access settings 
untrusted networks enabled. The rule is 
and the CDE are NON_COMPLIANT if 
mitigated. (PCI-DSS- BlockPublicSecurit 
v4.0) yGroupRules is false, 

or if true, ports other 
than Port 22 are 
listed in Permitted 
PublicSecurityGrou 
pRuleRanges.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13957



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.5.1 Risks to the CDE nacl-no-unrestricted- Ensure that default 
from computing ssh-rdp ports for SSH/RDP 
devices that are able ingress traffic for 
to connect to both network access 
untrusted networks control lists (NACLs) 
and the CDE are are restricted. The 
mitigated. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if a NACL 

inbound entry allows 
a source TCP or UDP 
CIDR block for ports 
22 or 3389.

1.5.1 Risks to the CDE waf-global-webacl- Ensure that a WAF 
from computing not-empty Global Web ACL 
devices that are able contains some 
to connect to both WAF rules or rule 
untrusted networks groups. This rule is 
and the CDE are NON_COMPLIANT if 
mitigated. (PCI-DSS- a Web ACL does not 
v4.0) contain any WAF rule 

or rule group.

1.5.1 Risks to the CDE waf-global-rulegro Ensure that an AWS 
from computing up-not-empty WAF Classic rule 
devices that are able group contains some 
to connect to both rules. The rule is 
untrusted networks NON_COMPLIANT 
and the CDE are if there are no rules 
mitigated. (PCI-DSS- present within a rule 
v4.0) group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13958



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.5.1 Risks to the CDE waf-global-rule-not- Ensure that an 
from computing empty AWS WAF global 
devices that are able rule contains some 
to connect to both conditions. The rule 
untrusted networks is NON_COMPLIANT 
and the CDE are if no conditions are 
mitigated. (PCI-DSS- present within the 
v4.0) WAF global rule.

1.5.1 Risks to the CDE ec2-client-vpn-not- Ensure that the 
from computing authorize-all AWS Client VPN 
devices that are able authorization rules 
to connect to both does not authorize 
untrusted networks connection access for 
and the CDE are all clients. The rule is 
mitigated. (PCI-DSS- NON_COMPLIANT if 
v4.0) 'AccessAll' is present 

and set to true.

1.5.1 Risks to the CDE internet-gateway-a Ensure that internet 
from computing uthorized-vpc-only gateways are 
devices that are able attached to an 
to connect to both authorized virtual 
untrusted networks private cloud 
and the CDE are (Amazon VPC). The 
mitigated. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if internet 

gateways are 
attached to an 
unauthorized VPC.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13959



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

1.5.1 Risks to the CDE s3-access-point-pu Ensure that Amazon 
from computing blic-access-blocks S3 access points have 
devices that are able block public access 
to connect to both settings enabled. The 
untrusted networks rule is NON_COMPL 
and the CDE are IANT if block public 
mitigated. (PCI-DSS- access settings are 
v4.0) not enabled for S3 

access points.

1.5.1 Risks to the CDE s3-account-level-p Ensure that the 
from computing ublic-access-blocks required public 
devices that are able access block settings 
to connect to both are configured 
untrusted networks from account level. 
and the CDE are The rule is only 
mitigated. (PCI-DSS- NON_COMPLIANT 
v4.0) when the fields set 

below do not match 
the corresponding 
fields in the configura 
tion item.

10.2.1 Audit logs are api-gwv2-access-lo Ensure that Amazon 
implemented to gs-enabled API Gateway V2 
support the detection stages have access 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if 'accessLo 
analysis of events. gSettings' is not 
(PCI-DSS-v4.0) present in Stage 

configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13960



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1 Audit logs are api-gw-xray-enabled Ensure that AWS 
implemented to X-Ray tracing is 
support the detection enabled on Amazon 
of anomalies and API Gateway REST 
suspicious activity, APIs. The rule is 
and the forensic COMPLIANT if X-Ray 
analysis of events. tracing is enabled 
(PCI-DSS-v4.0) and NON_COMPL 

IANT otherwise.

10.2.1 Audit logs are cloudfront-accessl Ensure that Amazon 
implemented to ogs-enabled CloudFront distribut 
support the detection ions are configure 
of anomalies and d to deliver access 
suspicious activity, logs to an Amazon 
and the forensic S3 bucket. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) CloudFront distribut 

ion does not have 
logging configured.

10.2.1 Audit logs are neptune-cluster-cl Ensure that an 
implemented to oudwatch-log-expor Amazon Neptune 
support the detection t-enabled cluster has 
of anomalies and CloudWatch log 
suspicious activity, export enabled for 
and the forensic audit logs. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) Neptune cluster does 

not have CloudWatc 
h log export enabled 
for audit logs.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13961



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1 Audit logs are ecs-task-definition- Ensure that logConfig 
implemented to log-configuration uration is set on 
support the detection active ECS Task 
of anomalies and Definitions. This 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if an active 
analysis of events. ECSTaskDefinition 
(PCI-DSS-v4.0) does not have the 

logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

10.2.1 Audit logs are cloudtrail-enabled Note: For this rule, 
implemented to the rule identifie 
support the detection r (CLOUD_TR 
of anomalies and AIL_ENABLED) and 
suspicious activity, rule name (cloudtrail-
and the forensic enabled) are different 
analysis of events. . Ensure that an AWS 
(PCI-DSS-v4.0) CloudTrail trail is 

enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13962



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1 Audit logs are multi-region-cloud Note: for this rule, 
implemented to trail-enabled the rule identifie 
support the detection r (MULTI_RE 
of anomalies and GION_CLOU 
suspicious activity, D_TRAIL_ENABLED) 
and the forensic and rule name 
analysis of events. (multi-region-clou 
(PCI-DSS-v4.0) dtrail-enabled) are 

different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13963



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1 Audit logs are appsync-logging-en Ensure that an AWS 
implemented to abled AppSync API has 
support the detection logging enabled. The 
of anomalies and rule is NON_COMPL 
suspicious activity, IANT if logging is not 
and the forensic enabled, or 'fieldLog 
analysis of events. Level' is neither 
(PCI-DSS-v4.0) ERROR nor ALL.

10.2.1 Audit logs are waf-classic-logging- Ensure that logging is 
implemented to enabled enabled on AWS WAF 
support the detection classic global web 
of anomalies and access control lists 
suspicious activity, (web ACLs). The rule 
and the forensic is NON_COMPLIANT 
analysis of events. for a global web ACL, 
(PCI-DSS-v4.0) if it does not have 

logging enabled.

10.2.1 Audit logs are mq-cloudwatch-audi Ensure that Amazon 
implemented to t-logging-enabled MQ brokers have 
support the detection Amazon CloudWatc 
of anomalies and h audit logging 
suspicious activity, enabled. The rule is 
and the forensic NON_COMPLIANT 
analysis of events. if a broker does not 
(PCI-DSS-v4.0) have audit logging 

enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13964



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1 Audit logs are mq-cloudwatch-audi Ensure that an 
implemented to t-log-enabled Amazon MQ broker 
support the detection has CloudWatch audit 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if the broker 
analysis of events. does not have audit 
(PCI-DSS-v4.0) logging enabled.

10.2.1 Audit logs are eks-cluster-logging- Ensure that an 
implemented to enabled Amazon Elastic 
support the detection Kubernetes Service 
of anomalies and (Amazon EKS) cluster 
suspicious activity, is configured with 
and the forensic logging enabled. The 
analysis of events. rule is NON_COMPL 
(PCI-DSS-v4.0) IANT if logging for 

Amazon EKS clusters 
is not enabled for all 
log types.

10.2.1 Audit logs are elastic-beanstalk- Ensure that AWS 
implemented to logs-to-cloudwatch Elastic Beanstalk 
support the detection environments 
of anomalies and are configured 
suspicious activity, to send logs to 
and the forensic Amazon CloudWatc 
analysis of events. h Logs. The rule 
(PCI-DSS-v4.0) is NON_COMPL 

IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13965



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1 Audit logs are step-functions-sta Ensure that AWS 
implemented to te-machine-logging- Step Functions 
support the detection enabled machine has logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a state machine does 
analysis of events. not have logging 
(PCI-DSS-v4.0) enabled or the 

logging configura 
tion is not at the 
minimum level 
provided.

10.2.1 Audit logs are netfw-logging-enab Ensure that AWS 
implemented to led Network Firewall 
support the detection firewalls have logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a logging type is not 
analysis of events. configured. You can 
(PCI-DSS-v4.0) specify which logging 

type you want the 
rule to check.

10.2.1.1 Audit logs are api-gwv2-access-lo Ensure that Amazon 
implemented to gs-enabled API Gateway V2 
support the detection stages have access 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if 'accessLo 
analysis of events. gSettings' is not 
(PCI-DSS-v4.0) present in Stage 

configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13966



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.1 Audit logs are api-gw-xray-enabled Ensure that AWS 
implemented to X-Ray tracing is 
support the detection enabled on Amazon 
of anomalies and API Gateway REST 
suspicious activity, APIs. The rule is 
and the forensic COMPLIANT if X-Ray 
analysis of events. tracing is enabled 
(PCI-DSS-v4.0) and NON_COMPL 

IANT otherwise.

10.2.1.1 Audit logs are cloudfront-accessl Ensure that Amazon 
implemented to ogs-enabled CloudFront distribut 
support the detection ions are configure 
of anomalies and d to deliver access 
suspicious activity, logs to an Amazon 
and the forensic S3 bucket. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) CloudFront distribut 

ion does not have 
logging configured.

10.2.1.1 Audit logs are neptune-cluster-cl Ensure that an 
implemented to oudwatch-log-expor Amazon Neptune 
support the detection t-enabled cluster has 
of anomalies and CloudWatch log 
suspicious activity, export enabled for 
and the forensic audit logs. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) Neptune cluster does 

not have CloudWatc 
h log export enabled 
for audit logs.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13967



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.1 Audit logs are ec2-instance-detai Ensure that detailed 
implemented to led-monitoring-ena monitoring is 
support the detection bled enabled for EC2 
of anomalies and instances. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic detailed monitoring 
analysis of events. is not enabled.
(PCI-DSS-v4.0)

10.2.1.1 Audit logs are ecs-task-definition- Ensure that logConfig 
implemented to log-configuration uration is set on 
support the detection active ECS Task 
of anomalies and Definitions. This 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if an active 
analysis of events. ECSTaskDefinition 
(PCI-DSS-v4.0) does not have the 

logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13968



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.1 Audit logs are cloudwatch-alarm-a Ensure that 
implemented to ction-check CloudWatch alarms 
support the detection have an action 
of anomalies and configured for the 
suspicious activity, ALARM, INSUFFICI 
and the forensic ENT_DATA, or OK 
analysis of events. state. Optionall 
(PCI-DSS-v4.0) y ensure that any 

actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.2.1.1 Audit logs are cloudwatch-alarm-a Ensure that 
implemented to ction-check CloudWatch alarms 
support the detection have an action 
of anomalies and configured for the 
suspicious activity, ALARM, INSUFFICI 
and the forensic ENT_DATA, or OK 
analysis of events. state. Optionall 
(PCI-DSS-v4.0) y ensure that any 

actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13969



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.1 Audit logs are cloudwatch-alarm-a Ensure that 
implemented to ction-check CloudWatch alarms 
support the detection have an action 
of anomalies and configured for the 
suspicious activity, ALARM, INSUFFICI 
and the forensic ENT_DATA, or OK 
analysis of events. state. Optionall 
(PCI-DSS-v4.0) y ensure that any 

actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.2.1.1 Audit logs are cloudwatch-alarm-r Ensure that a 
implemented to esource-check resource type has a 
support the detection CloudWatch alarm 
of anomalies and for the named metric. 
suspicious activity, For resource type, 
and the forensic you can specify 
analysis of events. EBS volumes, EC2 
(PCI-DSS-v4.0) instances, Amazon 

RDS clusters, or S3 
buckets. The rule is 
COMPLIANT if the 
named metric has 
a resource ID and 
CloudWatch alarm.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13970



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.1 Audit logs are cloudtrail-enabled Note: For this rule, 
implemented to the rule identifie 
support the detection r (CLOUD_TR 
of anomalies and AIL_ENABLED) and 
suspicious activity, rule name (cloudtrail-
and the forensic enabled) are different 
analysis of events. . Ensure that an AWS 
(PCI-DSS-v4.0) CloudTrail trail is 

enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13971



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.1 Audit logs are multi-region-cloud Note: for this rule, 
implemented to trail-enabled the rule identifie 
support the detection r (MULTI_RE 
of anomalies and GION_CLOU 
suspicious activity, D_TRAIL_ENABLED) 
and the forensic and rule name 
analysis of events. (multi-region-clou 
(PCI-DSS-v4.0) dtrail-enabled) are 

different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13972



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.1 Audit logs are appsync-logging-en Ensure that an AWS 
implemented to abled AppSync API has 
support the detection logging enabled. The 
of anomalies and rule is NON_COMPL 
suspicious activity, IANT if logging is not 
and the forensic enabled, or 'fieldLog 
analysis of events. Level' is neither 
(PCI-DSS-v4.0) ERROR nor ALL.

10.2.1.1 Audit logs are waf-classic-logging- Ensure that logging is 
implemented to enabled enabled on AWS WAF 
support the detection classic global web 
of anomalies and access control lists 
suspicious activity, (web ACLs). The rule 
and the forensic is NON_COMPLIANT 
analysis of events. for a global web ACL, 
(PCI-DSS-v4.0) if it does not have 

logging enabled.

10.2.1.1 Audit logs are mq-cloudwatch-audi Ensure that Amazon 
implemented to t-logging-enabled MQ brokers have 
support the detection Amazon CloudWatc 
of anomalies and h audit logging 
suspicious activity, enabled. The rule is 
and the forensic NON_COMPLIANT 
analysis of events. if a broker does not 
(PCI-DSS-v4.0) have audit logging 

enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13973



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.1 Audit logs are mq-cloudwatch-audi Ensure that an 
implemented to t-log-enabled Amazon MQ broker 
support the detection has CloudWatch audit 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if the broker 
analysis of events. does not have audit 
(PCI-DSS-v4.0) logging enabled.

10.2.1.1 Audit logs are eks-cluster-logging- Ensure that an 
implemented to enabled Amazon Elastic 
support the detection Kubernetes Service 
of anomalies and (Amazon EKS) cluster 
suspicious activity, is configured with 
and the forensic logging enabled. The 
analysis of events. rule is NON_COMPL 
(PCI-DSS-v4.0) IANT if logging for 

Amazon EKS clusters 
is not enabled for all 
log types.

10.2.1.1 Audit logs are elastic-beanstalk- Ensure that AWS 
implemented to logs-to-cloudwatch Elastic Beanstalk 
support the detection environments 
of anomalies and are configured 
suspicious activity, to send logs to 
and the forensic Amazon CloudWatc 
analysis of events. h Logs. The rule 
(PCI-DSS-v4.0) is NON_COMPL 

IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13974



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.1 Audit logs are wafv2-rulegroup-lo Ensure that Amazon 
implemented to gging-enabled CloudWatch security 
support the detection metrics collectio 
of anomalies and n on AWS WAFv2 
suspicious activity, rule groups is 
and the forensic enabled. The rule is 
analysis of events. NON_COMPLIANT if 
(PCI-DSS-v4.0) the 'VisibilityConfig. 

CloudWatchMetricsE 
nabled' field is set to 
false.

10.2.1.1 Audit logs are sns-topic-message- Ensure that Amazon 
implemented to delivery-notification- Simple Notification 
support the detection enabled Service (SNS) logging 
of anomalies and is enabled for the 
suspicious activity, delivery status of 
and the forensic notification messages 
analysis of events. sent to a topic for 
(PCI-DSS-v4.0) the endpoints. The 

rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13975



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.1 Audit logs are step-functions-sta Ensure that AWS 
implemented to te-machine-logging- Step Functions 
support the detection enabled machine has logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a state machine does 
analysis of events. not have logging 
(PCI-DSS-v4.0) enabled or the 

logging configura 
tion is not at the 
minimum level 
provided.

10.2.1.1 Audit logs are netfw-logging-enab Ensure that AWS 
implemented to led Network Firewall 
support the detection firewalls have logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a logging type is not 
analysis of events. configured. You can 
(PCI-DSS-v4.0) specify which logging 

type you want the 
rule to check.

10.2.1.2 Audit logs are api-gwv2-access-lo Ensure that Amazon 
implemented to gs-enabled API Gateway V2 
support the detection stages have access 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if 'accessLo 
analysis of events. gSettings' is not 
(PCI-DSS-v4.0) present in Stage 

configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13976



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.2 Audit logs are api-gw-xray-enabled Ensure that AWS 
implemented to X-Ray tracing is 
support the detection enabled on Amazon 
of anomalies and API Gateway REST 
suspicious activity, APIs. The rule is 
and the forensic COMPLIANT if X-Ray 
analysis of events. tracing is enabled 
(PCI-DSS-v4.0) and NON_COMPL 

IANT otherwise.

10.2.1.2 Audit logs are cloudfront-accessl Ensure that Amazon 
implemented to ogs-enabled CloudFront distribut 
support the detection ions are configure 
of anomalies and d to deliver access 
suspicious activity, logs to an Amazon 
and the forensic S3 bucket. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) CloudFront distribut 

ion does not have 
logging configured.

10.2.1.2 Audit logs are neptune-cluster-cl Ensure that an 
implemented to oudwatch-log-expor Amazon Neptune 
support the detection t-enabled cluster has 
of anomalies and CloudWatch log 
suspicious activity, export enabled for 
and the forensic audit logs. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) Neptune cluster does 

not have CloudWatc 
h log export enabled 
for audit logs.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13977



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.2 Audit logs are ecs-task-definition- Ensure that logConfig 
implemented to log-configuration uration is set on 
support the detection active ECS Task 
of anomalies and Definitions. This 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if an active 
analysis of events. ECSTaskDefinition 
(PCI-DSS-v4.0) does not have the 

logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

10.2.1.2 Audit logs are cloudtrail-enabled Note: For this rule, 
implemented to the rule identifie 
support the detection r (CLOUD_TR 
of anomalies and AIL_ENABLED) and 
suspicious activity, rule name (cloudtrail-
and the forensic enabled) are different 
analysis of events. . Ensure that an AWS 
(PCI-DSS-v4.0) CloudTrail trail is 

enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13978



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.2 Audit logs are multi-region-cloud Note: for this rule, 
implemented to trail-enabled the rule identifie 
support the detection r (MULTI_RE 
of anomalies and GION_CLOU 
suspicious activity, D_TRAIL_ENABLED) 
and the forensic and rule name 
analysis of events. (multi-region-clou 
(PCI-DSS-v4.0) dtrail-enabled) are 

different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13979



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.2 Audit logs are appsync-logging-en Ensure that an AWS 
implemented to abled AppSync API has 
support the detection logging enabled. The 
of anomalies and rule is NON_COMPL 
suspicious activity, IANT if logging is not 
and the forensic enabled, or 'fieldLog 
analysis of events. Level' is neither 
(PCI-DSS-v4.0) ERROR nor ALL.

10.2.1.2 Audit logs are waf-classic-logging- Ensure that logging is 
implemented to enabled enabled on AWS WAF 
support the detection classic global web 
of anomalies and access control lists 
suspicious activity, (web ACLs). The rule 
and the forensic is NON_COMPLIANT 
analysis of events. for a global web ACL, 
(PCI-DSS-v4.0) if it does not have 

logging enabled.

10.2.1.2 Audit logs are mq-cloudwatch-audi Ensure that Amazon 
implemented to t-logging-enabled MQ brokers have 
support the detection Amazon CloudWatc 
of anomalies and h audit logging 
suspicious activity, enabled. The rule is 
and the forensic NON_COMPLIANT 
analysis of events. if a broker does not 
(PCI-DSS-v4.0) have audit logging 

enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13980



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.2 Audit logs are mq-cloudwatch-audi Ensure that an 
implemented to t-log-enabled Amazon MQ broker 
support the detection has CloudWatch audit 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if the broker 
analysis of events. does not have audit 
(PCI-DSS-v4.0) logging enabled.

10.2.1.2 Audit logs are eks-cluster-logging- Ensure that an 
implemented to enabled Amazon Elastic 
support the detection Kubernetes Service 
of anomalies and (Amazon EKS) cluster 
suspicious activity, is configured with 
and the forensic logging enabled. The 
analysis of events. rule is NON_COMPL 
(PCI-DSS-v4.0) IANT if logging for 

Amazon EKS clusters 
is not enabled for all 
log types.

10.2.1.2 Audit logs are elastic-beanstalk- Ensure that AWS 
implemented to logs-to-cloudwatch Elastic Beanstalk 
support the detection environments 
of anomalies and are configured 
suspicious activity, to send logs to 
and the forensic Amazon CloudWatc 
analysis of events. h Logs. The rule 
(PCI-DSS-v4.0) is NON_COMPL 

IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13981



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.2 Audit logs are step-functions-sta Ensure that AWS 
implemented to te-machine-logging- Step Functions 
support the detection enabled machine has logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a state machine does 
analysis of events. not have logging 
(PCI-DSS-v4.0) enabled or the 

logging configura 
tion is not at the 
minimum level 
provided.

10.2.1.2 Audit logs are netfw-logging-enab Ensure that AWS 
implemented to led Network Firewall 
support the detection firewalls have logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a logging type is not 
analysis of events. configured. You can 
(PCI-DSS-v4.0) specify which logging 

type you want the 
rule to check.

10.2.1.3 Audit logs are api-gwv2-access-lo Ensure that Amazon 
implemented to gs-enabled API Gateway V2 
support the detection stages have access 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if 'accessLo 
analysis of events. gSettings' is not 
(PCI-DSS-v4.0) present in Stage 

configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13982



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.3 Audit logs are api-gw-xray-enabled Ensure that AWS 
implemented to X-Ray tracing is 
support the detection enabled on Amazon 
of anomalies and API Gateway REST 
suspicious activity, APIs. The rule is 
and the forensic COMPLIANT if X-Ray 
analysis of events. tracing is enabled 
(PCI-DSS-v4.0) and NON_COMPL 

IANT otherwise.

10.2.1.3 Audit logs are cloudfront-accessl Ensure that Amazon 
implemented to ogs-enabled CloudFront distribut 
support the detection ions are configure 
of anomalies and d to deliver access 
suspicious activity, logs to an Amazon 
and the forensic S3 bucket. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) CloudFront distribut 

ion does not have 
logging configured.

10.2.1.3 Audit logs are neptune-cluster-cl Ensure that an 
implemented to oudwatch-log-expor Amazon Neptune 
support the detection t-enabled cluster has 
of anomalies and CloudWatch log 
suspicious activity, export enabled for 
and the forensic audit logs. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) Neptune cluster does 

not have CloudWatc 
h log export enabled 
for audit logs.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13983



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.3 Audit logs are ecs-task-definition- Ensure that logConfig 
implemented to log-configuration uration is set on 
support the detection active ECS Task 
of anomalies and Definitions. This 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if an active 
analysis of events. ECSTaskDefinition 
(PCI-DSS-v4.0) does not have the 

logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

10.2.1.3 Audit logs are cloudtrail-enabled Note: For this rule, 
implemented to the rule identifie 
support the detection r (CLOUD_TR 
of anomalies and AIL_ENABLED) and 
suspicious activity, rule name (cloudtrail-
and the forensic enabled) are different 
analysis of events. . Ensure that an AWS 
(PCI-DSS-v4.0) CloudTrail trail is 

enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13984



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.3 Audit logs are multi-region-cloud Note: for this rule, 
implemented to trail-enabled the rule identifie 
support the detection r (MULTI_RE 
of anomalies and GION_CLOU 
suspicious activity, D_TRAIL_ENABLED) 
and the forensic and rule name 
analysis of events. (multi-region-clou 
(PCI-DSS-v4.0) dtrail-enabled) are 

different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13985



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.3 Audit logs are appsync-logging-en Ensure that an AWS 
implemented to abled AppSync API has 
support the detection logging enabled. The 
of anomalies and rule is NON_COMPL 
suspicious activity, IANT if logging is not 
and the forensic enabled, or 'fieldLog 
analysis of events. Level' is neither 
(PCI-DSS-v4.0) ERROR nor ALL.

10.2.1.3 Audit logs are waf-classic-logging- Ensure that logging is 
implemented to enabled enabled on AWS WAF 
support the detection classic global web 
of anomalies and access control lists 
suspicious activity, (web ACLs). The rule 
and the forensic is NON_COMPLIANT 
analysis of events. for a global web ACL, 
(PCI-DSS-v4.0) if it does not have 

logging enabled.

10.2.1.3 Audit logs are mq-cloudwatch-audi Ensure that Amazon 
implemented to t-logging-enabled MQ brokers have 
support the detection Amazon CloudWatc 
of anomalies and h audit logging 
suspicious activity, enabled. The rule is 
and the forensic NON_COMPLIANT 
analysis of events. if a broker does not 
(PCI-DSS-v4.0) have audit logging 

enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13986



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.3 Audit logs are mq-cloudwatch-audi Ensure that an 
implemented to t-log-enabled Amazon MQ broker 
support the detection has CloudWatch audit 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if the broker 
analysis of events. does not have audit 
(PCI-DSS-v4.0) logging enabled.

10.2.1.3 Audit logs are eks-cluster-logging- Ensure that an 
implemented to enabled Amazon Elastic 
support the detection Kubernetes Service 
of anomalies and (Amazon EKS) cluster 
suspicious activity, is configured with 
and the forensic logging enabled. The 
analysis of events. rule is NON_COMPL 
(PCI-DSS-v4.0) IANT if logging for 

Amazon EKS clusters 
is not enabled for all 
log types.

10.2.1.3 Audit logs are elastic-beanstalk- Ensure that AWS 
implemented to logs-to-cloudwatch Elastic Beanstalk 
support the detection environments 
of anomalies and are configured 
suspicious activity, to send logs to 
and the forensic Amazon CloudWatc 
analysis of events. h Logs. The rule 
(PCI-DSS-v4.0) is NON_COMPL 

IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13987



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.3 Audit logs are step-functions-sta Ensure that AWS 
implemented to te-machine-logging- Step Functions 
support the detection enabled machine has logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a state machine does 
analysis of events. not have logging 
(PCI-DSS-v4.0) enabled or the 

logging configura 
tion is not at the 
minimum level 
provided.

10.2.1.3 Audit logs are netfw-logging-enab Ensure that AWS 
implemented to led Network Firewall 
support the detection firewalls have logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a logging type is not 
analysis of events. configured. You can 
(PCI-DSS-v4.0) specify which logging 

type you want the 
rule to check.

10.2.1.4 Audit logs are api-gwv2-access-lo Ensure that Amazon 
implemented to gs-enabled API Gateway V2 
support the detection stages have access 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if 'accessLo 
analysis of events. gSettings' is not 
(PCI-DSS-v4.0) present in Stage 

configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13988



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.4 Audit logs are api-gw-xray-enabled Ensure that AWS 
implemented to X-Ray tracing is 
support the detection enabled on Amazon 
of anomalies and API Gateway REST 
suspicious activity, APIs. The rule is 
and the forensic COMPLIANT if X-Ray 
analysis of events. tracing is enabled 
(PCI-DSS-v4.0) and NON_COMPL 

IANT otherwise.

10.2.1.4 Audit logs are cloudfront-accessl Ensure that Amazon 
implemented to ogs-enabled CloudFront distribut 
support the detection ions are configure 
of anomalies and d to deliver access 
suspicious activity, logs to an Amazon 
and the forensic S3 bucket. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) CloudFront distribut 

ion does not have 
logging configured.

10.2.1.4 Audit logs are neptune-cluster-cl Ensure that an 
implemented to oudwatch-log-expor Amazon Neptune 
support the detection t-enabled cluster has 
of anomalies and CloudWatch log 
suspicious activity, export enabled for 
and the forensic audit logs. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) Neptune cluster does 

not have CloudWatc 
h log export enabled 
for audit logs.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13989



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.4 Audit logs are ecs-task-definition- Ensure that logConfig 
implemented to log-configuration uration is set on 
support the detection active ECS Task 
of anomalies and Definitions. This 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if an active 
analysis of events. ECSTaskDefinition 
(PCI-DSS-v4.0) does not have the 

logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

10.2.1.4 Audit logs are cloudtrail-enabled Note: For this rule, 
implemented to the rule identifie 
support the detection r (CLOUD_TR 
of anomalies and AIL_ENABLED) and 
suspicious activity, rule name (cloudtrail-
and the forensic enabled) are different 
analysis of events. . Ensure that an AWS 
(PCI-DSS-v4.0) CloudTrail trail is 

enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13990



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.4 Audit logs are multi-region-cloud Note: for this rule, 
implemented to trail-enabled the rule identifie 
support the detection r (MULTI_RE 
of anomalies and GION_CLOU 
suspicious activity, D_TRAIL_ENABLED) 
and the forensic and rule name 
analysis of events. (multi-region-clou 
(PCI-DSS-v4.0) dtrail-enabled) are 

different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13991



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.4 Audit logs are appsync-logging-en Ensure that an AWS 
implemented to abled AppSync API has 
support the detection logging enabled. The 
of anomalies and rule is NON_COMPL 
suspicious activity, IANT if logging is not 
and the forensic enabled, or 'fieldLog 
analysis of events. Level' is neither 
(PCI-DSS-v4.0) ERROR nor ALL.

10.2.1.4 Audit logs are waf-classic-logging- Ensure that logging is 
implemented to enabled enabled on AWS WAF 
support the detection classic global web 
of anomalies and access control lists 
suspicious activity, (web ACLs). The rule 
and the forensic is NON_COMPLIANT 
analysis of events. for a global web ACL, 
(PCI-DSS-v4.0) if it does not have 

logging enabled.

10.2.1.4 Audit logs are mq-cloudwatch-audi Ensure that Amazon 
implemented to t-logging-enabled MQ brokers have 
support the detection Amazon CloudWatc 
of anomalies and h audit logging 
suspicious activity, enabled. The rule is 
and the forensic NON_COMPLIANT 
analysis of events. if a broker does not 
(PCI-DSS-v4.0) have audit logging 

enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13992



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.4 Audit logs are mq-cloudwatch-audi Ensure that an 
implemented to t-log-enabled Amazon MQ broker 
support the detection has CloudWatch audit 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if the broker 
analysis of events. does not have audit 
(PCI-DSS-v4.0) logging enabled.

10.2.1.4 Audit logs are eks-cluster-logging- Ensure that an 
implemented to enabled Amazon Elastic 
support the detection Kubernetes Service 
of anomalies and (Amazon EKS) cluster 
suspicious activity, is configured with 
and the forensic logging enabled. The 
analysis of events. rule is NON_COMPL 
(PCI-DSS-v4.0) IANT if logging for 

Amazon EKS clusters 
is not enabled for all 
log types.

10.2.1.4 Audit logs are elastic-beanstalk- Ensure that AWS 
implemented to logs-to-cloudwatch Elastic Beanstalk 
support the detection environments 
of anomalies and are configured 
suspicious activity, to send logs to 
and the forensic Amazon CloudWatc 
analysis of events. h Logs. The rule 
(PCI-DSS-v4.0) is NON_COMPL 

IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13993



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.4 Audit logs are step-functions-sta Ensure that AWS 
implemented to te-machine-logging- Step Functions 
support the detection enabled machine has logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a state machine does 
analysis of events. not have logging 
(PCI-DSS-v4.0) enabled or the 

logging configura 
tion is not at the 
minimum level 
provided.

10.2.1.4 Audit logs are netfw-logging-enab Ensure that AWS 
implemented to led Network Firewall 
support the detection firewalls have logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a logging type is not 
analysis of events. configured. You can 
(PCI-DSS-v4.0) specify which logging 

type you want the 
rule to check.

10.2.1.5 Audit logs are api-gwv2-access-lo Ensure that Amazon 
implemented to gs-enabled API Gateway V2 
support the detection stages have access 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if 'accessLo 
analysis of events. gSettings' is not 
(PCI-DSS-v4.0) present in Stage 

configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13994



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.5 Audit logs are api-gw-xray-enabled Ensure that AWS 
implemented to X-Ray tracing is 
support the detection enabled on Amazon 
of anomalies and API Gateway REST 
suspicious activity, APIs. The rule is 
and the forensic COMPLIANT if X-Ray 
analysis of events. tracing is enabled 
(PCI-DSS-v4.0) and NON_COMPL 

IANT otherwise.

10.2.1.5 Audit logs are cloudfront-accessl Ensure that Amazon 
implemented to ogs-enabled CloudFront distribut 
support the detection ions are configure 
of anomalies and d to deliver access 
suspicious activity, logs to an Amazon 
and the forensic S3 bucket. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) CloudFront distribut 

ion does not have 
logging configured.

10.2.1.5 Audit logs are neptune-cluster-cl Ensure that an 
implemented to oudwatch-log-expor Amazon Neptune 
support the detection t-enabled cluster has 
of anomalies and CloudWatch log 
suspicious activity, export enabled for 
and the forensic audit logs. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) Neptune cluster does 

not have CloudWatc 
h log export enabled 
for audit logs.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13995



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.5 Audit logs are ecs-task-definition- Ensure that logConfig 
implemented to log-configuration uration is set on 
support the detection active ECS Task 
of anomalies and Definitions. This 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if an active 
analysis of events. ECSTaskDefinition 
(PCI-DSS-v4.0) does not have the 

logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

10.2.1.5 Audit logs are cloudtrail-enabled Note: For this rule, 
implemented to the rule identifie 
support the detection r (CLOUD_TR 
of anomalies and AIL_ENABLED) and 
suspicious activity, rule name (cloudtrail-
and the forensic enabled) are different 
analysis of events. . Ensure that an AWS 
(PCI-DSS-v4.0) CloudTrail trail is 

enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13996



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.5 Audit logs are multi-region-cloud Note: for this rule, 
implemented to trail-enabled the rule identifie 
support the detection r (MULTI_RE 
of anomalies and GION_CLOU 
suspicious activity, D_TRAIL_ENABLED) 
and the forensic and rule name 
analysis of events. (multi-region-clou 
(PCI-DSS-v4.0) dtrail-enabled) are 

different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13997



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.5 Audit logs are appsync-logging-en Ensure that an AWS 
implemented to abled AppSync API has 
support the detection logging enabled. The 
of anomalies and rule is NON_COMPL 
suspicious activity, IANT if logging is not 
and the forensic enabled, or 'fieldLog 
analysis of events. Level' is neither 
(PCI-DSS-v4.0) ERROR nor ALL.

10.2.1.5 Audit logs are waf-classic-logging- Ensure that logging is 
implemented to enabled enabled on AWS WAF 
support the detection classic global web 
of anomalies and access control lists 
suspicious activity, (web ACLs). The rule 
and the forensic is NON_COMPLIANT 
analysis of events. for a global web ACL, 
(PCI-DSS-v4.0) if it does not have 

logging enabled.

10.2.1.5 Audit logs are mq-cloudwatch-audi Ensure that Amazon 
implemented to t-logging-enabled MQ brokers have 
support the detection Amazon CloudWatc 
of anomalies and h audit logging 
suspicious activity, enabled. The rule is 
and the forensic NON_COMPLIANT 
analysis of events. if a broker does not 
(PCI-DSS-v4.0) have audit logging 

enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13998



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.5 Audit logs are mq-cloudwatch-audi Ensure that an 
implemented to t-log-enabled Amazon MQ broker 
support the detection has CloudWatch audit 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if the broker 
analysis of events. does not have audit 
(PCI-DSS-v4.0) logging enabled.

10.2.1.5 Audit logs are eks-cluster-logging- Ensure that an 
implemented to enabled Amazon Elastic 
support the detection Kubernetes Service 
of anomalies and (Amazon EKS) cluster 
suspicious activity, is configured with 
and the forensic logging enabled. The 
analysis of events. rule is NON_COMPL 
(PCI-DSS-v4.0) IANT if logging for 

Amazon EKS clusters 
is not enabled for all 
log types.

10.2.1.5 Audit logs are elastic-beanstalk- Ensure that AWS 
implemented to logs-to-cloudwatch Elastic Beanstalk 
support the detection environments 
of anomalies and are configured 
suspicious activity, to send logs to 
and the forensic Amazon CloudWatc 
analysis of events. h Logs. The rule 
(PCI-DSS-v4.0) is NON_COMPL 

IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 13999



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.5 Audit logs are step-functions-sta Ensure that AWS 
implemented to te-machine-logging- Step Functions 
support the detection enabled machine has logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a state machine does 
analysis of events. not have logging 
(PCI-DSS-v4.0) enabled or the 

logging configura 
tion is not at the 
minimum level 
provided.

10.2.1.5 Audit logs are netfw-logging-enab Ensure that AWS 
implemented to led Network Firewall 
support the detection firewalls have logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a logging type is not 
analysis of events. configured. You can 
(PCI-DSS-v4.0) specify which logging 

type you want the 
rule to check.

10.2.1.6 Audit logs are api-gwv2-access-lo Ensure that Amazon 
implemented to gs-enabled API Gateway V2 
support the detection stages have access 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if 'accessLo 
analysis of events. gSettings' is not 
(PCI-DSS-v4.0) present in Stage 

configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14000



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.6 Audit logs are api-gw-xray-enabled Ensure that AWS 
implemented to X-Ray tracing is 
support the detection enabled on Amazon 
of anomalies and API Gateway REST 
suspicious activity, APIs. The rule is 
and the forensic COMPLIANT if X-Ray 
analysis of events. tracing is enabled 
(PCI-DSS-v4.0) and NON_COMPL 

IANT otherwise.

10.2.1.6 Audit logs are cloudfront-accessl Ensure that Amazon 
implemented to ogs-enabled CloudFront distribut 
support the detection ions are configure 
of anomalies and d to deliver access 
suspicious activity, logs to an Amazon 
and the forensic S3 bucket. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) CloudFront distribut 

ion does not have 
logging configured.

10.2.1.6 Audit logs are neptune-cluster-cl Ensure that an 
implemented to oudwatch-log-expor Amazon Neptune 
support the detection t-enabled cluster has 
of anomalies and CloudWatch log 
suspicious activity, export enabled for 
and the forensic audit logs. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) Neptune cluster does 

not have CloudWatc 
h log export enabled 
for audit logs.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14001



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.6 Audit logs are ecs-task-definition- Ensure that logConfig 
implemented to log-configuration uration is set on 
support the detection active ECS Task 
of anomalies and Definitions. This 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if an active 
analysis of events. ECSTaskDefinition 
(PCI-DSS-v4.0) does not have the 

logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

10.2.1.6 Audit logs are cloudtrail-enabled Note: For this rule, 
implemented to the rule identifie 
support the detection r (CLOUD_TR 
of anomalies and AIL_ENABLED) and 
suspicious activity, rule name (cloudtrail-
and the forensic enabled) are different 
analysis of events. . Ensure that an AWS 
(PCI-DSS-v4.0) CloudTrail trail is 

enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14002



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.6 Audit logs are multi-region-cloud Note: for this rule, 
implemented to trail-enabled the rule identifie 
support the detection r (MULTI_RE 
of anomalies and GION_CLOU 
suspicious activity, D_TRAIL_ENABLED) 
and the forensic and rule name 
analysis of events. (multi-region-clou 
(PCI-DSS-v4.0) dtrail-enabled) are 

different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14003



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.6 Audit logs are appsync-logging-en Ensure that an AWS 
implemented to abled AppSync API has 
support the detection logging enabled. The 
of anomalies and rule is NON_COMPL 
suspicious activity, IANT if logging is not 
and the forensic enabled, or 'fieldLog 
analysis of events. Level' is neither 
(PCI-DSS-v4.0) ERROR nor ALL.

10.2.1.6 Audit logs are waf-classic-logging- Ensure that logging is 
implemented to enabled enabled on AWS WAF 
support the detection classic global web 
of anomalies and access control lists 
suspicious activity, (web ACLs). The rule 
and the forensic is NON_COMPLIANT 
analysis of events. for a global web ACL, 
(PCI-DSS-v4.0) if it does not have 

logging enabled.

10.2.1.6 Audit logs are mq-cloudwatch-audi Ensure that Amazon 
implemented to t-logging-enabled MQ brokers have 
support the detection Amazon CloudWatc 
of anomalies and h audit logging 
suspicious activity, enabled. The rule is 
and the forensic NON_COMPLIANT 
analysis of events. if a broker does not 
(PCI-DSS-v4.0) have audit logging 

enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14004



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.6 Audit logs are mq-cloudwatch-audi Ensure that an 
implemented to t-log-enabled Amazon MQ broker 
support the detection has CloudWatch audit 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if the broker 
analysis of events. does not have audit 
(PCI-DSS-v4.0) logging enabled.

10.2.1.6 Audit logs are eks-cluster-logging- Ensure that an 
implemented to enabled Amazon Elastic 
support the detection Kubernetes Service 
of anomalies and (Amazon EKS) cluster 
suspicious activity, is configured with 
and the forensic logging enabled. The 
analysis of events. rule is NON_COMPL 
(PCI-DSS-v4.0) IANT if logging for 

Amazon EKS clusters 
is not enabled for all 
log types.

10.2.1.6 Audit logs are elastic-beanstalk- Ensure that AWS 
implemented to logs-to-cloudwatch Elastic Beanstalk 
support the detection environments 
of anomalies and are configured 
suspicious activity, to send logs to 
and the forensic Amazon CloudWatc 
analysis of events. h Logs. The rule 
(PCI-DSS-v4.0) is NON_COMPL 

IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14005



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.6 Audit logs are step-functions-sta Ensure that AWS 
implemented to te-machine-logging- Step Functions 
support the detection enabled machine has logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a state machine does 
analysis of events. not have logging 
(PCI-DSS-v4.0) enabled or the 

logging configura 
tion is not at the 
minimum level 
provided.

10.2.1.6 Audit logs are netfw-logging-enab Ensure that AWS 
implemented to led Network Firewall 
support the detection firewalls have logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a logging type is not 
analysis of events. configured. You can 
(PCI-DSS-v4.0) specify which logging 

type you want the 
rule to check.

10.2.1.7 Audit logs are api-gwv2-access-lo Ensure that Amazon 
implemented to gs-enabled API Gateway V2 
support the detection stages have access 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if 'accessLo 
analysis of events. gSettings' is not 
(PCI-DSS-v4.0) present in Stage 

configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14006



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.7 Audit logs are api-gw-xray-enabled Ensure that AWS 
implemented to X-Ray tracing is 
support the detection enabled on Amazon 
of anomalies and API Gateway REST 
suspicious activity, APIs. The rule is 
and the forensic COMPLIANT if X-Ray 
analysis of events. tracing is enabled 
(PCI-DSS-v4.0) and NON_COMPL 

IANT otherwise.

10.2.1.7 Audit logs are cloudfront-accessl Ensure that Amazon 
implemented to ogs-enabled CloudFront distribut 
support the detection ions are configure 
of anomalies and d to deliver access 
suspicious activity, logs to an Amazon 
and the forensic S3 bucket. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) CloudFront distribut 

ion does not have 
logging configured.

10.2.1.7 Audit logs are neptune-cluster-cl Ensure that an 
implemented to oudwatch-log-expor Amazon Neptune 
support the detection t-enabled cluster has 
of anomalies and CloudWatch log 
suspicious activity, export enabled for 
and the forensic audit logs. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) Neptune cluster does 

not have CloudWatc 
h log export enabled 
for audit logs.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14007



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.7 Audit logs are ecs-task-definition- Ensure that logConfig 
implemented to log-configuration uration is set on 
support the detection active ECS Task 
of anomalies and Definitions. This 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if an active 
analysis of events. ECSTaskDefinition 
(PCI-DSS-v4.0) does not have the 

logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

10.2.1.7 Audit logs are cloudtrail-enabled Note: For this rule, 
implemented to the rule identifie 
support the detection r (CLOUD_TR 
of anomalies and AIL_ENABLED) and 
suspicious activity, rule name (cloudtrail-
and the forensic enabled) are different 
analysis of events. . Ensure that an AWS 
(PCI-DSS-v4.0) CloudTrail trail is 

enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14008



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.7 Audit logs are multi-region-cloud Note: for this rule, 
implemented to trail-enabled the rule identifie 
support the detection r (MULTI_RE 
of anomalies and GION_CLOU 
suspicious activity, D_TRAIL_ENABLED) 
and the forensic and rule name 
analysis of events. (multi-region-clou 
(PCI-DSS-v4.0) dtrail-enabled) are 

different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14009



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.7 Audit logs are appsync-logging-en Ensure that an AWS 
implemented to abled AppSync API has 
support the detection logging enabled. The 
of anomalies and rule is NON_COMPL 
suspicious activity, IANT if logging is not 
and the forensic enabled, or 'fieldLog 
analysis of events. Level' is neither 
(PCI-DSS-v4.0) ERROR nor ALL.

10.2.1.7 Audit logs are waf-classic-logging- Ensure that logging is 
implemented to enabled enabled on AWS WAF 
support the detection classic global web 
of anomalies and access control lists 
suspicious activity, (web ACLs). The rule 
and the forensic is NON_COMPLIANT 
analysis of events. for a global web ACL, 
(PCI-DSS-v4.0) if it does not have 

logging enabled.

10.2.1.7 Audit logs are mq-cloudwatch-audi Ensure that Amazon 
implemented to t-logging-enabled MQ brokers have 
support the detection Amazon CloudWatc 
of anomalies and h audit logging 
suspicious activity, enabled. The rule is 
and the forensic NON_COMPLIANT 
analysis of events. if a broker does not 
(PCI-DSS-v4.0) have audit logging 

enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14010



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.7 Audit logs are mq-cloudwatch-audi Ensure that an 
implemented to t-log-enabled Amazon MQ broker 
support the detection has CloudWatch audit 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if the broker 
analysis of events. does not have audit 
(PCI-DSS-v4.0) logging enabled.

10.2.1.7 Audit logs are eks-cluster-logging- Ensure that an 
implemented to enabled Amazon Elastic 
support the detection Kubernetes Service 
of anomalies and (Amazon EKS) cluster 
suspicious activity, is configured with 
and the forensic logging enabled. The 
analysis of events. rule is NON_COMPL 
(PCI-DSS-v4.0) IANT if logging for 

Amazon EKS clusters 
is not enabled for all 
log types.

10.2.1.7 Audit logs are elastic-beanstalk- Ensure that AWS 
implemented to logs-to-cloudwatch Elastic Beanstalk 
support the detection environments 
of anomalies and are configured 
suspicious activity, to send logs to 
and the forensic Amazon CloudWatc 
analysis of events. h Logs. The rule 
(PCI-DSS-v4.0) is NON_COMPL 

IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14011



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.1.7 Audit logs are step-functions-sta Ensure that AWS 
implemented to te-machine-logging- Step Functions 
support the detection enabled machine has logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a state machine does 
analysis of events. not have logging 
(PCI-DSS-v4.0) enabled or the 

logging configura 
tion is not at the 
minimum level 
provided.

10.2.1.7 Audit logs are netfw-logging-enab Ensure that AWS 
implemented to led Network Firewall 
support the detection firewalls have logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a logging type is not 
analysis of events. configured. You can 
(PCI-DSS-v4.0) specify which logging 

type you want the 
rule to check.

10.2.2 Audit logs are api-gwv2-access-lo Ensure that Amazon 
implemented to gs-enabled API Gateway V2 
support the detection stages have access 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if 'accessLo 
analysis of events. gSettings' is not 
(PCI-DSS-v4.0) present in Stage 

configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14012



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.2 Audit logs are api-gw-xray-enabled Ensure that AWS 
implemented to X-Ray tracing is 
support the detection enabled on Amazon 
of anomalies and API Gateway REST 
suspicious activity, APIs. The rule is 
and the forensic COMPLIANT if X-Ray 
analysis of events. tracing is enabled 
(PCI-DSS-v4.0) and NON_COMPL 

IANT otherwise.

10.2.2 Audit logs are cloudfront-accessl Ensure that Amazon 
implemented to ogs-enabled CloudFront distribut 
support the detection ions are configure 
of anomalies and d to deliver access 
suspicious activity, logs to an Amazon 
and the forensic S3 bucket. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) CloudFront distribut 

ion does not have 
logging configured.

10.2.2 Audit logs are neptune-cluster-cl Ensure that an 
implemented to oudwatch-log-expor Amazon Neptune 
support the detection t-enabled cluster has 
of anomalies and CloudWatch log 
suspicious activity, export enabled for 
and the forensic audit logs. The rule is 
analysis of events. NON_COMPLIANT if a 
(PCI-DSS-v4.0) Neptune cluster does 

not have CloudWatc 
h log export enabled 
for audit logs.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14013



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.2 Audit logs are ecs-task-definition- Ensure that logConfig 
implemented to log-configuration uration is set on 
support the detection active ECS Task 
of anomalies and Definitions. This 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if an active 
analysis of events. ECSTaskDefinition 
(PCI-DSS-v4.0) does not have the 

logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

10.2.2 Audit logs are cloudtrail-enabled Note: For this rule, 
implemented to the rule identifie 
support the detection r (CLOUD_TR 
of anomalies and AIL_ENABLED) and 
suspicious activity, rule name (cloudtrail-
and the forensic enabled) are different 
analysis of events. . Ensure that an AWS 
(PCI-DSS-v4.0) CloudTrail trail is 

enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14014



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.2 Audit logs are multi-region-cloud Note: for this rule, 
implemented to trail-enabled the rule identifie 
support the detection r (MULTI_RE 
of anomalies and GION_CLOU 
suspicious activity, D_TRAIL_ENABLED) 
and the forensic and rule name 
analysis of events. (multi-region-clou 
(PCI-DSS-v4.0) dtrail-enabled) are 

different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14015



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.2 Audit logs are appsync-logging-en Ensure that an AWS 
implemented to abled AppSync API has 
support the detection logging enabled. The 
of anomalies and rule is NON_COMPL 
suspicious activity, IANT if logging is not 
and the forensic enabled, or 'fieldLog 
analysis of events. Level' is neither 
(PCI-DSS-v4.0) ERROR nor ALL.

10.2.2 Audit logs are waf-classic-logging- Ensure that logging is 
implemented to enabled enabled on AWS WAF 
support the detection classic global web 
of anomalies and access control lists 
suspicious activity, (web ACLs). The rule 
and the forensic is NON_COMPLIANT 
analysis of events. for a global web ACL, 
(PCI-DSS-v4.0) if it does not have 

logging enabled.

10.2.2 Audit logs are mq-cloudwatch-audi Ensure that Amazon 
implemented to t-logging-enabled MQ brokers have 
support the detection Amazon CloudWatc 
of anomalies and h audit logging 
suspicious activity, enabled. The rule is 
and the forensic NON_COMPLIANT 
analysis of events. if a broker does not 
(PCI-DSS-v4.0) have audit logging 

enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14016



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.2 Audit logs are mq-cloudwatch-audi Ensure that an 
implemented to t-log-enabled Amazon MQ broker 
support the detection has CloudWatch audit 
of anomalies and logging enabled. The 
suspicious activity, rule is NON_COMPL 
and the forensic IANT if the broker 
analysis of events. does not have audit 
(PCI-DSS-v4.0) logging enabled.

10.2.2 Audit logs are eks-cluster-logging- Ensure that an 
implemented to enabled Amazon Elastic 
support the detection Kubernetes Service 
of anomalies and (Amazon EKS) cluster 
suspicious activity, is configured with 
and the forensic logging enabled. The 
analysis of events. rule is NON_COMPL 
(PCI-DSS-v4.0) IANT if logging for 

Amazon EKS clusters 
is not enabled for all 
log types.

10.2.2 Audit logs are elastic-beanstalk- Ensure that AWS 
implemented to logs-to-cloudwatch Elastic Beanstalk 
support the detection environments 
of anomalies and are configured 
suspicious activity, to send logs to 
and the forensic Amazon CloudWatc 
analysis of events. h Logs. The rule 
(PCI-DSS-v4.0) is NON_COMPL 

IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14017



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.2.2 Audit logs are step-functions-sta Ensure that AWS 
implemented to te-machine-logging- Step Functions 
support the detection enabled machine has logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a state machine does 
analysis of events. not have logging 
(PCI-DSS-v4.0) enabled or the 

logging configura 
tion is not at the 
minimum level 
provided.

10.2.2 Audit logs are netfw-logging-enab Ensure that AWS 
implemented to led Network Firewall 
support the detection firewalls have logging 
of anomalies and enabled. The rule is 
suspicious activity, NON_COMPLIANT if 
and the forensic a logging type is not 
analysis of events. configured. You can 
(PCI-DSS-v4.0) specify which logging 

type you want the 
rule to check.

10.3.1 Audit logs are api-gwv2-access-lo Ensure that Amazon 
protected from gs-enabled API Gateway V2 
destruction and stages have access 
unauthorized logging enabled. The 
modifications. (PCI- rule is NON_COMPL 
DSS-v4.0) IANT if 'accessLo 

gSettings' is not 
present in Stage 
configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14018



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.1 Audit logs are api-gw-xray-enabled Ensure that AWS 
protected from X-Ray tracing is 
destruction and enabled on Amazon 
unauthorized API Gateway REST 
modifications. (PCI- APIs. The rule is 
DSS-v4.0) COMPLIANT if X-Ray 

tracing is enabled 
and NON_COMPL 
IANT otherwise.

10.3.1 Audit logs are cloudfront-accessl Ensure that Amazon 
protected from ogs-enabled CloudFront distribut 
destruction and ions are configure 
unauthorized d to deliver access 
modifications. (PCI- logs to an Amazon 
DSS-v4.0) S3 bucket. The rule is 

NON_COMPLIANT if a 
CloudFront distribut 
ion does not have 
logging configured.

10.3.1 Audit logs are neptune-cluster-cl Ensure that an 
protected from oudwatch-log-expor Amazon Neptune 
destruction and t-enabled cluster has 
unauthorized CloudWatch log 
modifications. (PCI- export enabled for 
DSS-v4.0) audit logs. The rule is 

NON_COMPLIANT if a 
Neptune cluster does 
not have CloudWatc 
h log export enabled 
for audit logs.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14019



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.1 Audit logs are ecs-task-definition- Ensure that logConfig 
protected from log-configuration uration is set on 
destruction and active ECS Task 
unauthorized Definitions. This 
modifications. (PCI- rule is NON_COMPL 
DSS-v4.0) IANT if an active 

ECSTaskDefinition 
does not have the 
logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

10.3.1 Audit logs are cloudtrail-enabled Note: For this rule, 
protected from the rule identifie 
destruction and r (CLOUD_TR 
unauthorized AIL_ENABLED) and 
modifications. (PCI- rule name (cloudtrail-
DSS-v4.0) enabled) are different 

. Ensure that an AWS 
CloudTrail trail is 
enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14020



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.1 Audit logs are multi-region-cloud Note: for this rule, 
protected from trail-enabled the rule identifie 
destruction and r (MULTI_RE 
unauthorized GION_CLOU 
modifications. (PCI- D_TRAIL_ENABLED) 
DSS-v4.0) and rule name 

(multi-region-clou 
dtrail-enabled) are 
different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14021



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.1 Audit logs are appsync-logging-en Ensure that an AWS 
protected from abled AppSync API has 
destruction and logging enabled. The 
unauthorized rule is NON_COMPL 
modifications. (PCI- IANT if logging is not 
DSS-v4.0) enabled, or 'fieldLog 

Level' is neither 
ERROR nor ALL.

10.3.1 Audit logs are waf-classic-logging- Ensure that logging is 
protected from enabled enabled on AWS WAF 
destruction and classic global web 
unauthorized access control lists 
modifications. (PCI- (web ACLs). The rule 
DSS-v4.0) is NON_COMPLIANT 

for a global web ACL, 
if it does not have 
logging enabled.

10.3.1 Audit logs are mq-cloudwatch-audi Ensure that Amazon 
protected from t-logging-enabled MQ brokers have 
destruction and Amazon CloudWatc 
unauthorized h audit logging 
modifications. (PCI- enabled. The rule is 
DSS-v4.0) NON_COMPLIANT 

if a broker does not 
have audit logging 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14022



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.1 Audit logs are mq-cloudwatch-audi Ensure that an 
protected from t-log-enabled Amazon MQ broker 
destruction and has CloudWatch audit 
unauthorized logging enabled. The 
modifications. (PCI- rule is NON_COMPL 
DSS-v4.0) IANT if the broker 

does not have audit 
logging enabled.

10.3.1 Audit logs are eks-cluster-logging- Ensure that an 
protected from enabled Amazon Elastic 
destruction and Kubernetes Service 
unauthorized (Amazon EKS) cluster 
modifications. (PCI- is configured with 
DSS-v4.0) logging enabled. The 

rule is NON_COMPL 
IANT if logging for 
Amazon EKS clusters 
is not enabled for all 
log types.

10.3.1 Audit logs are elastic-beanstalk- Ensure that AWS 
protected from logs-to-cloudwatch Elastic Beanstalk 
destruction and environments 
unauthorized are configured 
modifications. (PCI- to send logs to 
DSS-v4.0) Amazon CloudWatc 

h Logs. The rule 
is NON_COMPL 
IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14023



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.1 Audit logs are step-functions-sta Ensure that AWS 
protected from te-machine-logging- Step Functions 
destruction and enabled machine has logging 
unauthorized enabled. The rule is 
modifications. (PCI- NON_COMPLIANT if 
DSS-v4.0) a state machine does 

not have logging 
enabled or the 
logging configura 
tion is not at the 
minimum level 
provided.

10.3.1 Audit logs are netfw-logging-enab Ensure that AWS 
protected from led Network Firewall 
destruction and firewalls have logging 
unauthorized enabled. The rule is 
modifications. (PCI- NON_COMPLIANT if 
DSS-v4.0) a logging type is not 

configured. You can 
specify which logging 
type you want the 
rule to check.

10.3.2 Audit logs are cloudtrail-security- Ensure that there 
protected from trail-enabled is at least one AWS 
destruction and CloudTrail trail 
unauthorized defined with security 
modifications. (PCI- best practices. This 
DSS-v4.0) rule is COMPLIANT if 

there is at least one 
trail that meets all of 
the following:

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14024



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.2 Audit logs are neptune-cluster-sn Ensure that an 
protected from apshot-public-proh Amazon Neptune 
destruction and ibited manual DB cluster 
unauthorized snapshot is not 
modifications. (PCI- public. The rule is 
DSS-v4.0) NON_COMPLIANT 

if any existing and 
new Neptune cluster 
snapshot is public.

10.3.2 Audit logs are docdb-cluster-snap Ensure that Amazon 
protected from shot-public-prohib DocumentDB manual 
destruction and ited cluster snapshots 
unauthorized are not public. The 
modifications. (PCI- rule is NON_COMPL 
DSS-v4.0) IANT if any Amazon 

DocumentDB manual 
cluster snapshots are 
public.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14025



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.2 Audit logs are backup-recovery-po Ensure that a backup 
protected from int-manual-deletion- vault has an attached 
destruction and disabled resource-based 
unauthorized policy which prevents 
modifications. (PCI- deletion of recovery 
DSS-v4.0) points. The rule 

is NON_COMPL 
IANT if the Backup 
Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14026



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.2 Audit logs are emr-block-public-a Ensure that an 
protected from ccess account with Amazon 
destruction and EMR has block public 
unauthorized access settings 
modifications. (PCI- enabled. The rule is 
DSS-v4.0) NON_COMPLIANT if 

BlockPublicSecurit 
yGroupRules is false, 
or if true, ports other 
than Port 22 are 
listed in Permitted 
PublicSecurityGrou 
pRuleRanges.

10.3.2 Audit logs are s3-access-point-pu Ensure that Amazon 
protected from blic-access-blocks S3 access points have 
destruction and block public access 
unauthorized settings enabled. The 
modifications. (PCI- rule is NON_COMPL 
DSS-v4.0) IANT if block public 

access settings are 
not enabled for S3 
access points.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14027



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.2 Audit logs are s3-account-level-p Ensure that the 
protected from ublic-access-blocks required public 
destruction and access block settings 
unauthorized are configured 
modifications. (PCI- from account level. 
DSS-v4.0) The rule is only 

NON_COMPLIANT 
when the fields set 
below do not match 
the corresponding 
fields in the configura 
tion item.

10.3.2 Audit logs are s3-bucket-mfa-dele Ensure that MFA 
protected from te-enabled Delete is enabled in 
destruction and the Amazon Simple 
unauthorized Storage Service 
modifications. (PCI- (Amazon S3) bucket 
DSS-v4.0) versioning configura 

tion. The rule is 
NON_COMPLIANT 
if MFA Delete is not 
enabled.

10.3.3 Audit logs are aurora-resources-p Ensure that Amazon 
protected from rotected-by-backup- Aurora DB clusters 
destruction and plan are protected by a 
unauthorized backup plan. The 
modifications. (PCI- rule is NON_COMPL 
DSS-v4.0) IANT if the Amazon 

Relational Database 
Service (Amazon RDS) 
Database Cluster is 
not protected by a 
backup plan.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14028



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.3 Audit logs are db-instance-backup- Ensure that RDS 
protected from enabled DB instances have 
destruction and backups enabled. 
unauthorized Optionally, the rule 
modifications. (PCI- checks the backup 
DSS-v4.0) retention period and 

the backup window.

10.3.3 Audit logs are dynamodb-in-backup Ensure that Amazon 
protected from -plan DynamoDB tables 
destruction and are present in AWS 
unauthorized Backup Plans. The 
modifications. (PCI- rule is NON_COMPL 
DSS-v4.0) IANT if Amazon 

DynamoDB tables are 
not present in any 
AWS Backup plan.

10.3.3 Audit logs are dynamodb-resources- Ensure that Amazon 
protected from protected-by-backup- DynamoDB tables 
destruction and plan are protected by a 
unauthorized backup plan. The rule 
modifications. (PCI- is NON_COMPLIANT 
DSS-v4.0) if the DynamoDB 

Table is not covered 
by a backup plan.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14029



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.3 Audit logs are ebs-in-backup-plan Ensure that Amazon 
protected from Elastic Block Store 
destruction and (Amazon EBS) 
unauthorized volumes are added in 
modifications. (PCI- backup plans of AWS 
DSS-v4.0) Backup. The rule is 

NON_COMPLIANT if 
Amazon EBS volumes 
are not included in 
backup plans.

10.3.3 Audit logs are ebs-resources-prot Ensure that Amazon 
protected from ected-by-backup-pl Elastic Block 
destruction and an Store (Amazon 
unauthorized EBS) volumes are 
modifications. (PCI- protected by a 
DSS-v4.0) backup plan. The rule 

is NON_COMPLIANT 
if the Amazon EBS 
volume is not covered 
by a backup plan.

10.3.3 Audit logs are ec2-resources-prot Ensure that Amazon 
protected from ected-by-backup-pl Elastic Compute 
destruction and an Cloud (Amazon 
unauthorized EC2) instances are 
modifications. (PCI- protected by a 
DSS-v4.0) backup plan. The 

rule is NON_COMPL 
IANT if the Amazon 
EC2 instance is not 
covered by a backup 
plan.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14030



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.3 Audit logs are efs-in-backup-plan Ensure that Amazon 
protected from Elastic File System 
destruction and (Amazon EFS) file 
unauthorized systems are added in 
modifications. (PCI- the backup plans of 
DSS-v4.0) AWS Backup. The rule 

is NON_COMPLIANT 
if EFS file systems are 
not included in the 
backup plans.

10.3.3 Audit logs are efs-resources-prot Ensure that Amazon 
protected from ected-by-backup-pl Elastic File System 
destruction and an (Amazon EFS) 
unauthorized file systems are 
modifications. (PCI- protected by a 
DSS-v4.0) backup plan. The rule 

is NON_COMPLIANT 
if the EFS File System 
is not covered by a 
backup plan.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14031



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.3 Audit logs are elasticache-redis- Check if the Amazon 
protected from cluster-automatic- ElastiCache Redis 
destruction and backup-check clusters have 
unauthorized automatic backup 
modifications. (PCI- turned on. The rule 
DSS-v4.0) is NON_COMPLIANT 

if the SnapshotR 
etentionLimit for 
Redis cluster is less 
than the SnapshotR 
etentionPeriod 
parameter. For 
example: If the 
parameter is 15 then 
the rule is non-compl 
iant if the snapshotR 
etentionPeriod is 
between 0-15.

10.3.3 Audit logs are fsx-resources-prot Ensure that Amazon 
protected from ected-by-backup-pl FSx File Systems 
destruction and an are protected by a 
unauthorized backup plan. The rule 
modifications. (PCI- is NON_COMPLIANT 
DSS-v4.0) if the Amazon FSx 

File System is not 
covered by a backup 
plan.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14032



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.3 Audit logs are neptune-cluster-ba Ensure that an 
protected from ckup-retention-check Amazon Neptune 
destruction and DB cluster retention 
unauthorized period is set to 
modifications. (PCI- specific number of 
DSS-v4.0) days. The rule is 

NON_COMPLIANT if 
the retention period 
is less than the value 
specified by the 
parameter.

10.3.3 Audit logs are rds-in-backup-plan Ensure that Amazon 
protected from Relational Database 
destruction and Service (Amazon 
unauthorized RDS) databases 
modifications. (PCI- are present in AWS 
DSS-v4.0) Backup plans. The 

rule is NON_COMPL 
IANT if Amazon RDS 
databases are not 
included in any AWS 
Backup plan.

10.3.3 Audit logs are rds-resources-prot Ensure that Amazon 
protected from ected-by-backup-pl Relational Database 
destruction and an Service (Amazon 
unauthorized RDS) instances 
modifications. (PCI- are protected by a 
DSS-v4.0) backup plan. The rule 

is NON_COMPLIANT 
if the Amazon RDS 
Database instance 
is not covered by a 
backup plan.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14033



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.3 Audit logs are redshift-backup-en Ensure that 
protected from abled Amazon Redshift 
destruction and automated snapshots 
unauthorized are enabled for 
modifications. (PCI- clusters. The rule 
DSS-v4.0) is NON_COMPL 

IANT if the value 
for automated 
SnapshotRetentionP 
eriod is greater 
than MaxRetent 
ionPeriod or less than 
MinRetentionPeriod 
or the value is 0.

10.3.3 Audit logs are s3-resources-prote Ensure that Amazon 
protected from cted-by-backup-plan Simple Storage 
destruction and Service (Amazon S3) 
unauthorized buckets are protected 
modifications. (PCI- by a backup plan. The 
DSS-v4.0) rule is NON_COMPL 

IANT if the Amazon 
S3 bucket is not 
covered by a backup 
plan.

10.3.3 Audit logs are cloudtrail-security- Ensure that there 
protected from trail-enabled is at least one AWS 
destruction and CloudTrail trail 
unauthorized defined with security 
modifications. (PCI- best practices. This 
DSS-v4.0) rule is COMPLIANT if 

there is at least one 
trail that meets all of 
the following:

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14034



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.3 Audit logs are db-instance-backup- Ensure that RDS 
protected from enabled DB instances have 
destruction and backups enabled. 
unauthorized Optionally, the rule 
modifications. (PCI- checks the backup 
DSS-v4.0) retention period and 

the backup window.

10.3.3 Audit logs are dynamodb-pitr-enab Ensure that point-
protected from led in-time recovery 
destruction and (PITR) is enabled for 
unauthorized Amazon DynamoDB 
modifications. (PCI- tables. The rule is 
DSS-v4.0) NON_COMPLIANT if 

PITR is not enabled 
for DynamoDB tables.

10.3.4 Audit logs are cloudfront-origin- Ensure that 
protected from access-identity-en CloudFront distribut 
destruction and abled ion with Amazon 
unauthorized S3 Origin type has 
modifications. (PCI- origin access identity 
DSS-v4.0) (OAI) configured. The 

rule is NON_COMPL 
IANT if the CloudFron 
t distribution is 
backed by S3 and any 
origin type is not OAI 
configured, or the 
origin is not an S3 
bucket.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14035



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.4 Audit logs are cloudfront-s3-orig Ensure that an 
protected from in-access-control- Amazon CloudFron 
destruction and enabled t distribution with 
unauthorized an Amazon Simple 
modifications. (PCI- Storage Service 
DSS-v4.0) (Amazon S3) Origin 

type has origin 
access control (OAC) 
enabled. The rule is 
NON_COMPLIANT for 
CloudFront distribut 
ions with Amazon 
S3 origins that don't 
have OAC enabled.

10.3.4 Audit logs are s3-bucket-default- Ensure that the 
protected from lock-enabled S3 bucket has 
destruction and lock enabled, by 
unauthorized default. The rule is 
modifications. (PCI- NON_COMPLIANT 
DSS-v4.0) if the lock is not 

enabled.

10.3.4 Audit logs are s3-bucket-versioning- Ensure that versionin 
protected from enabled g is enabled for your 
destruction and S3 buckets. Optionall 
unauthorized y, the rule checks if 
modifications. (PCI- MFA delete is enabled 
DSS-v4.0) for your S3 buckets.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14036



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.3.4 Audit logs are cloudtrail-security- Ensure that there 
protected from trail-enabled is at least one AWS 
destruction and CloudTrail trail 
unauthorized defined with security 
modifications. (PCI- best practices. This 
DSS-v4.0) rule is COMPLIANT if 

there is at least one 
trail that meets all of 
the following:

10.4.1 Audit logs are api-gw-xray-enabled Ensure that AWS 
reviewed to identify X-Ray tracing is 
anomalies or enabled on Amazon 
suspicious activity. API Gateway REST 
(PCI-DSS-v4.0) APIs. The rule is 

COMPLIANT if X-Ray 
tracing is enabled 
and NON_COMPL 
IANT otherwise.

10.4.1 Audit logs are ec2-instance-detai Ensure that detailed 
reviewed to identify led-monitoring-ena monitoring is 
anomalies or bled enabled for EC2 
suspicious activity. instances. The rule is 
(PCI-DSS-v4.0) NON_COMPLIANT if 

detailed monitoring 
is not enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14037



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.4.1 Audit logs are cloudwatch-alarm-a Ensure that 
reviewed to identify ction-check CloudWatch alarms 
anomalies or have an action 
suspicious activity. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.4.1 Audit logs are cloudwatch-alarm-a Ensure that 
reviewed to identify ction-check CloudWatch alarms 
anomalies or have an action 
suspicious activity. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14038



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.4.1 Audit logs are cloudwatch-alarm-a Ensure that 
reviewed to identify ction-check CloudWatch alarms 
anomalies or have an action 
suspicious activity. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.4.1 Audit logs are cloudwatch-alarm-r Ensure that a 
reviewed to identify esource-check resource type has a 
anomalies or CloudWatch alarm 
suspicious activity. for the named metric. 
(PCI-DSS-v4.0) For resource type, 

you can specify 
EBS volumes, EC2 
instances, Amazon 
RDS clusters, or S3 
buckets. The rule is 
COMPLIANT if the 
named metric has 
a resource ID and 
CloudWatch alarm.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14039



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.4.1 Audit logs are wafv2-rulegroup-lo Ensure that Amazon 
reviewed to identify gging-enabled CloudWatch security 
anomalies or metrics collectio 
suspicious activity. n on AWS WAFv2 
(PCI-DSS-v4.0) rule groups is 

enabled. The rule is 
NON_COMPLIANT if 
the 'VisibilityConfig. 
CloudWatchMetricsE 
nabled' field is set to 
false.

10.4.1 Audit logs are sns-topic-message- Ensure that Amazon 
reviewed to identify delivery-notification- Simple Notification 
anomalies or enabled Service (SNS) logging 
suspicious activity. is enabled for the 
(PCI-DSS-v4.0) delivery status of 

notification messages 
sent to a topic for 
the endpoints. The 
rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

10.4.1.1 Audit logs are api-gw-xray-enabled Ensure that AWS 
reviewed to identify X-Ray tracing is 
anomalies or enabled on Amazon 
suspicious activity. API Gateway REST 
(PCI-DSS-v4.0) APIs. The rule is 

COMPLIANT if X-Ray 
tracing is enabled 
and NON_COMPL 
IANT otherwise.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14040



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.4.1.1 Audit logs are ec2-instance-detai Ensure that detailed 
reviewed to identify led-monitoring-ena monitoring is 
anomalies or bled enabled for EC2 
suspicious activity. instances. The rule is 
(PCI-DSS-v4.0) NON_COMPLIANT if 

detailed monitoring 
is not enabled.

10.4.1.1 Audit logs are cloudwatch-alarm-a Ensure that 
reviewed to identify ction-check CloudWatch alarms 
anomalies or have an action 
suspicious activity. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14041



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.4.1.1 Audit logs are cloudwatch-alarm-a Ensure that 
reviewed to identify ction-check CloudWatch alarms 
anomalies or have an action 
suspicious activity. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.4.1.1 Audit logs are cloudwatch-alarm-a Ensure that 
reviewed to identify ction-check CloudWatch alarms 
anomalies or have an action 
suspicious activity. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14042



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.4.1.1 Audit logs are cloudwatch-alarm-r Ensure that a 
reviewed to identify esource-check resource type has a 
anomalies or CloudWatch alarm 
suspicious activity. for the named metric. 
(PCI-DSS-v4.0) For resource type, 

you can specify 
EBS volumes, EC2 
instances, Amazon 
RDS clusters, or S3 
buckets. The rule is 
COMPLIANT if the 
named metric has 
a resource ID and 
CloudWatch alarm.

10.4.1.1 Audit logs are wafv2-rulegroup-lo Ensure that Amazon 
reviewed to identify gging-enabled CloudWatch security 
anomalies or metrics collectio 
suspicious activity. n on AWS WAFv2 
(PCI-DSS-v4.0) rule groups is 

enabled. The rule is 
NON_COMPLIANT if 
the 'VisibilityConfig. 
CloudWatchMetricsE 
nabled' field is set to 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14043



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.4.1.1 Audit logs are sns-topic-message- Ensure that Amazon 
reviewed to identify delivery-notification- Simple Notification 
anomalies or enabled Service (SNS) logging 
suspicious activity. is enabled for the 
(PCI-DSS-v4.0) delivery status of 

notification messages 
sent to a topic for 
the endpoints. The 
rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

10.4.2 Audit logs are api-gw-xray-enabled Ensure that AWS 
reviewed to identify X-Ray tracing is 
anomalies or enabled on Amazon 
suspicious activity. API Gateway REST 
(PCI-DSS-v4.0) APIs. The rule is 

COMPLIANT if X-Ray 
tracing is enabled 
and NON_COMPL 
IANT otherwise.

10.4.2 Audit logs are ec2-instance-detai Ensure that detailed 
reviewed to identify led-monitoring-ena monitoring is 
anomalies or bled enabled for EC2 
suspicious activity. instances. The rule is 
(PCI-DSS-v4.0) NON_COMPLIANT if 

detailed monitoring 
is not enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14044



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.4.2 Audit logs are cloudwatch-alarm-a Ensure that 
reviewed to identify ction-check CloudWatch alarms 
anomalies or have an action 
suspicious activity. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.4.2 Audit logs are cloudwatch-alarm-a Ensure that 
reviewed to identify ction-check CloudWatch alarms 
anomalies or have an action 
suspicious activity. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14045



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.4.2 Audit logs are cloudwatch-alarm-a Ensure that 
reviewed to identify ction-check CloudWatch alarms 
anomalies or have an action 
suspicious activity. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.4.2 Audit logs are cloudwatch-alarm-r Ensure that a 
reviewed to identify esource-check resource type has a 
anomalies or CloudWatch alarm 
suspicious activity. for the named metric. 
(PCI-DSS-v4.0) For resource type, 

you can specify 
EBS volumes, EC2 
instances, Amazon 
RDS clusters, or S3 
buckets. The rule is 
COMPLIANT if the 
named metric has 
a resource ID and 
CloudWatch alarm.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14046



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.4.2 Audit logs are wafv2-rulegroup-lo Ensure that Amazon 
reviewed to identify gging-enabled CloudWatch security 
anomalies or metrics collectio 
suspicious activity. n on AWS WAFv2 
(PCI-DSS-v4.0) rule groups is 

enabled. The rule is 
NON_COMPLIANT if 
the 'VisibilityConfig. 
CloudWatchMetricsE 
nabled' field is set to 
false.

10.4.2 Audit logs are sns-topic-message- Ensure that Amazon 
reviewed to identify delivery-notification- Simple Notification 
anomalies or enabled Service (SNS) logging 
suspicious activity. is enabled for the 
(PCI-DSS-v4.0) delivery status of 

notification messages 
sent to a topic for 
the endpoints. The 
rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14047



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.4.3 Audit logs are cloudwatch-alarm-a Ensure that 
reviewed to identify ction-check CloudWatch alarms 
anomalies or have an action 
suspicious activity. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.5.1 Audit log history cloudtrail-security- Ensure that there 
is retained and trail-enabled is at least one AWS 
available for analysis. CloudTrail trail 
(PCI-DSS-v4.0) defined with security 

best practices. This 
rule is COMPLIANT if 
there is at least one 
trail that meets all of 
the following:

10.5.1 Audit log history ec2-volume-inuse-c Ensure that EBS 
is retained and heck volumes are attached 
available for analysis. to EC2 instances. 
(PCI-DSS-v4.0) Optionally ensure 

that EBS volumes are 
marked for deletion 
when an instance is 
terminated.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14048



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.5.1 Audit log history ecr-private-lifecycle- Ensure that a private 
is retained and policy-configured Amazon Elastic 
available for analysis. Container Registry 
(PCI-DSS-v4.0) (ECR) repository 

has at least one 
lifecycle policy 
configured. The rule 
is NON_COMPLIANT 
if no lifecycle policy 
is configured for the 
ECR private repositor 
y.

10.5.1 Audit log history dynamodb-pitr-enab Ensure that point-
is retained and led in-time recovery 
available for analysis. (PITR) is enabled for 
(PCI-DSS-v4.0) Amazon DynamoDB 

tables. The rule is 
NON_COMPLIANT if 
PITR is not enabled 
for DynamoDB tables.

10.5.1 Audit log history cw-loggroup-retent Ensure that an 
is retained and ion-period-check Amazon CloudWatch 
available for analysis. LogGroup retention 
(PCI-DSS-v4.0) period is set to 

greater than 365 days 
or else a specified 
retention period. The 
rule is NON_COMPL 
IANT if the retention 
period is less than 
MinRetentionTime, if 
specified, or else 365 
days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14049



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.6.3 Time-synchronizati api-gwv2-access-lo Ensure that Amazon 
on mechanisms gs-enabled API Gateway V2 
support consistent stages have access 
time settings across logging enabled. The 
all systems. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if 'accessLo 

gSettings' is not 
present in Stage 
configuration.

10.6.3 Time-synchronizati api-gw-xray-enabled Ensure that AWS 
on mechanisms X-Ray tracing is 
support consistent enabled on Amazon 
time settings across API Gateway REST 
all systems. (PCI-DSS- APIs. The rule is 
v4.0) COMPLIANT if X-Ray 

tracing is enabled 
and NON_COMPL 
IANT otherwise.

10.6.3 Time-synchronizati cloudfront-accessl Ensure that Amazon 
on mechanisms ogs-enabled CloudFront distribut 
support consistent ions are configure 
time settings across d to deliver access 
all systems. (PCI-DSS- logs to an Amazon 
v4.0) S3 bucket. The rule is 

NON_COMPLIANT if a 
CloudFront distribut 
ion does not have 
logging configured.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14050



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.6.3 Time-synchronizati s3-bucket-blacklis Ensure that an 
on mechanisms ted-actions-prohib Amazon Simple 
support consistent ited Storage Service 
time settings across (Amazon S3) bucket 
all systems. (PCI-DSS- policy does not allow 
v4.0) blocklisted bucket-le 

vel and object-level 
actions on resources 
in the bucket for 
principals from other 
AWS accounts. For 
example, the rule 
checks that the 
Amazon S3 bucket 
policy does not allow 
another AWS account 
to perform any 
s3:GetBucket* actions 
and s3:DeleteObject 
on any object in the 
bucket. The rule is 
NON_COMPLIANT 
if any blocklisted 
actions are allowed 
by the Amazon S3 
bucket policy.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14051



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.6.3 Time-synchronizati s3-bucket-policy-not- Ensure that your 
on mechanisms more-permissive Amazon Simple 
support consistent Storage Service (S3) 
time settings across bucket policies do 
all systems. (PCI-DSS- not allow other inter-
v4.0) account permissio 

ns than the control 
Amazon S3 bucket 
policy that you 
provide.

10.6.3 Time-synchronizati neptune-cluster-cl Ensure that an 
on mechanisms oudwatch-log-expor Amazon Neptune 
support consistent t-enabled cluster has 
time settings across CloudWatch log 
all systems. (PCI-DSS- export enabled for 
v4.0) audit logs. The rule is 

NON_COMPLIANT if a 
Neptune cluster does 
not have CloudWatc 
h log export enabled 
for audit logs.

10.6.3 Time-synchronizati ec2-instance-detai Ensure that detailed 
on mechanisms led-monitoring-ena monitoring is 
support consistent bled enabled for EC2 
time settings across instances. The rule is 
all systems. (PCI-DSS- NON_COMPLIANT if 
v4.0) detailed monitoring 

is not enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14052



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.6.3 Time-synchronizati ecs-task-definition- Ensure that logConfig 
on mechanisms log-configuration uration is set on 
support consistent active ECS Task 
time settings across Definitions. This 
all systems. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if an active 

ECSTaskDefinition 
does not have the 
logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

10.6.3 Time-synchronizati cloudwatch-alarm-a Ensure that 
on mechanisms ction-check CloudWatch alarms 
support consistent have an action 
time settings across configured for the 
all systems. (PCI-DSS- ALARM, INSUFFICI 
v4.0) ENT_DATA, or OK 

state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14053



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.6.3 Time-synchronizati cloudwatch-alarm-a Ensure that 
on mechanisms ction-check CloudWatch alarms 
support consistent have an action 
time settings across configured for the 
all systems. (PCI-DSS- ALARM, INSUFFICI 
v4.0) ENT_DATA, or OK 

state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.6.3 Time-synchronizati cloudwatch-alarm-a Ensure that 
on mechanisms ction-check CloudWatch alarms 
support consistent have an action 
time settings across configured for the 
all systems. (PCI-DSS- ALARM, INSUFFICI 
v4.0) ENT_DATA, or OK 

state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14054



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.6.3 Time-synchronizati cloudwatch-alarm-r Ensure that a 
on mechanisms esource-check resource type has a 
support consistent CloudWatch alarm 
time settings across for the named metric. 
all systems. (PCI-DSS- For resource type, 
v4.0) you can specify 

EBS volumes, EC2 
instances, Amazon 
RDS clusters, or S3 
buckets. The rule is 
COMPLIANT if the 
named metric has 
a resource ID and 
CloudWatch alarm.

10.6.3 Time-synchronizati cloudtrail-enabled Note: For this rule, 
on mechanisms the rule identifie 
support consistent r (CLOUD_TR 
time settings across AIL_ENABLED) and 
all systems. (PCI-DSS- rule name (cloudtrail-
v4.0) enabled) are different 

. Ensure that an AWS 
CloudTrail trail is 
enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14055



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.6.3 Time-synchronizati multi-region-cloud Note: for this rule, 
on mechanisms trail-enabled the rule identifie 
support consistent r (MULTI_RE 
time settings across GION_CLOU 
all systems. (PCI-DSS- D_TRAIL_ENABLED) 
v4.0) and rule name 

(multi-region-clou 
dtrail-enabled) are 
different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14056



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.6.3 Time-synchronizati appsync-logging-en Ensure that an AWS 
on mechanisms abled AppSync API has 
support consistent logging enabled. The 
time settings across rule is NON_COMPL 
all systems. (PCI-DSS- IANT if logging is not 
v4.0) enabled, or 'fieldLog 

Level' is neither 
ERROR nor ALL.

10.6.3 Time-synchronizati waf-classic-logging- Ensure that logging is 
on mechanisms enabled enabled on AWS WAF 
support consistent classic global web 
time settings across access control lists 
all systems. (PCI-DSS- (web ACLs). The rule 
v4.0) is NON_COMPLIANT 

for a global web ACL, 
if it does not have 
logging enabled.

10.6.3 Time-synchronizati mq-cloudwatch-audi Ensure that Amazon 
on mechanisms t-logging-enabled MQ brokers have 
support consistent Amazon CloudWatc 
time settings across h audit logging 
all systems. (PCI-DSS- enabled. The rule is 
v4.0) NON_COMPLIANT 

if a broker does not 
have audit logging 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14057



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.6.3 Time-synchronizati mq-cloudwatch-audi Ensure that an 
on mechanisms t-log-enabled Amazon MQ broker 
support consistent has CloudWatch audit 
time settings across logging enabled. The 
all systems. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if the broker 

does not have audit 
logging enabled.

10.6.3 Time-synchronizati eks-cluster-logging- Ensure that an 
on mechanisms enabled Amazon Elastic 
support consistent Kubernetes Service 
time settings across (Amazon EKS) cluster 
all systems. (PCI-DSS- is configured with 
v4.0) logging enabled. The 

rule is NON_COMPL 
IANT if logging for 
Amazon EKS clusters 
is not enabled for all 
log types.

10.6.3 Time-synchronizati elastic-beanstalk- Ensure that AWS 
on mechanisms logs-to-cloudwatch Elastic Beanstalk 
support consistent environments 
time settings across are configured 
all systems. (PCI-DSS- to send logs to 
v4.0) Amazon CloudWatc 

h Logs. The rule 
is NON_COMPL 
IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14058



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.6.3 Time-synchronizati wafv2-rulegroup-lo Ensure that Amazon 
on mechanisms gging-enabled CloudWatch security 
support consistent metrics collectio 
time settings across n on AWS WAFv2 
all systems. (PCI-DSS- rule groups is 
v4.0) enabled. The rule is 

NON_COMPLIANT if 
the 'VisibilityConfig. 
CloudWatchMetricsE 
nabled' field is set to 
false.

10.6.3 Time-synchronizati sns-topic-message- Ensure that Amazon 
on mechanisms delivery-notification- Simple Notification 
support consistent enabled Service (SNS) logging 
time settings across is enabled for the 
all systems. (PCI-DSS- delivery status of 
v4.0) notification messages 

sent to a topic for 
the endpoints. The 
rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14059



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.6.3 Time-synchronizati step-functions-sta Ensure that AWS 
on mechanisms te-machine-logging- Step Functions 
support consistent enabled machine has logging 
time settings across enabled. The rule is 
all systems. (PCI-DSS- NON_COMPLIANT if 
v4.0) a state machine does 

not have logging 
enabled or the 
logging configura 
tion is not at the 
minimum level 
provided.

10.6.3 Time-synchronizati netfw-logging-enab Ensure that AWS 
on mechanisms led Network Firewall 
support consistent firewalls have logging 
time settings across enabled. The rule is 
all systems. (PCI-DSS- NON_COMPLIANT if 
v4.0) a logging type is not 

configured. You can 
specify which logging 
type you want the 
rule to check.

10.7.1 Failures of critical api-gw-xray-enabled Ensure that AWS 
security control X-Ray tracing is 
systems are detected, enabled on Amazon 
reported, and API Gateway REST 
responded to APIs. The rule is 
promptly. (PCI-DSS- COMPLIANT if X-Ray 
v4.0) tracing is enabled 

and NON_COMPL 
IANT otherwise.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14060



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.7.1 Failures of critical cloudformation-sta Ensure that your 
security control ck-notification-check CloudFormation 
systems are detected, stacks send event 
reported, and notifications to 
responded to an Amazon SNS 
promptly. (PCI-DSS- topic. Optionally 
v4.0) ensure that specified 

Amazon SNS topics 
are used. The rule is 
NON_COMPLIANT 
if CloudFormation 
stacks do not send 
notifications.

10.7.1 Failures of critical ec2-instance-detai Ensure that detailed 
security control led-monitoring-ena monitoring is 
systems are detected, bled enabled for EC2 
reported, and instances. The rule is 
responded to NON_COMPLIANT if 
promptly. (PCI-DSS- detailed monitoring 
v4.0) is not enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14061



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.7.1 Failures of critical cloudwatch-alarm-a Ensure that 
security control ction-check CloudWatch alarms 
systems are detected, have an action 
reported, and configured for the 
responded to ALARM, INSUFFICI 
promptly. (PCI-DSS- ENT_DATA, or OK 
v4.0) state. Optionall 

y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.7.1 Failures of critical cloudwatch-alarm-a Ensure that 
security control ction-check CloudWatch alarms 
systems are detected, have an action 
reported, and configured for the 
responded to ALARM, INSUFFICI 
promptly. (PCI-DSS- ENT_DATA, or OK 
v4.0) state. Optionall 

y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14062



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.7.1 Failures of critical cloudwatch-alarm-a Ensure that 
security control ction-check CloudWatch alarms 
systems are detected, have an action 
reported, and configured for the 
responded to ALARM, INSUFFICI 
promptly. (PCI-DSS- ENT_DATA, or OK 
v4.0) state. Optionall 

y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.7.1 Failures of critical cloudwatch-alarm-r Ensure that a 
security control esource-check resource type has a 
systems are detected, CloudWatch alarm 
reported, and for the named metric. 
responded to For resource type, 
promptly. (PCI-DSS- you can specify 
v4.0) EBS volumes, EC2 

instances, Amazon 
RDS clusters, or S3 
buckets. The rule is 
COMPLIANT if the 
named metric has 
a resource ID and 
CloudWatch alarm.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14063



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.7.1 Failures of critical wafv2-rulegroup-lo Ensure that Amazon 
security control gging-enabled CloudWatch security 
systems are detected, metrics collectio 
reported, and n on AWS WAFv2 
responded to rule groups is 
promptly. (PCI-DSS- enabled. The rule is 
v4.0) NON_COMPLIANT if 

the 'VisibilityConfig. 
CloudWatchMetricsE 
nabled' field is set to 
false.

10.7.1 Failures of critical sns-topic-message- Ensure that Amazon 
security control delivery-notification- Simple Notification 
systems are detected, enabled Service (SNS) logging 
reported, and is enabled for the 
responded to delivery status of 
promptly. (PCI-DSS- notification messages 
v4.0) sent to a topic for 

the endpoints. The 
rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

10.7.2 Failures of critical api-gw-xray-enabled Ensure that AWS 
security control X-Ray tracing is 
systems are detected, enabled on Amazon 
reported, and API Gateway REST 
responded to APIs. The rule is 
promptly. (PCI-DSS- COMPLIANT if X-Ray 
v4.0) tracing is enabled 

and NON_COMPL 
IANT otherwise.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14064



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.7.2 Failures of critical cloudformation-sta Ensure that your 
security control ck-notification-check CloudFormation 
systems are detected, stacks send event 
reported, and notifications to 
responded to an Amazon SNS 
promptly. (PCI-DSS- topic. Optionally 
v4.0) ensure that specified 

Amazon SNS topics 
are used. The rule is 
NON_COMPLIANT 
if CloudFormation 
stacks do not send 
notifications.

10.7.2 Failures of critical ec2-instance-detai Ensure that detailed 
security control led-monitoring-ena monitoring is 
systems are detected, bled enabled for EC2 
reported, and instances. The rule is 
responded to NON_COMPLIANT if 
promptly. (PCI-DSS- detailed monitoring 
v4.0) is not enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14065



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.7.2 Failures of critical cloudwatch-alarm-a Ensure that 
security control ction-check CloudWatch alarms 
systems are detected, have an action 
reported, and configured for the 
responded to ALARM, INSUFFICI 
promptly. (PCI-DSS- ENT_DATA, or OK 
v4.0) state. Optionall 

y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.7.2 Failures of critical cloudwatch-alarm-a Ensure that 
security control ction-check CloudWatch alarms 
systems are detected, have an action 
reported, and configured for the 
responded to ALARM, INSUFFICI 
promptly. (PCI-DSS- ENT_DATA, or OK 
v4.0) state. Optionall 

y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14066



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.7.2 Failures of critical cloudwatch-alarm-a Ensure that 
security control ction-check CloudWatch alarms 
systems are detected, have an action 
reported, and configured for the 
responded to ALARM, INSUFFICI 
promptly. (PCI-DSS- ENT_DATA, or OK 
v4.0) state. Optionall 

y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

10.7.2 Failures of critical cloudwatch-alarm-r Ensure that a 
security control esource-check resource type has a 
systems are detected, CloudWatch alarm 
reported, and for the named metric. 
responded to For resource type, 
promptly. (PCI-DSS- you can specify 
v4.0) EBS volumes, EC2 

instances, Amazon 
RDS clusters, or S3 
buckets. The rule is 
COMPLIANT if the 
named metric has 
a resource ID and 
CloudWatch alarm.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14067



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

10.7.2 Failures of critical wafv2-rulegroup-lo Ensure that Amazon 
security control gging-enabled CloudWatch security 
systems are detected, metrics collectio 
reported, and n on AWS WAFv2 
responded to rule groups is 
promptly. (PCI-DSS- enabled. The rule is 
v4.0) NON_COMPLIANT if 

the 'VisibilityConfig. 
CloudWatchMetricsE 
nabled' field is set to 
false.

10.7.2 Failures of critical sns-topic-message- Ensure that Amazon 
security control delivery-notification- Simple Notification 
systems are detected, enabled Service (SNS) logging 
reported, and is enabled for the 
responded to delivery status of 
promptly. (PCI-DSS- notification messages 
v4.0) sent to a topic for 

the endpoints. The 
rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14068



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

11.5.2 Network intrusions cloudformation-sta Ensure that your 
and unexpected file ck-notification-check CloudFormation 
changes are detected stacks send event 
and responded to. notifications to 
(PCI-DSS-v4.0) an Amazon SNS 

topic. Optionally 
ensure that specified 
Amazon SNS topics 
are used. The rule is 
NON_COMPLIANT 
if CloudFormation 
stacks do not send 
notifications.

11.5.2 Network intrusions cloudwatch-alarm-a Ensure that 
and unexpected file ction-check CloudWatch alarms 
changes are detected have an action 
and responded to. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14069



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

11.5.2 Network intrusions cloudwatch-alarm-a Ensure that 
and unexpected file ction-check CloudWatch alarms 
changes are detected have an action 
and responded to. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

11.5.2 Network intrusions cloudwatch-alarm-s Ensure that 
and unexpected file ettings-check CloudWatch alarms 
changes are detected with the given metric 
and responded to. name have the 
(PCI-DSS-v4.0) specified settings.

11.5.2 Network intrusions sns-topic-message- Ensure that Amazon 
and unexpected file delivery-notification- Simple Notification 
changes are detected enabled Service (SNS) logging 
and responded to. is enabled for the 
(PCI-DSS-v4.0) delivery status of 

notification messages 
sent to a topic for 
the endpoints. The 
rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14070



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

11.6.1 Unauthorized cloudformation-sta Ensure that your 
changes on payment ck-notification-check CloudFormation 
pages are detected stacks send event 
and responded to. notifications to 
(PCI-DSS-v4.0) an Amazon SNS 

topic. Optionally 
ensure that specified 
Amazon SNS topics 
are used. The rule is 
NON_COMPLIANT 
if CloudFormation 
stacks do not send 
notifications.

11.6.1 Unauthorized cloudwatch-alarm-a Ensure that 
changes on payment ction-check CloudWatch alarms 
pages are detected have an action 
and responded to. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14071



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

11.6.1 Unauthorized cloudwatch-alarm-a Ensure that 
changes on payment ction-check CloudWatch alarms 
pages are detected have an action 
and responded to. configured for the 
(PCI-DSS-v4.0) ALARM, INSUFFICI 

ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

11.6.1 Unauthorized cloudwatch-alarm-s Ensure that 
changes on payment ettings-check CloudWatch alarms 
pages are detected with the given metric 
and responded to. name have the 
(PCI-DSS-v4.0) specified settings.

11.6.1 Unauthorized sns-topic-message- Ensure that Amazon 
changes on payment delivery-notification- Simple Notification 
pages are detected enabled Service (SNS) logging 
and responded to. is enabled for the 
(PCI-DSS-v4.0) delivery status of 

notification messages 
sent to a topic for 
the endpoints. The 
rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14072



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

12.10.5 Suspected and cloudformation-sta Ensure that your 
confirmed security ck-notification-check CloudFormation 
incidents that could stacks send event 
impact the CDE notifications to 
are responded to an Amazon SNS 
immediately. (PCI- topic. Optionally 
DSS-v4.0) ensure that specified 

Amazon SNS topics 
are used. The rule is 
NON_COMPLIANT 
if CloudFormation 
stacks do not send 
notifications.

12.10.5 Suspected and cloudwatch-alarm-a Ensure that 
confirmed security ction-check CloudWatch alarms 
incidents that could have an action 
impact the CDE configured for the 
are responded to ALARM, INSUFFICI 
immediately. (PCI- ENT_DATA, or OK 
DSS-v4.0) state. Optionall 

y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14073



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

12.10.5 Suspected and cloudwatch-alarm-a Ensure that 
confirmed security ction-check CloudWatch alarms 
incidents that could have an action 
impact the CDE configured for the 
are responded to ALARM, INSUFFICI 
immediately. (PCI- ENT_DATA, or OK 
DSS-v4.0) state. Optionall 

y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

12.10.5 Suspected and cloudwatch-alarm-s Ensure that 
confirmed security ettings-check CloudWatch alarms 
incidents that could with the given metric 
impact the CDE name have the 
are responded to specified settings.
immediately. (PCI-
DSS-v4.0)

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14074



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

12.10.5 Suspected and sns-topic-message- Ensure that Amazon 
confirmed security delivery-notification- Simple Notification 
incidents that could enabled Service (SNS) logging 
impact the CDE is enabled for the 
are responded to delivery status of 
immediately. (PCI- notification messages 
DSS-v4.0) sent to a topic for 

the endpoints. The 
rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

12.4.2.1 PCI DSS compliance is service-catalog-sh Ensure that AWS 
managed. (PCI-DSS- ared-within-organi Service Catalog 
v4.0) zation shares portfolios to 

an organization (a 
collection of AWS 
accounts treated as 
a single unit) when 
integration is enabled 
with AWS Organizat 
ions. The rule is 
NON_COMPLIANT if 
the `Type` value of a 
share is `ACCOUNT`.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14075



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

2.2.5 System component cloudfront-security- Ensure that Amazon 
s are configured and policy-check CloudFront distribut 
managed securely. ions are using a 
(PCI-DSS-v4.0) minimum security 

policy and cipher 
suite of TLSv1.2 or 
greater for viewer 
connections. This 
rule is NON_COMPL 
IANT for a CloudFron 
t distribution if 
the minimumPr 
otocolVersion is 
below TLSv1.2_2018.

2.2.5 System component cloudfront-sni-ena Ensure that Amazon 
s are configured and bled CloudFront distribut 
managed securely. ions are using a 
(PCI-DSS-v4.0) custom SSL certifica 

te and are configure 
d to use SNI to serve 
HTTPS requests. The 
rule is NON_COMPL 
IANT if a custom 
SSL certificate is 
associated but the 
SSL support method 
is a dedicated IP 
address.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14076



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

2.2.5 System component transfer-family-se Ensure that a 
s are configured and rver-no-ftp server created 
managed securely. with AWS Transfer 
(PCI-DSS-v4.0) Family does not use 

FTP for endpoint 
connection. The 
rule is NON_COMPL 
IANT if the server 
protocol for endpoint 
connection is FTP-
enabled.

2.2.5 System component cloudfront-no-depr Ensure that 
s are configured and ecated-ssl-protocols CloudFront distribut 
managed securely. ions are not using 
(PCI-DSS-v4.0) deprecated SSL 

protocols for HTTPS 
communication 
between CloudFron 
t edge locations and 
custom origins. This 
rule is NON_COMPL 
IANT for a CloudFron 
t distribution if 
any'OriginSslProto 
cols' includes'SSLv3'.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14077



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

2.2.5 System component cloudfront-traffic-to- Ensure that Amazon 
s are configured and origin-encrypted CloudFront distribut 
managed securely. ions are encryptin 
(PCI-DSS-v4.0) g traffic to custom 

origins. The rule is 
NON_COMPLIANT 
if'OriginProtocolP 
olicy' is'http-only' or 
if'OriginProtocolP 
olicy' is'match-viewer' 
and'ViewerProtocol 
Policy' is'allow-all'.

2.2.5 System component cloudfront-viewer- Ensure that your 
s are configured and policy-https Amazon CloudFron 
managed securely. t distributions use 
(PCI-DSS-v4.0) HTTPS (directly or 

via a redirection). The 
rule is NON_COMPL 
IANT if the value of 
ViewerProtocolPoli 
cy is set to 'allow-al 
l' for the DefaultCa 
cheBehavior or for 
the CacheBehaviors.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14078



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

2.2.7 System component dms-redis-tls-enab Ensure that AWS 
s are configured and led Database Migration 
managed securely. Service (AWS DMS) 
(PCI-DSS-v4.0) endpoints for Redis 

data stores are 
enabled for TLS/SSL 
encryption of data 
communicated with 
other endpoints. The 
rule is NON_COMPL 
IANT if TLS/SSL 
encryption is not 
enabled.

2.2.7 System component cloudfront-no-depr Ensure that 
s are configured and ecated-ssl-protocols CloudFront distribut 
managed securely. ions are not using 
(PCI-DSS-v4.0) deprecated SSL 

protocols for HTTPS 
communication 
between CloudFron 
t edge locations and 
custom origins. This 
rule is NON_COMPL 
IANT for a CloudFron 
t distribution if 
any'OriginSslProto 
cols' includes'SSLv3'.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14079



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

2.2.7 System component cloudfront-traffic-to- Ensure that Amazon 
s are configured and origin-encrypted CloudFront distribut 
managed securely. ions are encryptin 
(PCI-DSS-v4.0) g traffic to custom 

origins. The rule is 
NON_COMPLIANT 
if'OriginProtocolP 
olicy' is'http-only' or 
if'OriginProtocolP 
olicy' is'match-viewer' 
and'ViewerProtocol 
Policy' is'allow-all'.

2.2.7 System component cloudfront-viewer- Ensure that your 
s are configured and policy-https Amazon CloudFron 
managed securely. t distributions use 
(PCI-DSS-v4.0) HTTPS (directly or 

via a redirection). The 
rule is NON_COMPL 
IANT if the value of 
ViewerProtocolPoli 
cy is set to 'allow-al 
l' for the DefaultCa 
cheBehavior or for 
the CacheBehaviors.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14080



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

2.2.7 System component elb-acm-certificate- Ensure that the 
s are configured and required Classic Load 
managed securely. Balancers use SSL 
(PCI-DSS-v4.0) certificates provided 

by AWS Certifica 
te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

2.2.7 System component dax-tls-endpoint-e Ensure that your 
s are configured and ncryption Amazon DynamoDB 
managed securely. Accelerator (DAX) 
(PCI-DSS-v4.0) cluster has ClusterEn 

dpointEncryptionTy 
pe set to TLS. The 
rule is NON_COMPL 
IANT if a DAX cluster 
is not encrypted 
by transport layer 
security (TLS).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14081



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

2.2.7 System component msk-in-cluster-node- Ensure that an 
s are configured and require-tls Amazon MSK cluster 
managed securely. enforces encryptio 
(PCI-DSS-v4.0) n in transit using 

HTTPS (TLS) with the 
broker nodes of the 
cluster. The rule is 
NON_COMPLIANT if 
plain text communica 
tion is enabled for in-
cluster broker node 
connections.

2.2.7 System component dms-endpoint-ssl-c Ensure that AWS 
s are configured and onfigured Database Migration 
managed securely. Service (AWS DMS) 
(PCI-DSS-v4.0) endpoints are 

configured with an 
SSL connection. The 
rule is NON_COMPL 
IANT if AWS DMS 
does not have an SSL 
connection configure 
d.

3.2.1 Storage of account ec2-volume-inuse-c Ensure that EBS 
data is kept to a heck volumes are attached 
minimum. (PCI-DSS- to EC2 instances. 
v4.0) Optionally ensure 

that EBS volumes are 
marked for deletion 
when an instance is 
terminated.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14082



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.2.1 Storage of account ecr-private-lifecycle- Ensure that a private 
data is kept to a policy-configured Amazon Elastic 
minimum. (PCI-DSS- Container Registry 
v4.0) (ECR) repository 

has at least one 
lifecycle policy 
configured. The rule 
is NON_COMPLIANT 
if no lifecycle policy 
is configured for the 
ECR private repositor 
y.

3.2.1 Storage of account dynamodb-pitr-enab Ensure that point-
data is kept to a led in-time recovery 
minimum. (PCI-DSS- (PITR) is enabled for 
v4.0) Amazon DynamoDB 

tables. The rule is 
NON_COMPLIANT if 
PITR is not enabled 
for DynamoDB tables.

3.2.1 Storage of account cw-loggroup-retent Ensure that an 
data is kept to a ion-period-check Amazon CloudWatch 
minimum. (PCI-DSS- LogGroup retention 
v4.0) period is set to 

greater than 365 days 
or else a specified 
retention period. The 
rule is NON_COMPL 
IANT if the retention 
period is less than 
MinRetentionTime, if 
specified, or else 365 
days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14083



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.3.1.1 Sensitive authentic ec2-volume-inuse-c Ensure that EBS 
ation data (SAD) heck volumes are attached 
is not stored after to EC2 instances. 
authorization. (PCI- Optionally ensure 
DSS-v4.0) that EBS volumes are 

marked for deletion 
when an instance is 
terminated.

3.3.1.1 Sensitive authentic ecr-private-lifecycle- Ensure that a private 
ation data (SAD) policy-configured Amazon Elastic 
is not stored after Container Registry 
authorization. (PCI- (ECR) repository 
DSS-v4.0) has at least one 

lifecycle policy 
configured. The rule 
is NON_COMPLIANT 
if no lifecycle policy 
is configured for the 
ECR private repositor 
y.

3.3.1.1 Sensitive authentic dynamodb-pitr-enab Ensure that point-
ation data (SAD) led in-time recovery 
is not stored after (PITR) is enabled for 
authorization. (PCI- Amazon DynamoDB 
DSS-v4.0) tables. The rule is 

NON_COMPLIANT if 
PITR is not enabled 
for DynamoDB tables.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14084



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.3.1.1 Sensitive authentic cw-loggroup-retent Ensure that an 
ation data (SAD) ion-period-check Amazon CloudWatch 
is not stored after LogGroup retention 
authorization. (PCI- period is set to 
DSS-v4.0) greater than 365 days 

or else a specified 
retention period. The 
rule is NON_COMPL 
IANT if the retention 
period is less than 
MinRetentionTime, if 
specified, or else 365 
days.

3.3.1.3 Sensitive authentic ec2-volume-inuse-c Ensure that EBS 
ation data (SAD) heck volumes are attached 
is not stored after to EC2 instances. 
authorization. (PCI- Optionally ensure 
DSS-v4.0) that EBS volumes are 

marked for deletion 
when an instance is 
terminated.

3.3.1.3 Sensitive authentic ecr-private-lifecycle- Ensure that a private 
ation data (SAD) policy-configured Amazon Elastic 
is not stored after Container Registry 
authorization. (PCI- (ECR) repository 
DSS-v4.0) has at least one 

lifecycle policy 
configured. The rule 
is NON_COMPLIANT 
if no lifecycle policy 
is configured for the 
ECR private repositor 
y.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14085



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.3.1.3 Sensitive authentic dynamodb-pitr-enab Ensure that point-
ation data (SAD) led in-time recovery 
is not stored after (PITR) is enabled for 
authorization. (PCI- Amazon DynamoDB 
DSS-v4.0) tables. The rule is 

NON_COMPLIANT if 
PITR is not enabled 
for DynamoDB tables.

3.3.1.3 Sensitive authentic cw-loggroup-retent Ensure that an 
ation data (SAD) ion-period-check Amazon CloudWatch 
is not stored after LogGroup retention 
authorization. (PCI- period is set to 
DSS-v4.0) greater than 365 days 

or else a specified 
retention period. The 
rule is NON_COMPL 
IANT if the retention 
period is less than 
MinRetentionTime, if 
specified, or else 365 
days.

3.3.2 Sensitive authentic ec2-volume-inuse-c Ensure that EBS 
ation data (SAD) heck volumes are attached 
is not stored after to EC2 instances. 
authorization. (PCI- Optionally ensure 
DSS-v4.0) that EBS volumes are 

marked for deletion 
when an instance is 
terminated.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14086



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.3.2 Sensitive authentic ecr-private-lifecycle- Ensure that a private 
ation data (SAD) policy-configured Amazon Elastic 
is not stored after Container Registry 
authorization. (PCI- (ECR) repository 
DSS-v4.0) has at least one 

lifecycle policy 
configured. The rule 
is NON_COMPLIANT 
if no lifecycle policy 
is configured for the 
ECR private repositor 
y.

3.3.2 Sensitive authentic dynamodb-pitr-enab Ensure that point-
ation data (SAD) led in-time recovery 
is not stored after (PITR) is enabled for 
authorization. (PCI- Amazon DynamoDB 
DSS-v4.0) tables. The rule is 

NON_COMPLIANT if 
PITR is not enabled 
for DynamoDB tables.

3.3.2 Sensitive authentic cw-loggroup-retent Ensure that an 
ation data (SAD) ion-period-check Amazon CloudWatch 
is not stored after LogGroup retention 
authorization. (PCI- period is set to 
DSS-v4.0) greater than 365 days 

or else a specified 
retention period. The 
rule is NON_COMPL 
IANT if the retention 
period is less than 
MinRetentionTime, if 
specified, or else 365 
days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14087



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.3.3 Sensitive authentic ec2-volume-inuse-c Ensure that EBS 
ation data (SAD) heck volumes are attached 
is not stored after to EC2 instances. 
authorization. (PCI- Optionally ensure 
DSS-v4.0) that EBS volumes are 

marked for deletion 
when an instance is 
terminated.

3.3.3 Sensitive authentic ecr-private-lifecycle- Ensure that a private 
ation data (SAD) policy-configured Amazon Elastic 
is not stored after Container Registry 
authorization. (PCI- (ECR) repository 
DSS-v4.0) has at least one 

lifecycle policy 
configured. The rule 
is NON_COMPLIANT 
if no lifecycle policy 
is configured for the 
ECR private repositor 
y.

3.3.3 Sensitive authentic dynamodb-pitr-enab Ensure that point-
ation data (SAD) led in-time recovery 
is not stored after (PITR) is enabled for 
authorization. (PCI- Amazon DynamoDB 
DSS-v4.0) tables. The rule is 

NON_COMPLIANT if 
PITR is not enabled 
for DynamoDB tables.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14088



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.3.3 Sensitive authentic cw-loggroup-retent Ensure that an 
ation data (SAD) ion-period-check Amazon CloudWatch 
is not stored after LogGroup retention 
authorization. (PCI- period is set to 
DSS-v4.0) greater than 365 days 

or else a specified 
retention period. The 
rule is NON_COMPL 
IANT if the retention 
period is less than 
MinRetentionTime, if 
specified, or else 365 
days.

3.5.1 Primary account athena-workgroup-e Ensure that an 
number (PAN) is ncrypted-at-rest Amazon Athena 
secured wherever it workgroup is 
is stored. (PCI-DSS- encrypted at rest. The 
v4.0) rule is NON_COMPL 

IANT if encryptio 
n of data at rest is 
not enabled for an 
Athena workgroup.

3.5.1 Primary account neptune-cluster-sn Ensure that an 
number (PAN) is apshot-encrypted Amazon Neptune DB 
secured wherever it cluster has snapshots 
is stored. (PCI-DSS- encrypted. The rule is 
v4.0) NON_COMPLIANT if a 

Neptune cluster does 
not have snapshots 
encrypted.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14089



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.5.1 Primary account redshift-cluster-kms- Ensure that Amazon 
number (PAN) is enabled Redshift clusters are 
secured wherever it using a specified AWS 
is stored. (PCI-DSS- Key Management 
v4.0) Service (AWS KMS) 

key for encryptio 
n. The rule is 
COMPLIANT if 
encryption is enabled 
and the cluster is 
encrypted with 
the key provided 
in the kmsKeyArn 
parameter. The rule 
is NON_COMPL 
IANT if the cluster 
is not encrypted 
or encrypted with 
another key.

3.5.1 Primary account codebuild-project- Ensure that an AWS 
number (PAN) is artifact-encryption CodeBuild project 
secured wherever it has encryption 
is stored. (PCI-DSS- enabled for all of its 
v4.0) artifacts. The rule is 

NON_COMPLIANT if 
'encryptionDisabled' 
is set to 'true' for any 
primary or secondary 
(if present) artifact 
configurations.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14090



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.5.1 Primary account codebuild-project-s3- Ensure that an AWS 
number (PAN) is logs-encrypted CodeBuild project 
secured wherever it configured with 
is stored. (PCI-DSS- Amazon S3 Logs has 
v4.0) encryption enabled 

for its logs. The rule 
is NON_COMPLIANT 
if'encryptionDisab 
led' is set to'true' in 
a S3LogsConfig of a 
CodeBuild project.

3.5.1 Primary account dax-encryption-ena Ensure that Amazon 
number (PAN) is bled DynamoDB Accelerat 
secured wherever it or (DAX) clusters are 
is stored. (PCI-DSS- encrypted. The rule 
v4.0) is NON_COMPLIANT 

if a DAX cluster is not 
encrypted.

3.5.1 Primary account eks-secrets-encryp Ensure that Amazon 
number (PAN) is ted Elastic Kubernetes 
secured wherever it Service clusters are 
is stored. (PCI-DSS- configured to have 
v4.0) Kubernetes secrets 

encrypted using AWS 
Key Management 
Service (KMS) keys.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14091



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.5.1 Primary account api-gw-cache-enabl Ensure that all 
number (PAN) is ed-and-encrypted methods in Amazon 
secured wherever it API Gateway 
is stored. (PCI-DSS- stages have cache 
v4.0) enabled and cache 

encrypted. The rule 
is NON_COMPL 
IANT if any method 
in an Amazon API 
Gateway stage is not 
configured to cache 
or the cache is not 
encrypted.

3.5.1 Primary account docdb-cluster-encr Ensure that storage 
number (PAN) is ypted encryption is enabled 
secured wherever it for your Amazon 
is stored. (PCI-DSS- DocumentDB (with 
v4.0) MongoDB compatibi 

lity) clusters. The rule 
is NON_COMPLIANT 
if storage encryption 
is not enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14092



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.5.1 Primary account dynamodb-table-enc Ensure that Amazon 
number (PAN) is rypted-kms DynamoDB table is 
secured wherever it encrypted with AWS 
is stored. (PCI-DSS- Key Management 
v4.0) Service (KMS). The 

rule is NON_COMPL 
IANT if Amazon 
DynamoDB table is 
not encrypted with 
AWS KMS. The rule 
is also NON_COMPL 
IANT if the encrypted 
AWS KMS key is not 
present in kmsKeyArn 
s input parameter.

3.5.1 Primary account dynamodb-table-enc Ensure that the 
number (PAN) is ryption-enabled Amazon DynamoDB 
secured wherever it tables are encrypted 
is stored. (PCI-DSS- and checks their 
v4.0) status. The rule is 

COMPLIANT if the 
status is enabled or 
enabling.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14093



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.5.1 Primary account codebuild-project- Ensure that the 
number (PAN) is envvar-awscred-che project DOES NOT 
secured wherever it ck contain environment 
is stored. (PCI-DSS- variables AWS_ACCES 
v4.0) S_KEY_ID and 

AWS_SECRE 
T_ACCESS_KEY. The 
rule is NON_COMPL 
IANT when the 
project environme 
nt variables contains 
plaintext credentials.

3.5.1 Primary account eks-cluster-secrets- Ensure that Amazon 
number (PAN) is encrypted EKS clusters are not 
secured wherever it configured to have 
is stored. (PCI-DSS- Kubernetes secrets 
v4.0) encrypted using 

AWS KMS. The rule is 
NON_COMPLIANT if 
an EKS cluster does 
not have an encryptio 
nConfig resource or 
if encryptionConfig 
does not name 
secrets as a resource.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14094



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.5.1 Primary account kinesis-stream-enc Ensure that Amazon 
number (PAN) is rypted Kinesis streams are 
secured wherever it encrypted at rest 
is stored. (PCI-DSS- with server-side 
v4.0) encryption. The rule 

is NON_COMPLIANT 
for a Kinesis stream if 
'StreamEncryption' is 
not present.

3.5.1 Primary account neptune-cluster-en Ensure that storage 
number (PAN) is crypted encryption is 
secured wherever it enabled for your 
is stored. (PCI-DSS- Amazon Neptune DB 
v4.0) clusters. The rule is 

NON_COMPLIANT if 
storage encryption is 
not enabled.

3.5.1.1 Primary account acm-pca-root-ca-di Ensure that AWS 
number (PAN) is sabled Private Certifica 
secured wherever it te Authority (AWS 
is stored. (PCI-DSS- Private CA) has 
v4.0) a root CA that is 

disabled. The rule is 
NON_COMPLIANT for 
root CAs with status 
that is not DISABLED.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14095



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.5.1.1 Primary account cloudfront-custom- Ensure that the 
number (PAN) is ssl-certificate certificate associate 
secured wherever it d with an Amazon 
is stored. (PCI-DSS- CloudFront distribut 
v4.0) ion is not the default 

SSL certificate. The 
rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

3.5.1.1 Primary account elb-acm-certificate- Ensure that the 
number (PAN) is required Classic Load 
secured wherever it Balancers use SSL 
is stored. (PCI-DSS- certificates provided 
v4.0) by AWS Certifica 

te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14096



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.5.1.3 Primary account acm-pca-root-ca-di Ensure that AWS 
number (PAN) is sabled Private Certifica 
secured wherever it te Authority (AWS 
is stored. (PCI-DSS- Private CA) has 
v4.0) a root CA that is 

disabled. The rule is 
NON_COMPLIANT for 
root CAs with status 
that is not DISABLED.

3.5.1.3 Primary account cloudfront-custom- Ensure that the 
number (PAN) is ssl-certificate certificate associate 
secured wherever it d with an Amazon 
is stored. (PCI-DSS- CloudFront distribut 
v4.0) ion is not the default 

SSL certificate. The 
rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

3.5.1.3 Primary account neptune-cluster-sn Ensure that an 
number (PAN) is apshot-public-proh Amazon Neptune 
secured wherever it ibited manual DB cluster 
is stored. (PCI-DSS- snapshot is not 
v4.0) public. The rule is 

NON_COMPLIANT 
if any existing and 
new Neptune cluster 
snapshot is public.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14097



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.5.1.3 Primary account docdb-cluster-snap Ensure that Amazon 
number (PAN) is shot-public-prohib DocumentDB manual 
secured wherever it ited cluster snapshots 
is stored. (PCI-DSS- are not public. The 
v4.0) rule is NON_COMPL 

IANT if any Amazon 
DocumentDB manual 
cluster snapshots are 
public.

3.5.1.3 Primary account backup-recovery-po Ensure that a backup 
number (PAN) is int-manual-deletion- vault has an attached 
secured wherever it disabled resource-based 
is stored. (PCI-DSS- policy which prevents 
v4.0) deletion of recovery 

points. The rule 
is NON_COMPL 
IANT if the Backup 
Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14098



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.5.1.3 Primary account elb-acm-certificate- Ensure that the 
number (PAN) is required Classic Load 
secured wherever it Balancers use SSL 
is stored. (PCI-DSS- certificates provided 
v4.0) by AWS Certifica 

te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

3.5.1.3 Primary account emr-block-public-a Ensure that an 
number (PAN) is ccess account with Amazon 
secured wherever it EMR has block public 
is stored. (PCI-DSS- access settings 
v4.0) enabled. The rule is 

NON_COMPLIANT if 
BlockPublicSecurit 
yGroupRules is false, 
or if true, ports other 
than Port 22 are 
listed in Permitted 
PublicSecurityGrou 
pRuleRanges.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14099



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.5.1.3 Primary account s3-access-point-pu Ensure that Amazon 
number (PAN) is blic-access-blocks S3 access points have 
secured wherever it block public access 
is stored. (PCI-DSS- settings enabled. The 
v4.0) rule is NON_COMPL 

IANT if block public 
access settings are 
not enabled for S3 
access points.

3.5.1.3 Primary account s3-account-level-p Ensure that the 
number (PAN) is ublic-access-blocks required public 
secured wherever it access block settings 
is stored. (PCI-DSS- are configured 
v4.0) from account level. 

The rule is only 
NON_COMPLIANT 
when the fields set 
below do not match 
the corresponding 
fields in the configura 
tion item.

3.5.1.3 Primary account s3-bucket-mfa-dele Ensure that MFA 
number (PAN) is te-enabled Delete is enabled in 
secured wherever it the Amazon Simple 
is stored. (PCI-DSS- Storage Service 
v4.0) (Amazon S3) bucket 

versioning configura 
tion. The rule is 
NON_COMPLIANT 
if MFA Delete is not 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14100



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.6.1 Cryptographic keys acm-pca-root-ca-di Ensure that AWS 
used to protect sabled Private Certifica 
stored account data te Authority (AWS 
are secured. (PCI- Private CA) has 
DSS-v4.0) a root CA that is 

disabled. The rule is 
NON_COMPLIANT for 
root CAs with status 
that is not DISABLED.

3.6.1 Cryptographic keys cloudfront-custom- Ensure that the 
used to protect ssl-certificate certificate associate 
stored account data d with an Amazon 
are secured. (PCI- CloudFront distribut 
DSS-v4.0) ion is not the default 

SSL certificate. The 
rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14101



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.6.1 Cryptographic keys elb-acm-certificate- Ensure that the 
used to protect required Classic Load 
stored account data Balancers use SSL 
are secured. (PCI- certificates provided 
DSS-v4.0) by AWS Certifica 

te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

3.6.1.2 Cryptographic keys acm-pca-root-ca-di Ensure that AWS 
used to protect sabled Private Certifica 
stored account data te Authority (AWS 
are secured. (PCI- Private CA) has 
DSS-v4.0) a root CA that is 

disabled. The rule is 
NON_COMPLIANT for 
root CAs with status 
that is not DISABLED.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14102



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.6.1.2 Cryptographic keys cloudfront-custom- Ensure that the 
used to protect ssl-certificate certificate associate 
stored account data d with an Amazon 
are secured. (PCI- CloudFront distribut 
DSS-v4.0) ion is not the default 

SSL certificate. The 
rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

3.6.1.2 Cryptographic keys elb-acm-certificate- Ensure that the 
used to protect required Classic Load 
stored account data Balancers use SSL 
are secured. (PCI- certificates provided 
DSS-v4.0) by AWS Certifica 

te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14103



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.6.1.3 Cryptographic keys acm-pca-root-ca-di Ensure that AWS 
used to protect sabled Private Certifica 
stored account data te Authority (AWS 
are secured. (PCI- Private CA) has 
DSS-v4.0) a root CA that is 

disabled. The rule is 
NON_COMPLIANT for 
root CAs with status 
that is not DISABLED.

3.6.1.3 Cryptographic keys cloudfront-custom- Ensure that the 
used to protect ssl-certificate certificate associate 
stored account data d with an Amazon 
are secured. (PCI- CloudFront distribut 
DSS-v4.0) ion is not the default 

SSL certificate. The 
rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14104



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.6.1.3 Cryptographic keys elb-acm-certificate- Ensure that the 
used to protect required Classic Load 
stored account data Balancers use SSL 
are secured. (PCI- certificates provided 
DSS-v4.0) by AWS Certifica 

te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

3.6.1.4 Cryptographic keys acm-pca-root-ca-di Ensure that AWS 
used to protect sabled Private Certifica 
stored account data te Authority (AWS 
are secured. (PCI- Private CA) has 
DSS-v4.0) a root CA that is 

disabled. The rule is 
NON_COMPLIANT for 
root CAs with status 
that is not DISABLED.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14105



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.6.1.4 Cryptographic keys cloudfront-custom- Ensure that the 
used to protect ssl-certificate certificate associate 
stored account data d with an Amazon 
are secured. (PCI- CloudFront distribut 
DSS-v4.0) ion is not the default 

SSL certificate. The 
rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

3.6.1.4 Cryptographic keys elb-acm-certificate- Ensure that the 
used to protect required Classic Load 
stored account data Balancers use SSL 
are secured. (PCI- certificates provided 
DSS-v4.0) by AWS Certifica 

te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14106



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.7.1 Where cryptography acm-certificate-rsa- Ensure that RSA 
is used to protect check certificates managed 
stored account data, by AWS Certificate 
key managemen Manager (ACM) have 
t processes and a key length of at 
procedures covering least '2048' bits.The 
all aspects of the key rule is NON_COMPL 
lifecycle are defined IANT if the minimum 
and implemented. key length is less 
(PCI-DSS-v4.0) than 2048 bits.

3.7.1 Where cryptography acm-pca-root-ca-di Ensure that AWS 
is used to protect sabled Private Certifica 
stored account data, te Authority (AWS 
key managemen Private CA) has 
t processes and a root CA that is 
procedures covering disabled. The rule is 
all aspects of the key NON_COMPLIANT for 
lifecycle are defined root CAs with status 
and implemented. that is not DISABLED.
(PCI-DSS-v4.0)

3.7.1 Where cryptography cloudfront-custom- Ensure that the 
is used to protect ssl-certificate certificate associate 
stored account data, d with an Amazon 
key managemen CloudFront distribut 
t processes and ion is not the default 
procedures covering SSL certificate. The 
all aspects of the key rule is NON_COMPL 
lifecycle are defined IANT if a CloudFront 
and implemented. distribution uses the 
(PCI-DSS-v4.0) default SSL certifica 

te.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14107



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.7.1 Where cryptography elb-acm-certificate- Ensure that the 
is used to protect required Classic Load 
stored account data, Balancers use SSL 
key managemen certificates provided 
t processes and by AWS Certifica 
procedures covering te Manager. To use 
all aspects of the key this rule, use an SSL 
lifecycle are defined or HTTPS listener 
and implemented. with your Classic 
(PCI-DSS-v4.0) Load Balancer. Note 

- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

3.7.2 Where cryptography acm-pca-root-ca-di Ensure that AWS 
is used to protect sabled Private Certifica 
stored account data, te Authority (AWS 
key managemen Private CA) has 
t processes and a root CA that is 
procedures covering disabled. The rule is 
all aspects of the key NON_COMPLIANT for 
lifecycle are defined root CAs with status 
and implemented. that is not DISABLED.
(PCI-DSS-v4.0)

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14108



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.7.2 Where cryptography cloudfront-custom- Ensure that the 
is used to protect ssl-certificate certificate associate 
stored account data, d with an Amazon 
key managemen CloudFront distribut 
t processes and ion is not the default 
procedures covering SSL certificate. The 
all aspects of the key rule is NON_COMPL 
lifecycle are defined IANT if a CloudFront 
and implemented. distribution uses the 
(PCI-DSS-v4.0) default SSL certifica 

te.

3.7.2 Where cryptography elb-acm-certificate- Ensure that the 
is used to protect required Classic Load 
stored account data, Balancers use SSL 
key managemen certificates provided 
t processes and by AWS Certifica 
procedures covering te Manager. To use 
all aspects of the key this rule, use an SSL 
lifecycle are defined or HTTPS listener 
and implemented. with your Classic 
(PCI-DSS-v4.0) Load Balancer. Note 

- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14109



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.7.4 Where cryptography acm-pca-root-ca-di Ensure that AWS 
is used to protect sabled Private Certifica 
stored account data, te Authority (AWS 
key managemen Private CA) has 
t processes and a root CA that is 
procedures covering disabled. The rule is 
all aspects of the key NON_COMPLIANT for 
lifecycle are defined root CAs with status 
and implemented. that is not DISABLED.
(PCI-DSS-v4.0)

3.7.4 Where cryptography cloudfront-custom- Ensure that the 
is used to protect ssl-certificate certificate associate 
stored account data, d with an Amazon 
key managemen CloudFront distribut 
t processes and ion is not the default 
procedures covering SSL certificate. The 
all aspects of the key rule is NON_COMPL 
lifecycle are defined IANT if a CloudFront 
and implemented. distribution uses the 
(PCI-DSS-v4.0) default SSL certifica 

te.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14110



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.7.4 Where cryptography elb-acm-certificate- Ensure that the 
is used to protect required Classic Load 
stored account data, Balancers use SSL 
key managemen certificates provided 
t processes and by AWS Certifica 
procedures covering te Manager. To use 
all aspects of the key this rule, use an SSL 
lifecycle are defined or HTTPS listener 
and implemented. with your Classic 
(PCI-DSS-v4.0) Load Balancer. Note 

- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

3.7.6 Where cryptography acm-pca-root-ca-di Ensure that AWS 
is used to protect sabled Private Certifica 
stored account data, te Authority (AWS 
key managemen Private CA) has 
t processes and a root CA that is 
procedures covering disabled. The rule is 
all aspects of the key NON_COMPLIANT for 
lifecycle are defined root CAs with status 
and implemented. that is not DISABLED.
(PCI-DSS-v4.0)

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14111



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.7.6 Where cryptography cloudfront-custom- Ensure that the 
is used to protect ssl-certificate certificate associate 
stored account data, d with an Amazon 
key managemen CloudFront distribut 
t processes and ion is not the default 
procedures covering SSL certificate. The 
all aspects of the key rule is NON_COMPL 
lifecycle are defined IANT if a CloudFront 
and implemented. distribution uses the 
(PCI-DSS-v4.0) default SSL certifica 

te.

3.7.6 Where cryptography elb-acm-certificate- Ensure that the 
is used to protect required Classic Load 
stored account data, Balancers use SSL 
key managemen certificates provided 
t processes and by AWS Certifica 
procedures covering te Manager. To use 
all aspects of the key this rule, use an SSL 
lifecycle are defined or HTTPS listener 
and implemented. with your Classic 
(PCI-DSS-v4.0) Load Balancer. Note 

- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14112



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.7.7 Where cryptography acm-pca-root-ca-di Ensure that AWS 
is used to protect sabled Private Certifica 
stored account data, te Authority (AWS 
key managemen Private CA) has 
t processes and a root CA that is 
procedures covering disabled. The rule is 
all aspects of the key NON_COMPLIANT for 
lifecycle are defined root CAs with status 
and implemented. that is not DISABLED.
(PCI-DSS-v4.0)

3.7.7 Where cryptography cloudfront-custom- Ensure that the 
is used to protect ssl-certificate certificate associate 
stored account data, d with an Amazon 
key managemen CloudFront distribut 
t processes and ion is not the default 
procedures covering SSL certificate. The 
all aspects of the key rule is NON_COMPL 
lifecycle are defined IANT if a CloudFront 
and implemented. distribution uses the 
(PCI-DSS-v4.0) default SSL certifica 

te.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14113



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

3.7.7 Where cryptography elb-acm-certificate- Ensure that the 
is used to protect required Classic Load 
stored account data, Balancers use SSL 
key managemen certificates provided 
t processes and by AWS Certifica 
procedures covering te Manager. To use 
all aspects of the key this rule, use an SSL 
lifecycle are defined or HTTPS listener 
and implemented. with your Classic 
(PCI-DSS-v4.0) Load Balancer. Note 

- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

4.2.1 PAN is protected with dms-redis-tls-enab Ensure that AWS 
strong cryptography led Database Migration 
during transmission. Service (AWS DMS) 
(PCI-DSS-v4.0) endpoints for Redis 

data stores are 
enabled for TLS/SSL 
encryption of data 
communicated with 
other endpoints. The 
rule is NON_COMPL 
IANT if TLS/SSL 
encryption is not 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14114



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

4.2.1 PAN is protected with cloudfront-no-depr Ensure that 
strong cryptography ecated-ssl-protocols CloudFront distribut 
during transmission. ions are not using 
(PCI-DSS-v4.0) deprecated SSL 

protocols for HTTPS 
communication 
between CloudFron 
t edge locations and 
custom origins. This 
rule is NON_COMPL 
IANT for a CloudFron 
t distribution if 
any'OriginSslProto 
cols' includes'SSLv3'.

4.2.1 PAN is protected with cloudfront-traffic-to- Ensure that Amazon 
strong cryptography origin-encrypted CloudFront distribut 
during transmission. ions are encryptin 
(PCI-DSS-v4.0) g traffic to custom 

origins. The rule is 
NON_COMPLIANT 
if'OriginProtocolP 
olicy' is'http-only' or 
if'OriginProtocolP 
olicy' is'match-viewer' 
and'ViewerProtocol 
Policy' is'allow-all'.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14115



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

4.2.1 PAN is protected with cloudfront-viewer- Ensure that your 
strong cryptography policy-https Amazon CloudFron 
during transmission. t distributions use 
(PCI-DSS-v4.0) HTTPS (directly or 

via a redirection). The 
rule is NON_COMPL 
IANT if the value of 
ViewerProtocolPoli 
cy is set to 'allow-al 
l' for the DefaultCa 
cheBehavior or for 
the CacheBehaviors.

4.2.1 PAN is protected with elb-acm-certificate- Ensure that the 
strong cryptography required Classic Load 
during transmission. Balancers use SSL 
(PCI-DSS-v4.0) certificates provided 

by AWS Certifica 
te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14116



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

4.2.1 PAN is protected with dax-tls-endpoint-e Ensure that your 
strong cryptography ncryption Amazon DynamoDB 
during transmission. Accelerator (DAX) 
(PCI-DSS-v4.0) cluster has ClusterEn 

dpointEncryptionTy 
pe set to TLS. The 
rule is NON_COMPL 
IANT if a DAX cluster 
is not encrypted 
by transport layer 
security (TLS).

4.2.1 PAN is protected with msk-in-cluster-node- Ensure that an 
strong cryptography require-tls Amazon MSK cluster 
during transmission. enforces encryptio 
(PCI-DSS-v4.0) n in transit using 

HTTPS (TLS) with the 
broker nodes of the 
cluster. The rule is 
NON_COMPLIANT if 
plain text communica 
tion is enabled for in-
cluster broker node 
connections.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14117



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

4.2.1 PAN is protected with dms-endpoint-ssl-c Ensure that AWS 
strong cryptography onfigured Database Migration 
during transmission. Service (AWS DMS) 
(PCI-DSS-v4.0) endpoints are 

configured with an 
SSL connection. The 
rule is NON_COMPL 
IANT if AWS DMS 
does not have an SSL 
connection configure 
d.

4.2.1.1 PAN is protected with acm-pca-root-ca-di Ensure that AWS 
strong cryptography sabled Private Certifica 
during transmission. te Authority (AWS 
(PCI-DSS-v4.0) Private CA) has 

a root CA that is 
disabled. The rule is 
NON_COMPLIANT for 
root CAs with status 
that is not DISABLED.

4.2.1.1 PAN is protected with cloudfront-custom- Ensure that the 
strong cryptography ssl-certificate certificate associate 
during transmission. d with an Amazon 
(PCI-DSS-v4.0) CloudFront distribut 

ion is not the default 
SSL certificate. The 
rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14118



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

4.2.1.1 PAN is protected with dms-redis-tls-enab Ensure that AWS 
strong cryptography led Database Migration 
during transmission. Service (AWS DMS) 
(PCI-DSS-v4.0) endpoints for Redis 

data stores are 
enabled for TLS/SSL 
encryption of data 
communicated with 
other endpoints. The 
rule is NON_COMPL 
IANT if TLS/SSL 
encryption is not 
enabled.

4.2.1.1 PAN is protected with cloudfront-no-depr Ensure that 
strong cryptography ecated-ssl-protocols CloudFront distribut 
during transmission. ions are not using 
(PCI-DSS-v4.0) deprecated SSL 

protocols for HTTPS 
communication 
between CloudFron 
t edge locations and 
custom origins. This 
rule is NON_COMPL 
IANT for a CloudFron 
t distribution if 
any'OriginSslProto 
cols' includes'SSLv3'.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14119



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

4.2.1.1 PAN is protected with cloudfront-traffic-to- Ensure that Amazon 
strong cryptography origin-encrypted CloudFront distribut 
during transmission. ions are encryptin 
(PCI-DSS-v4.0) g traffic to custom 

origins. The rule is 
NON_COMPLIANT 
if'OriginProtocolP 
olicy' is'http-only' or 
if'OriginProtocolP 
olicy' is'match-viewer' 
and'ViewerProtocol 
Policy' is'allow-all'.

4.2.1.1 PAN is protected with cloudfront-viewer- Ensure that your 
strong cryptography policy-https Amazon CloudFron 
during transmission. t distributions use 
(PCI-DSS-v4.0) HTTPS (directly or 

via a redirection). The 
rule is NON_COMPL 
IANT if the value of 
ViewerProtocolPoli 
cy is set to 'allow-al 
l' for the DefaultCa 
cheBehavior or for 
the CacheBehaviors.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14120



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

4.2.1.1 PAN is protected with elb-acm-certificate- Ensure that the 
strong cryptography required Classic Load 
during transmission. Balancers use SSL 
(PCI-DSS-v4.0) certificates provided 

by AWS Certifica 
te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

4.2.1.1 PAN is protected with dax-tls-endpoint-e Ensure that your 
strong cryptography ncryption Amazon DynamoDB 
during transmission. Accelerator (DAX) 
(PCI-DSS-v4.0) cluster has ClusterEn 

dpointEncryptionTy 
pe set to TLS. The 
rule is NON_COMPL 
IANT if a DAX cluster 
is not encrypted 
by transport layer 
security (TLS).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14121



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

4.2.1.1 PAN is protected with msk-in-cluster-node- Ensure that an 
strong cryptography require-tls Amazon MSK cluster 
during transmission. enforces encryptio 
(PCI-DSS-v4.0) n in transit using 

HTTPS (TLS) with the 
broker nodes of the 
cluster. The rule is 
NON_COMPLIANT if 
plain text communica 
tion is enabled for in-
cluster broker node 
connections.

4.2.1.1 PAN is protected with dms-endpoint-ssl-c Ensure that AWS 
strong cryptography onfigured Database Migration 
during transmission. Service (AWS DMS) 
(PCI-DSS-v4.0) endpoints are 

configured with an 
SSL connection. The 
rule is NON_COMPL 
IANT if AWS DMS 
does not have an SSL 
connection configure 
d.

5.3.4 Anti-malware api-gwv2-access-lo Ensure that Amazon 
mechanisms and gs-enabled API Gateway V2 
processes are active, stages have access 
maintained, and logging enabled. The 
monitored. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if 'accessLo 

gSettings' is not 
present in Stage 
configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14122



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

5.3.4 Anti-malware api-gw-xray-enabled Ensure that AWS 
mechanisms and X-Ray tracing is 
processes are active, enabled on Amazon 
maintained, and API Gateway REST 
monitored. (PCI-DSS- APIs. The rule is 
v4.0) COMPLIANT if X-Ray 

tracing is enabled 
and NON_COMPL 
IANT otherwise.

5.3.4 Anti-malware cloudfront-accessl Ensure that Amazon 
mechanisms and ogs-enabled CloudFront distribut 
processes are active, ions are configure 
maintained, and d to deliver access 
monitored. (PCI-DSS- logs to an Amazon 
v4.0) S3 bucket. The rule is 

NON_COMPLIANT if a 
CloudFront distribut 
ion does not have 
logging configured.

5.3.4 Anti-malware cloudtrail-security- Ensure that there 
mechanisms and trail-enabled is at least one AWS 
processes are active, CloudTrail trail 
maintained, and defined with security 
monitored. (PCI-DSS- best practices. This 
v4.0) rule is COMPLIANT if 

there is at least one 
trail that meets all of 
the following:

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14123



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

5.3.4 Anti-malware neptune-cluster-cl Ensure that an 
mechanisms and oudwatch-log-expor Amazon Neptune 
processes are active, t-enabled cluster has 
maintained, and CloudWatch log 
monitored. (PCI-DSS- export enabled for 
v4.0) audit logs. The rule is 

NON_COMPLIANT if a 
Neptune cluster does 
not have CloudWatc 
h log export enabled 
for audit logs.

5.3.4 Anti-malware ecs-task-definition- Ensure that logConfig 
mechanisms and log-configuration uration is set on 
processes are active, active ECS Task 
maintained, and Definitions. This 
monitored. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if an active 

ECSTaskDefinition 
does not have the 
logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14124



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

5.3.4 Anti-malware cloudtrail-enabled Note: For this rule, 
mechanisms and the rule identifie 
processes are active, r (CLOUD_TR 
maintained, and AIL_ENABLED) and 
monitored. (PCI-DSS- rule name (cloudtrail-
v4.0) enabled) are different 

. Ensure that an AWS 
CloudTrail trail is 
enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14125



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

5.3.4 Anti-malware multi-region-cloud Note: for this rule, 
mechanisms and trail-enabled the rule identifie 
processes are active, r (MULTI_RE 
maintained, and GION_CLOU 
monitored. (PCI-DSS- D_TRAIL_ENABLED) 
v4.0) and rule name 

(multi-region-clou 
dtrail-enabled) are 
different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14126



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

5.3.4 Anti-malware appsync-logging-en Ensure that an AWS 
mechanisms and abled AppSync API has 
processes are active, logging enabled. The 
maintained, and rule is NON_COMPL 
monitored. (PCI-DSS- IANT if logging is not 
v4.0) enabled, or 'fieldLog 

Level' is neither 
ERROR nor ALL.

5.3.4 Anti-malware waf-classic-logging- Ensure that logging is 
mechanisms and enabled enabled on AWS WAF 
processes are active, classic global web 
maintained, and access control lists 
monitored. (PCI-DSS- (web ACLs). The rule 
v4.0) is NON_COMPLIANT 

for a global web ACL, 
if it does not have 
logging enabled.

5.3.4 Anti-malware mq-cloudwatch-audi Ensure that Amazon 
mechanisms and t-logging-enabled MQ brokers have 
processes are active, Amazon CloudWatc 
maintained, and h audit logging 
monitored. (PCI-DSS- enabled. The rule is 
v4.0) NON_COMPLIANT 

if a broker does not 
have audit logging 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14127



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

5.3.4 Anti-malware mq-cloudwatch-audi Ensure that an 
mechanisms and t-log-enabled Amazon MQ broker 
processes are active, has CloudWatch audit 
maintained, and logging enabled. The 
monitored. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if the broker 

does not have audit 
logging enabled.

5.3.4 Anti-malware eks-cluster-logging- Ensure that an 
mechanisms and enabled Amazon Elastic 
processes are active, Kubernetes Service 
maintained, and (Amazon EKS) cluster 
monitored. (PCI-DSS- is configured with 
v4.0) logging enabled. The 

rule is NON_COMPL 
IANT if logging for 
Amazon EKS clusters 
is not enabled for all 
log types.

5.3.4 Anti-malware elastic-beanstalk- Ensure that AWS 
mechanisms and logs-to-cloudwatch Elastic Beanstalk 
processes are active, environments 
maintained, and are configured 
monitored. (PCI-DSS- to send logs to 
v4.0) Amazon CloudWatc 

h Logs. The rule 
is NON_COMPL 
IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14128



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

5.3.4 Anti-malware step-functions-sta Ensure that AWS 
mechanisms and te-machine-logging- Step Functions 
processes are active, enabled machine has logging 
maintained, and enabled. The rule is 
monitored. (PCI-DSS- NON_COMPLIANT if 
v4.0) a state machine does 

not have logging 
enabled or the 
logging configura 
tion is not at the 
minimum level 
provided.

5.3.4 Anti-malware netfw-logging-enab Ensure that AWS 
mechanisms and led Network Firewall 
processes are active, firewalls have logging 
maintained, and enabled. The rule is 
monitored. (PCI-DSS- NON_COMPLIANT if 
v4.0) a logging type is not 

configured. You can 
specify which logging 
type you want the 
rule to check.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14129



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

5.3.4 Anti-malware cw-loggroup-retent Ensure that an 
mechanisms and ion-period-check Amazon CloudWatch 
processes are active, LogGroup retention 
maintained, and period is set to 
monitored. (PCI-DSS- greater than 365 days 
v4.0) or else a specified 

retention period. The 
rule is NON_COMPL 
IANT if the retention 
period is less than 
MinRetentionTime, if 
specified, or else 365 
days.

6.3.3 Security vulnerabi lambda-function-se Ensure that the AWS 
lities are identified ttings-check Lambda function 
and addressed. (PCI- settings for runtime, 
DSS-v4.0) role, timeout, and 

memory size match 
the expected values. 
The rule ignores 
functions with the 
'Image' package type 
and functions with 
runtime set to 'OS-
only Runtime'. The 
rule is NON_COMPL 
IANT if the Lambda 
function settings 
do not match the 
expected values.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14130



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

6.3.3 Security vulnerabi eks-cluster-oldest- Ensure that an 
lities are identified supported-version Amazon Elastic 
and addressed. (PCI- Kubernetes Service 
DSS-v4.0) (EKS) cluster is 

not running the 
oldest supported 
version. The rule 
is NON_COMPL 
IANT if an EKS 
cluster is running 
oldest supported 
version (equal to the 
parameter 'oldestVe 
rsionSupported').

6.4.1 Public-facing web cloudfront-associa Ensure that Amazon 
applications are ted-with-waf CloudFront distribut 
protected against ions are associate 
attacks. (PCI-DSS- d with either web 
v4.0) application firewall 

(WAF) or WAFv2 web 
access control lists 
(ACLs). The rule is 
NON_COMPLIANT if a 
CloudFront distribut 
ion is not associated 
with a WAF web ACL.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14131



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

6.4.1 Public-facing web appsync-associated- Ensure that AWS 
applications are with-waf AppSync APIs are 
protected against associated with 
attacks. (PCI-DSS- AWS WAFv2 web 
v4.0) access control lists 

(ACLs). The rule is 
NON_COMPLIANT for 
an AWS AppSync API 
if it is not associated 
with a web ACL.

6.4.1 Public-facing web wafv2-webacl-not-e Ensure that a WAFv2 
applications are mpty Web ACL contains 
protected against any WAF rules or WAF 
attacks. (PCI-DSS- rule groups. This rule 
v4.0) is NON_COMPLIANT 

if a Web ACL does 
not contain any WAF 
rules or WAF rule 
groups.

6.4.1 Public-facing web wafv2-rulegroup-not- Ensure that WAFv2 
applications are empty Rule Groups contain 
protected against rules. The rule is 
attacks. (PCI-DSS- NON_COMPLIANT if 
v4.0) there are no rules in a 

WAFv2 Rule Group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14132



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

6.4.1 Public-facing web waf-global-webacl- Ensure that a WAF 
applications are not-empty Global Web ACL 
protected against contains some 
attacks. (PCI-DSS- WAF rules or rule 
v4.0) groups. This rule is 

NON_COMPLIANT if 
a Web ACL does not 
contain any WAF rule 
or rule group.

6.4.1 Public-facing web waf-global-rulegro Ensure that an AWS 
applications are up-not-empty WAF Classic rule 
protected against group contains some 
attacks. (PCI-DSS- rules. The rule is 
v4.0) NON_COMPLIANT 

if there are no rules 
present within a rule 
group.

6.4.1 Public-facing web waf-global-rulegro Ensure that an AWS 
applications are up-not-empty WAF Classic rule 
protected against group contains some 
attacks. (PCI-DSS- rules. The rule is 
v4.0) NON_COMPLIANT 

if there are no rules 
present within a rule 
group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14133



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

6.4.1 Public-facing web waf-global-rule-not- Ensure that an 
applications are empty AWS WAF global 
protected against rule contains some 
attacks. (PCI-DSS- conditions. The rule 
v4.0) is NON_COMPLIANT 

if no conditions are 
present within the 
WAF global rule.

6.4.2 Public-facing web cloudfront-associa Ensure that Amazon 
applications are ted-with-waf CloudFront distribut 
protected against ions are associate 
attacks. (PCI-DSS- d with either web 
v4.0) application firewall 

(WAF) or WAFv2 web 
access control lists 
(ACLs). The rule is 
NON_COMPLIANT if a 
CloudFront distribut 
ion is not associated 
with a WAF web ACL.

6.4.2 Public-facing web appsync-associated- Ensure that AWS 
applications are with-waf AppSync APIs are 
protected against associated with 
attacks. (PCI-DSS- AWS WAFv2 web 
v4.0) access control lists 

(ACLs). The rule is 
NON_COMPLIANT for 
an AWS AppSync API 
if it is not associated 
with a web ACL.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14134



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

6.4.2 Public-facing web wafv2-webacl-not-e Ensure that a WAFv2 
applications are mpty Web ACL contains 
protected against any WAF rules or WAF 
attacks. (PCI-DSS- rule groups. This rule 
v4.0) is NON_COMPLIANT 

if a Web ACL does 
not contain any WAF 
rules or WAF rule 
groups.

6.4.2 Public-facing web wafv2-rulegroup-not- Ensure that WAFv2 
applications are empty Rule Groups contain 
protected against rules. The rule is 
attacks. (PCI-DSS- NON_COMPLIANT if 
v4.0) there are no rules in a 

WAFv2 Rule Group.

6.4.2 Public-facing web waf-global-webacl- Ensure that a WAF 
applications are not-empty Global Web ACL 
protected against contains some 
attacks. (PCI-DSS- WAF rules or rule 
v4.0) groups. This rule is 

NON_COMPLIANT if 
a Web ACL does not 
contain any WAF rule 
or rule group.

6.4.2 Public-facing web waf-global-rulegro Ensure that an AWS 
applications are up-not-empty WAF Classic rule 
protected against group contains some 
attacks. (PCI-DSS- rules. The rule is 
v4.0) NON_COMPLIANT 

if there are no rules 
present within a rule 
group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14135



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

6.4.2 Public-facing web waf-global-rulegro Ensure that an AWS 
applications are up-not-empty WAF Classic rule 
protected against group contains some 
attacks. (PCI-DSS- rules. The rule is 
v4.0) NON_COMPLIANT 

if there are no rules 
present within a rule 
group.

6.4.2 Public-facing web waf-global-rule-not- Ensure that an 
applications are empty AWS WAF global 
protected against rule contains some 
attacks. (PCI-DSS- conditions. The rule 
v4.0) is NON_COMPLIANT 

if no conditions are 
present within the 
WAF global rule.

6.5.5 Changes to all system codedeploy-lambda- Ensure that the 
components are allatonce-traffic- deployment 
managed securely. shift-disabled group for Lambda 
(PCI-DSS-v4.0) Compute Platform 

is not using the 
default deploymen 
t configuration. The 
rule is NON_COMPL 
IANT if the 
deployment group is 
using the deploymen 
t configuration 
'CodeDeployDefault 
.LambdaAllAtOnce'.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14136



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

6.5.5 Changes to all system codepipeline-deplo Ensure that the first 
components are yment-count-check deployment stage of 
managed securely. AWS CodePipeline 
(PCI-DSS-v4.0) performs at least one 

deployment. This is 
to monitor continuou 
s deployment 
activity, ensuring 
regular updates and 
identifying inactive 
or underutilized 
pipelines, which 
can signal issues 
in the developme 
nt or deployment 
process. Optionall 
y ensure that each 
of the subsequen 
t remaining stages 
deploy to more than 
the specified number 
of deployments 
(deploymentLimit).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14137



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

6.5.6 Changes to all system codedeploy-lambda- Ensure that the 
components are allatonce-traffic- deployment 
managed securely. shift-disabled group for Lambda 
(PCI-DSS-v4.0) Compute Platform 

is not using the 
default deploymen 
t configuration. The 
rule is NON_COMPL 
IANT if the 
deployment group is 
using the deploymen 
t configuration 
'CodeDeployDefault 
.LambdaAllAtOnce'.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14138



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

6.5.6 Changes to all system codepipeline-deplo Ensure that the first 
components are yment-count-check deployment stage of 
managed securely. AWS CodePipeline 
(PCI-DSS-v4.0) performs at least one 

deployment. This is 
to monitor continuou 
s deployment 
activity, ensuring 
regular updates and 
identifying inactive 
or underutilized 
pipelines, which 
can signal issues 
in the developme 
nt or deployment 
process. Optionall 
y ensure that each 
of the subsequen 
t remaining stages 
deploy to more than 
the specified number 
of deployments 
(deploymentLimit).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14139



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.1 Access to system s3-bucket-blacklis Ensure that an 
components and ted-actions-prohib Amazon Simple 
data is appropriately ited Storage Service 
defined and assigned. (Amazon S3) bucket 
(PCI-DSS-v4.0) policy does not allow 

blocklisted bucket-le 
vel and object-level 
actions on resources 
in the bucket for 
principals from other 
AWS accounts. For 
example, the rule 
checks that the 
Amazon S3 bucket 
policy does not allow 
another AWS account 
to perform any 
s3:GetBucket* actions 
and s3:DeleteObject 
on any object in the 
bucket. The rule is 
NON_COMPLIANT 
if any blocklisted 
actions are allowed 
by the Amazon S3 
bucket policy.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14140



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.1 Access to system s3-bucket-policy-not- Ensure that your 
components and more-permissive Amazon Simple 
data is appropriately Storage Service (S3) 
defined and assigned. bucket policies do 
(PCI-DSS-v4.0) not allow other inter-

account permissio 
ns than the control 
Amazon S3 bucket 
policy that you 
provide.

7.2.1 Access to system shield-drt-access Ensure that the 
components and Shield Response 
data is appropriately Team (SRT) can 
defined and assigned. access your AWS 
(PCI-DSS-v4.0) account. The rule is 

NON_COMPLIANT if 
AWS Shield Advanced 
is enabled but the 
role for SRT access is 
not configured.

7.2.1 Access to system iam-policy-in-use Ensure that an 
components and IAM policy ARN is 
data is appropriately attached to an IAM 
defined and assigned. user, or a group with 
(PCI-DSS-v4.0) one or more IAM 

users, or an IAM role 
with one or more 
trusted entity.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14141



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.1 Access to system neptune-cluster-ia Ensure that an 
components and m-database-authent Amazon Neptune 
data is appropriately ication cluster has AWS 
defined and assigned. Identity and Access 
(PCI-DSS-v4.0) Management (IAM) 

database authentic 
ation enabled. The 
rule is NON_COMPL 
IANT if an Amazon 
Neptune cluster 
does not have IAM 
database authentic 
ation enabled.

7.2.1 Access to system rds-cluster-iam-au Ensure that an 
components and thentication-enabled Amazon Relationa 
data is appropriately l Database Service 
defined and assigned. (Amazon RDS) cluster 
(PCI-DSS-v4.0) has AWS Identity and 

Access Management 
(IAM) authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
Cluster does not have 
IAM authentication 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14142



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.1 Access to system ec2-instance-profile- Ensure that an EC2 
components and attached instance has an AWS 
data is appropriately Identity and Access 
defined and assigned. Management (IAM) 
(PCI-DSS-v4.0) profile attached 

to it. The rule is 
NON_COMPLIANT 
if no IAM profile is 
attached to the EC2 
instance.

7.2.1 Access to system backup-recovery-po Ensure that a backup 
components and int-manual-deletion- vault has an attached 
data is appropriately disabled resource-based 
defined and assigned. policy which prevents 
(PCI-DSS-v4.0) deletion of recovery 

points. The rule 
is NON_COMPL 
IANT if the Backup 
Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14143



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.1 Access to system rds-instance-iam-a Ensure that an 
components and uthentication-enab Amazon Relationa 
data is appropriately led l Database Service 
defined and assigned. (Amazon RDS) 
(PCI-DSS-v4.0) instance has AWS 

Identity and Access 
Management (IAM) 
authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
instance does not 
have IAM authentic 
ation enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14144



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.2 Access to system s3-bucket-blacklis Ensure that an 
components and ted-actions-prohib Amazon Simple 
data is appropriately ited Storage Service 
defined and assigned. (Amazon S3) bucket 
(PCI-DSS-v4.0) policy does not allow 

blocklisted bucket-le 
vel and object-level 
actions on resources 
in the bucket for 
principals from other 
AWS accounts. For 
example, the rule 
checks that the 
Amazon S3 bucket 
policy does not allow 
another AWS account 
to perform any 
s3:GetBucket* actions 
and s3:DeleteObject 
on any object in the 
bucket. The rule is 
NON_COMPLIANT 
if any blocklisted 
actions are allowed 
by the Amazon S3 
bucket policy.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14145



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.2 Access to system s3-bucket-policy-not- Ensure that your 
components and more-permissive Amazon Simple 
data is appropriately Storage Service (S3) 
defined and assigned. bucket policies do 
(PCI-DSS-v4.0) not allow other inter-

account permissio 
ns than the control 
Amazon S3 bucket 
policy that you 
provide.

7.2.2 Access to system shield-drt-access Ensure that the 
components and Shield Response 
data is appropriately Team (SRT) can 
defined and assigned. access your AWS 
(PCI-DSS-v4.0) account. The rule is 

NON_COMPLIANT if 
AWS Shield Advanced 
is enabled but the 
role for SRT access is 
not configured.

7.2.2 Access to system iam-policy-in-use Ensure that an 
components and IAM policy ARN is 
data is appropriately attached to an IAM 
defined and assigned. user, or a group with 
(PCI-DSS-v4.0) one or more IAM 

users, or an IAM role 
with one or more 
trusted entity.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14146



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.2 Access to system neptune-cluster-ia Ensure that an 
components and m-database-authent Amazon Neptune 
data is appropriately ication cluster has AWS 
defined and assigned. Identity and Access 
(PCI-DSS-v4.0) Management (IAM) 

database authentic 
ation enabled. The 
rule is NON_COMPL 
IANT if an Amazon 
Neptune cluster 
does not have IAM 
database authentic 
ation enabled.

7.2.2 Access to system rds-cluster-iam-au Ensure that an 
components and thentication-enabled Amazon Relationa 
data is appropriately l Database Service 
defined and assigned. (Amazon RDS) cluster 
(PCI-DSS-v4.0) has AWS Identity and 

Access Management 
(IAM) authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
Cluster does not have 
IAM authentication 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14147



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.2 Access to system ec2-instance-profile- Ensure that an EC2 
components and attached instance has an AWS 
data is appropriately Identity and Access 
defined and assigned. Management (IAM) 
(PCI-DSS-v4.0) profile attached 

to it. The rule is 
NON_COMPLIANT 
if no IAM profile is 
attached to the EC2 
instance.

7.2.2 Access to system backup-recovery-po Ensure that a backup 
components and int-manual-deletion- vault has an attached 
data is appropriately disabled resource-based 
defined and assigned. policy which prevents 
(PCI-DSS-v4.0) deletion of recovery 

points. The rule 
is NON_COMPL 
IANT if the Backup 
Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14148



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.2 Access to system rds-instance-iam-a Ensure that an 
components and uthentication-enab Amazon Relationa 
data is appropriately led l Database Service 
defined and assigned. (Amazon RDS) 
(PCI-DSS-v4.0) instance has AWS 

Identity and Access 
Management (IAM) 
authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
instance does not 
have IAM authentic 
ation enabled.

7.2.4 Access to system secretsmanager-sec Ensure that AWS 
components and ret-unused Secrets Manager 
data is appropriately secrets have been 
defined and assigned. accessed within a 
(PCI-DSS-v4.0) specified number 

of days. The rule is 
NON_COMPLIANT if 
a secret has not been 
accessed in 'unusedFo 
rDays' number of 
days. The default 
value is 90 days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14149



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.5 Access to system s3-bucket-blacklis Ensure that an 
components and ted-actions-prohib Amazon Simple 
data is appropriately ited Storage Service 
defined and assigned. (Amazon S3) bucket 
(PCI-DSS-v4.0) policy does not allow 

blocklisted bucket-le 
vel and object-level 
actions on resources 
in the bucket for 
principals from other 
AWS accounts. For 
example, the rule 
checks that the 
Amazon S3 bucket 
policy does not allow 
another AWS account 
to perform any 
s3:GetBucket* actions 
and s3:DeleteObject 
on any object in the 
bucket. The rule is 
NON_COMPLIANT 
if any blocklisted 
actions are allowed 
by the Amazon S3 
bucket policy.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14150



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.5 Access to system s3-bucket-policy-not- Ensure that your 
components and more-permissive Amazon Simple 
data is appropriately Storage Service (S3) 
defined and assigned. bucket policies do 
(PCI-DSS-v4.0) not allow other inter-

account permissio 
ns than the control 
Amazon S3 bucket 
policy that you 
provide.

7.2.5 Access to system shield-drt-access Ensure that the 
components and Shield Response 
data is appropriately Team (SRT) can 
defined and assigned. access your AWS 
(PCI-DSS-v4.0) account. The rule is 

NON_COMPLIANT if 
AWS Shield Advanced 
is enabled but the 
role for SRT access is 
not configured.

7.2.5 Access to system iam-policy-in-use Ensure that an 
components and IAM policy ARN is 
data is appropriately attached to an IAM 
defined and assigned. user, or a group with 
(PCI-DSS-v4.0) one or more IAM 

users, or an IAM role 
with one or more 
trusted entity.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14151



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.5 Access to system neptune-cluster-ia Ensure that an 
components and m-database-authent Amazon Neptune 
data is appropriately ication cluster has AWS 
defined and assigned. Identity and Access 
(PCI-DSS-v4.0) Management (IAM) 

database authentic 
ation enabled. The 
rule is NON_COMPL 
IANT if an Amazon 
Neptune cluster 
does not have IAM 
database authentic 
ation enabled.

7.2.5 Access to system rds-cluster-iam-au Ensure that an 
components and thentication-enabled Amazon Relationa 
data is appropriately l Database Service 
defined and assigned. (Amazon RDS) cluster 
(PCI-DSS-v4.0) has AWS Identity and 

Access Management 
(IAM) authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
Cluster does not have 
IAM authentication 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14152



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.5 Access to system ec2-instance-profile- Ensure that an EC2 
components and attached instance has an AWS 
data is appropriately Identity and Access 
defined and assigned. Management (IAM) 
(PCI-DSS-v4.0) profile attached 

to it. The rule is 
NON_COMPLIANT 
if no IAM profile is 
attached to the EC2 
instance.

7.2.5 Access to system backup-recovery-po Ensure that a backup 
components and int-manual-deletion- vault has an attached 
data is appropriately disabled resource-based 
defined and assigned. policy which prevents 
(PCI-DSS-v4.0) deletion of recovery 

points. The rule 
is NON_COMPL 
IANT if the Backup 
Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14153



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.5 Access to system rds-instance-iam-a Ensure that an 
components and uthentication-enab Amazon Relationa 
data is appropriately led l Database Service 
defined and assigned. (Amazon RDS) 
(PCI-DSS-v4.0) instance has AWS 

Identity and Access 
Management (IAM) 
authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
instance does not 
have IAM authentic 
ation enabled.

7.2.5.1 Access to system secretsmanager-sec Ensure that AWS 
components and ret-unused Secrets Manager 
data is appropriately secrets have been 
defined and assigned. accessed within a 
(PCI-DSS-v4.0) specified number 

of days. The rule is 
NON_COMPLIANT if 
a secret has not been 
accessed in 'unusedFo 
rDays' number of 
days. The default 
value is 90 days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14154



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.6 Access to system s3-bucket-blacklis Ensure that an 
components and ted-actions-prohib Amazon Simple 
data is appropriately ited Storage Service 
defined and assigned. (Amazon S3) bucket 
(PCI-DSS-v4.0) policy does not allow 

blocklisted bucket-le 
vel and object-level 
actions on resources 
in the bucket for 
principals from other 
AWS accounts. For 
example, the rule 
checks that the 
Amazon S3 bucket 
policy does not allow 
another AWS account 
to perform any 
s3:GetBucket* actions 
and s3:DeleteObject 
on any object in the 
bucket. The rule is 
NON_COMPLIANT 
if any blocklisted 
actions are allowed 
by the Amazon S3 
bucket policy.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14155



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.2.6 Access to system s3-bucket-policy-not- Ensure that your 
components and more-permissive Amazon Simple 
data is appropriately Storage Service (S3) 
defined and assigned. bucket policies do 
(PCI-DSS-v4.0) not allow other inter-

account permissio 
ns than the control 
Amazon S3 bucket 
policy that you 
provide.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14156



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.1 Access to system s3-bucket-blacklis Ensure that an 
components and ted-actions-prohib Amazon Simple 
data is managed via ited Storage Service 
an access control (Amazon S3) bucket 
system(s). (PCI-DSS- policy does not allow 
v4.0) blocklisted bucket-le 

vel and object-level 
actions on resources 
in the bucket for 
principals from other 
AWS accounts. For 
example, the rule 
checks that the 
Amazon S3 bucket 
policy does not allow 
another AWS account 
to perform any 
s3:GetBucket* actions 
and s3:DeleteObject 
on any object in the 
bucket. The rule is 
NON_COMPLIANT 
if any blocklisted 
actions are allowed 
by the Amazon S3 
bucket policy.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14157



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.1 Access to system s3-bucket-policy-not- Ensure that your 
components and more-permissive Amazon Simple 
data is managed via Storage Service (S3) 
an access control bucket policies do 
system(s). (PCI-DSS- not allow other inter-
v4.0) account permissio 

ns than the control 
Amazon S3 bucket 
policy that you 
provide.

7.3.1 Access to system shield-drt-access Ensure that the 
components and Shield Response 
data is managed via Team (SRT) can 
an access control access your AWS 
system(s). (PCI-DSS- account. The rule is 
v4.0) NON_COMPLIANT if 

AWS Shield Advanced 
is enabled but the 
role for SRT access is 
not configured.

7.3.1 Access to system iam-policy-in-use Ensure that an 
components and IAM policy ARN is 
data is managed via attached to an IAM 
an access control user, or a group with 
system(s). (PCI-DSS- one or more IAM 
v4.0) users, or an IAM role 

with one or more 
trusted entity.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14158



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.1 Access to system neptune-cluster-ia Ensure that an 
components and m-database-authent Amazon Neptune 
data is managed via ication cluster has AWS 
an access control Identity and Access 
system(s). (PCI-DSS- Management (IAM) 
v4.0) database authentic 

ation enabled. The 
rule is NON_COMPL 
IANT if an Amazon 
Neptune cluster 
does not have IAM 
database authentic 
ation enabled.

7.3.1 Access to system rds-cluster-iam-au Ensure that an 
components and thentication-enabled Amazon Relationa 
data is managed via l Database Service 
an access control (Amazon RDS) cluster 
system(s). (PCI-DSS- has AWS Identity and 
v4.0) Access Management 

(IAM) authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
Cluster does not have 
IAM authentication 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14159



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.1 Access to system ec2-instance-profile- Ensure that an EC2 
components and attached instance has an AWS 
data is managed via Identity and Access 
an access control Management (IAM) 
system(s). (PCI-DSS- profile attached 
v4.0) to it. The rule is 

NON_COMPLIANT 
if no IAM profile is 
attached to the EC2 
instance.

7.3.1 Access to system backup-recovery-po Ensure that a backup 
components and int-manual-deletion- vault has an attached 
data is managed via disabled resource-based 
an access control policy which prevents 
system(s). (PCI-DSS- deletion of recovery 
v4.0) points. The rule 

is NON_COMPL 
IANT if the Backup 
Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14160



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.1 Access to system rds-instance-iam-a Ensure that an 
components and uthentication-enab Amazon Relationa 
data is managed via led l Database Service 
an access control (Amazon RDS) 
system(s). (PCI-DSS- instance has AWS 
v4.0) Identity and Access 

Management (IAM) 
authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
instance does not 
have IAM authentic 
ation enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14161



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.2 Access to system s3-bucket-blacklis Ensure that an 
components and ted-actions-prohib Amazon Simple 
data is managed via ited Storage Service 
an access control (Amazon S3) bucket 
system(s). (PCI-DSS- policy does not allow 
v4.0) blocklisted bucket-le 

vel and object-level 
actions on resources 
in the bucket for 
principals from other 
AWS accounts. For 
example, the rule 
checks that the 
Amazon S3 bucket 
policy does not allow 
another AWS account 
to perform any 
s3:GetBucket* actions 
and s3:DeleteObject 
on any object in the 
bucket. The rule is 
NON_COMPLIANT 
if any blocklisted 
actions are allowed 
by the Amazon S3 
bucket policy.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14162



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.2 Access to system s3-bucket-policy-not- Ensure that your 
components and more-permissive Amazon Simple 
data is managed via Storage Service (S3) 
an access control bucket policies do 
system(s). (PCI-DSS- not allow other inter-
v4.0) account permissio 

ns than the control 
Amazon S3 bucket 
policy that you 
provide.

7.3.2 Access to system shield-drt-access Ensure that the 
components and Shield Response 
data is managed via Team (SRT) can 
an access control access your AWS 
system(s). (PCI-DSS- account. The rule is 
v4.0) NON_COMPLIANT if 

AWS Shield Advanced 
is enabled but the 
role for SRT access is 
not configured.

7.3.2 Access to system iam-policy-in-use Ensure that an 
components and IAM policy ARN is 
data is managed via attached to an IAM 
an access control user, or a group with 
system(s). (PCI-DSS- one or more IAM 
v4.0) users, or an IAM role 

with one or more 
trusted entity.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14163



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.2 Access to system neptune-cluster-ia Ensure that an 
components and m-database-authent Amazon Neptune 
data is managed via ication cluster has AWS 
an access control Identity and Access 
system(s). (PCI-DSS- Management (IAM) 
v4.0) database authentic 

ation enabled. The 
rule is NON_COMPL 
IANT if an Amazon 
Neptune cluster 
does not have IAM 
database authentic 
ation enabled.

7.3.2 Access to system rds-cluster-iam-au Ensure that an 
components and thentication-enabled Amazon Relationa 
data is managed via l Database Service 
an access control (Amazon RDS) cluster 
system(s). (PCI-DSS- has AWS Identity and 
v4.0) Access Management 

(IAM) authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
Cluster does not have 
IAM authentication 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14164



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.2 Access to system ec2-instance-profile- Ensure that an EC2 
components and attached instance has an AWS 
data is managed via Identity and Access 
an access control Management (IAM) 
system(s). (PCI-DSS- profile attached 
v4.0) to it. The rule is 

NON_COMPLIANT 
if no IAM profile is 
attached to the EC2 
instance.

7.3.2 Access to system backup-recovery-po Ensure that a backup 
components and int-manual-deletion- vault has an attached 
data is managed via disabled resource-based 
an access control policy which prevents 
system(s). (PCI-DSS- deletion of recovery 
v4.0) points. The rule 

is NON_COMPL 
IANT if the Backup 
Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14165



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.2 Access to system rds-instance-iam-a Ensure that an 
components and uthentication-enab Amazon Relationa 
data is managed via led l Database Service 
an access control (Amazon RDS) 
system(s). (PCI-DSS- instance has AWS 
v4.0) Identity and Access 

Management (IAM) 
authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
instance does not 
have IAM authentic 
ation enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14166



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.3 Access to system s3-bucket-blacklis Ensure that an 
components and ted-actions-prohib Amazon Simple 
data is managed via ited Storage Service 
an access control (Amazon S3) bucket 
system(s). (PCI-DSS- policy does not allow 
v4.0) blocklisted bucket-le 

vel and object-level 
actions on resources 
in the bucket for 
principals from other 
AWS accounts. For 
example, the rule 
checks that the 
Amazon S3 bucket 
policy does not allow 
another AWS account 
to perform any 
s3:GetBucket* actions 
and s3:DeleteObject 
on any object in the 
bucket. The rule is 
NON_COMPLIANT 
if any blocklisted 
actions are allowed 
by the Amazon S3 
bucket policy.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14167



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.3 Access to system s3-bucket-policy-not- Ensure that your 
components and more-permissive Amazon Simple 
data is managed via Storage Service (S3) 
an access control bucket policies do 
system(s). (PCI-DSS- not allow other inter-
v4.0) account permissio 

ns than the control 
Amazon S3 bucket 
policy that you 
provide.

7.3.3 Access to system shield-drt-access Ensure that the 
components and Shield Response 
data is managed via Team (SRT) can 
an access control access your AWS 
system(s). (PCI-DSS- account. The rule is 
v4.0) NON_COMPLIANT if 

AWS Shield Advanced 
is enabled but the 
role for SRT access is 
not configured.

7.3.3 Access to system iam-policy-in-use Ensure that an 
components and IAM policy ARN is 
data is managed via attached to an IAM 
an access control user, or a group with 
system(s). (PCI-DSS- one or more IAM 
v4.0) users, or an IAM role 

with one or more 
trusted entity.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14168



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.3 Access to system neptune-cluster-ia Ensure that an 
components and m-database-authent Amazon Neptune 
data is managed via ication cluster has AWS 
an access control Identity and Access 
system(s). (PCI-DSS- Management (IAM) 
v4.0) database authentic 

ation enabled. The 
rule is NON_COMPL 
IANT if an Amazon 
Neptune cluster 
does not have IAM 
database authentic 
ation enabled.

7.3.3 Access to system rds-cluster-iam-au Ensure that an 
components and thentication-enabled Amazon Relationa 
data is managed via l Database Service 
an access control (Amazon RDS) cluster 
system(s). (PCI-DSS- has AWS Identity and 
v4.0) Access Management 

(IAM) authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
Cluster does not have 
IAM authentication 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14169



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.3 Access to system ec2-instance-profile- Ensure that an EC2 
components and attached instance has an AWS 
data is managed via Identity and Access 
an access control Management (IAM) 
system(s). (PCI-DSS- profile attached 
v4.0) to it. The rule is 

NON_COMPLIANT 
if no IAM profile is 
attached to the EC2 
instance.

7.3.3 Access to system backup-recovery-po Ensure that a backup 
components and int-manual-deletion- vault has an attached 
data is managed via disabled resource-based 
an access control policy which prevents 
system(s). (PCI-DSS- deletion of recovery 
v4.0) points. The rule 

is NON_COMPL 
IANT if the Backup 
Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14170



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

7.3.3 Access to system rds-instance-iam-a Ensure that an 
components and uthentication-enab Amazon Relationa 
data is managed via led l Database Service 
an access control (Amazon RDS) 
system(s). (PCI-DSS- instance has AWS 
v4.0) Identity and Access 

Management (IAM) 
authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
instance does not 
have IAM authentic 
ation enabled.

8.2.1 User identific iam-policy-in-use Ensure that an 
ation and related IAM policy ARN is 
accounts for users attached to an IAM 
and administrators user, or a group with 
are strictly managed one or more IAM 
throughout an users, or an IAM role 
accounts lifecycle. with one or more 
(PCI-DSS-v4.0) trusted entity.

8.2.1 User identific ec2-no-amazon-key- Ensure that running 
ation and related pair Amazon Elastic 
accounts for users Compute Cloud 
and administrators (EC2) instances 
are strictly managed are not launched 
throughout an using amazon key 
accounts lifecycle. pairs. The rule is 
(PCI-DSS-v4.0) NON_COMPLIANT if a 

running EC2 instance 
is launched with a key 
pair.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14171



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.2 User identific iam-policy-in-use Ensure that an 
ation and related IAM policy ARN is 
accounts for users attached to an IAM 
and administrators user, or a group with 
are strictly managed one or more IAM 
throughout an users, or an IAM role 
accounts lifecycle. with one or more 
(PCI-DSS-v4.0) trusted entity.

8.2.2 User identific ec2-no-amazon-key- Ensure that running 
ation and related pair Amazon Elastic 
accounts for users Compute Cloud 
and administrators (EC2) instances 
are strictly managed are not launched 
throughout an using amazon key 
accounts lifecycle. pairs. The rule is 
(PCI-DSS-v4.0) NON_COMPLIANT if a 

running EC2 instance 
is launched with a key 
pair.

8.2.2 User identific codebuild-project- Ensure that the 
ation and related envvar-awscred-che project DOES NOT 
accounts for users ck contain environment 
and administrators variables AWS_ACCES 
are strictly managed S_KEY_ID and 
throughout an AWS_SECRE 
accounts lifecycle. T_ACCESS_KEY. The 
(PCI-DSS-v4.0) rule is NON_COMPL 

IANT when the 
project environme 
nt variables contains 
plaintext credentials.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14172



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.2 User identific secretsmanager-sch Ensure that AWS 
ation and related eduled-rotation-su Secrets Manager 
accounts for users ccess-check secrets rotated 
and administrators successfully according 
are strictly managed to the rotation 
throughout an schedule. Secrets 
accounts lifecycle. Manager calculates 
(PCI-DSS-v4.0) the date the rotation 

should happen. The 
rule is NON_COMPL 
IANT if the date 
passes and the secret 
isn't rotated.

8.2.2 User identific secretsmanager-sec Ensure that AWS 
ation and related ret-periodic-rotation Secrets Manager 
accounts for users secrets have been 
and administrators rotated in the past 
are strictly managed specified number 
throughout an of days. The rule is 
accounts lifecycle. NON_COMPLIANT if 
(PCI-DSS-v4.0) a secret has not been 

rotated for more than 
maxDaysSinceRotati 
on number of days. 
The default value is 
90 days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14173



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.2 User identific secretsmanager-sec Ensure that AWS 
ation and related ret-unused Secrets Manager 
accounts for users secrets have been 
and administrators accessed within a 
are strictly managed specified number 
throughout an of days. The rule is 
accounts lifecycle. NON_COMPLIANT if 
(PCI-DSS-v4.0) a secret has not been 

accessed in 'unusedFo 
rDays' number of 
days. The default 
value is 90 days.

8.2.4 User identific iam-policy-in-use Ensure that an 
ation and related IAM policy ARN is 
accounts for users attached to an IAM 
and administrators user, or a group with 
are strictly managed one or more IAM 
throughout an users, or an IAM role 
accounts lifecycle. with one or more 
(PCI-DSS-v4.0) trusted entity.

8.2.4 User identific ec2-no-amazon-key- Ensure that running 
ation and related pair Amazon Elastic 
accounts for users Compute Cloud 
and administrators (EC2) instances 
are strictly managed are not launched 
throughout an using amazon key 
accounts lifecycle. pairs. The rule is 
(PCI-DSS-v4.0) NON_COMPLIANT if a 

running EC2 instance 
is launched with a key 
pair.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14174



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.5 User identific iam-policy-in-use Ensure that an 
ation and related IAM policy ARN is 
accounts for users attached to an IAM 
and administrators user, or a group with 
are strictly managed one or more IAM 
throughout an users, or an IAM role 
accounts lifecycle. with one or more 
(PCI-DSS-v4.0) trusted entity.

8.2.5 User identific ec2-no-amazon-key- Ensure that running 
ation and related pair Amazon Elastic 
accounts for users Compute Cloud 
and administrators (EC2) instances 
are strictly managed are not launched 
throughout an using amazon key 
accounts lifecycle. pairs. The rule is 
(PCI-DSS-v4.0) NON_COMPLIANT if a 

running EC2 instance 
is launched with a key 
pair.

8.2.6 User identific secretsmanager-sec Ensure that AWS 
ation and related ret-unused Secrets Manager 
accounts for users secrets have been 
and administrators accessed within a 
are strictly managed specified number 
throughout an of days. The rule is 
accounts lifecycle. NON_COMPLIANT if 
(PCI-DSS-v4.0) a secret has not been 

accessed in 'unusedFo 
rDays' number of 
days. The default 
value is 90 days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14175



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.7 User identific s3-bucket-blacklis Ensure that an 
ation and related ted-actions-prohib Amazon Simple 
accounts for users ited Storage Service 
and administrators (Amazon S3) bucket 
are strictly managed policy does not allow 
throughout an blocklisted bucket-le 
accounts lifecycle. vel and object-level 
(PCI-DSS-v4.0) actions on resources 

in the bucket for 
principals from other 
AWS accounts. For 
example, the rule 
checks that the 
Amazon S3 bucket 
policy does not allow 
another AWS account 
to perform any 
s3:GetBucket* actions 
and s3:DeleteObject 
on any object in the 
bucket. The rule is 
NON_COMPLIANT 
if any blocklisted 
actions are allowed 
by the Amazon S3 
bucket policy.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14176



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.7 User identific s3-bucket-policy-not- Ensure that your 
ation and related more-permissive Amazon Simple 
accounts for users Storage Service (S3) 
and administrators bucket policies do 
are strictly managed not allow other inter-
throughout an account permissio 
accounts lifecycle. ns than the control 
(PCI-DSS-v4.0) Amazon S3 bucket 

policy that you 
provide.

8.2.7 User identific shield-drt-access Ensure that the 
ation and related Shield Response 
accounts for users Team (SRT) can 
and administrators access your AWS 
are strictly managed account. The rule is 
throughout an NON_COMPLIANT if 
accounts lifecycle. AWS Shield Advanced 
(PCI-DSS-v4.0) is enabled but the 

role for SRT access is 
not configured.

8.2.7 User identific iam-policy-in-use Ensure that an 
ation and related IAM policy ARN is 
accounts for users attached to an IAM 
and administrators user, or a group with 
are strictly managed one or more IAM 
throughout an users, or an IAM role 
accounts lifecycle. with one or more 
(PCI-DSS-v4.0) trusted entity.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14177



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.7 User identific neptune-cluster-ia Ensure that an 
ation and related m-database-authent Amazon Neptune 
accounts for users ication cluster has AWS 
and administrators Identity and Access 
are strictly managed Management (IAM) 
throughout an database authentic 
accounts lifecycle. ation enabled. The 
(PCI-DSS-v4.0) rule is NON_COMPL 

IANT if an Amazon 
Neptune cluster 
does not have IAM 
database authentic 
ation enabled.

8.2.7 User identific rds-cluster-iam-au Ensure that an 
ation and related thentication-enabled Amazon Relationa 
accounts for users l Database Service 
and administrators (Amazon RDS) cluster 
are strictly managed has AWS Identity and 
throughout an Access Management 
accounts lifecycle. (IAM) authentication 
(PCI-DSS-v4.0) enabled. The rule is 

NON_COMPLIANT 
if an Amazon RDS 
Cluster does not have 
IAM authentication 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14178



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.7 User identific ec2-instance-profile- Ensure that an EC2 
ation and related attached instance has an AWS 
accounts for users Identity and Access 
and administrators Management (IAM) 
are strictly managed profile attached 
throughout an to it. The rule is 
accounts lifecycle. NON_COMPLIANT 
(PCI-DSS-v4.0) if no IAM profile is 

attached to the EC2 
instance.

8.2.7 User identific backup-recovery-po Ensure that a backup 
ation and related int-manual-deletion- vault has an attached 
accounts for users disabled resource-based 
and administrators policy which prevents 
are strictly managed deletion of recovery 
throughout an points. The rule 
accounts lifecycle. is NON_COMPL 
(PCI-DSS-v4.0) IANT if the Backup 

Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14179



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.7 User identific rds-instance-iam-a Ensure that an 
ation and related uthentication-enab Amazon Relationa 
accounts for users led l Database Service 
and administrators (Amazon RDS) 
are strictly managed instance has AWS 
throughout an Identity and Access 
accounts lifecycle. Management (IAM) 
(PCI-DSS-v4.0) authentication 

enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
instance does not 
have IAM authentic 
ation enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14180



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.8 User identific s3-bucket-blacklis Ensure that an 
ation and related ted-actions-prohib Amazon Simple 
accounts for users ited Storage Service 
and administrators (Amazon S3) bucket 
are strictly managed policy does not allow 
throughout an blocklisted bucket-le 
accounts lifecycle. vel and object-level 
(PCI-DSS-v4.0) actions on resources 

in the bucket for 
principals from other 
AWS accounts. For 
example, the rule 
checks that the 
Amazon S3 bucket 
policy does not allow 
another AWS account 
to perform any 
s3:GetBucket* actions 
and s3:DeleteObject 
on any object in the 
bucket. The rule is 
NON_COMPLIANT 
if any blocklisted 
actions are allowed 
by the Amazon S3 
bucket policy.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14181



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.8 User identific s3-bucket-policy-not- Ensure that your 
ation and related more-permissive Amazon Simple 
accounts for users Storage Service (S3) 
and administrators bucket policies do 
are strictly managed not allow other inter-
throughout an account permissio 
accounts lifecycle. ns than the control 
(PCI-DSS-v4.0) Amazon S3 bucket 

policy that you 
provide.

8.2.8 User identific shield-drt-access Ensure that the 
ation and related Shield Response 
accounts for users Team (SRT) can 
and administrators access your AWS 
are strictly managed account. The rule is 
throughout an NON_COMPLIANT if 
accounts lifecycle. AWS Shield Advanced 
(PCI-DSS-v4.0) is enabled but the 

role for SRT access is 
not configured.

8.2.8 User identific iam-policy-in-use Ensure that an 
ation and related IAM policy ARN is 
accounts for users attached to an IAM 
and administrators user, or a group with 
are strictly managed one or more IAM 
throughout an users, or an IAM role 
accounts lifecycle. with one or more 
(PCI-DSS-v4.0) trusted entity.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14182



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.8 User identific neptune-cluster-ia Ensure that an 
ation and related m-database-authent Amazon Neptune 
accounts for users ication cluster has AWS 
and administrators Identity and Access 
are strictly managed Management (IAM) 
throughout an database authentic 
accounts lifecycle. ation enabled. The 
(PCI-DSS-v4.0) rule is NON_COMPL 

IANT if an Amazon 
Neptune cluster 
does not have IAM 
database authentic 
ation enabled.

8.2.8 User identific rds-cluster-iam-au Ensure that an 
ation and related thentication-enabled Amazon Relationa 
accounts for users l Database Service 
and administrators (Amazon RDS) cluster 
are strictly managed has AWS Identity and 
throughout an Access Management 
accounts lifecycle. (IAM) authentication 
(PCI-DSS-v4.0) enabled. The rule is 

NON_COMPLIANT 
if an Amazon RDS 
Cluster does not have 
IAM authentication 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14183



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.8 User identific ec2-imdsv2-check Ensure that 
ation and related your Amazon 
accounts for users Elastic Compute 
and administrators Cloud (Amazon 
are strictly managed EC2) instance 
throughout an metadata version 
accounts lifecycle. is configured with 
(PCI-DSS-v4.0) Instance Metadata 

Service Version 2 
(IMDSv2). The rule is 
NON_COMPLIANT if 
the HttpTokens is set 
to optional.

8.2.8 User identific ec2-instance-profile- Ensure that an EC2 
ation and related attached instance has an AWS 
accounts for users Identity and Access 
and administrators Management (IAM) 
are strictly managed profile attached 
throughout an to it. The rule is 
accounts lifecycle. NON_COMPLIANT 
(PCI-DSS-v4.0) if no IAM profile is 

attached to the EC2 
instance.

8.2.8 User identific autoscaling-launch Ensure that 
ation and related config-requires-im only IMDSv2 is 
accounts for users dsv2 enabled. This rule is 
and administrators NON_COMPLIANT if 
are strictly managed the Metadata version 
throughout an is not included in the 
accounts lifecycle. launch configuration 
(PCI-DSS-v4.0) or if both Metadata 

V1 and V2 are 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14184



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.8 User identific backup-recovery-po Ensure that a backup 
ation and related int-manual-deletion- vault has an attached 
accounts for users disabled resource-based 
and administrators policy which prevents 
are strictly managed deletion of recovery 
throughout an points. The rule 
accounts lifecycle. is NON_COMPL 
(PCI-DSS-v4.0) IANT if the Backup 

Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14185



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.2.8 User identific rds-instance-iam-a Ensure that an 
ation and related uthentication-enab Amazon Relationa 
accounts for users led l Database Service 
and administrators (Amazon RDS) 
are strictly managed instance has AWS 
throughout an Identity and Access 
accounts lifecycle. Management (IAM) 
(PCI-DSS-v4.0) authentication 

enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
instance does not 
have IAM authentic 
ation enabled.

8.3.10.1 Strong authentic access-keys-rotated Ensure that active 
ation for users and IAM access keys are 
administrators is rotated (changed) 
established and within the number 
managed. (PCI-DSS- of days specified 
v4.0) in maxAccess 

KeyAge. The rule is 
NON_COMPLIANT if 
access keys are not 
rotated within the 
specified time period. 
The default value is 
90 days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14186



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.10.1 Strong authentic secretsmanager-sch Ensure that AWS 
ation for users and eduled-rotation-su Secrets Manager 
administrators is ccess-check secrets rotated 
established and successfully according 
managed. (PCI-DSS- to the rotation 
v4.0) schedule. Secrets 

Manager calculates 
the date the rotation 
should happen. The 
rule is NON_COMPL 
IANT if the date 
passes and the secret 
isn't rotated.

8.3.10.1 Strong authentic secretsmanager-sec Ensure that AWS 
ation for users and ret-periodic-rotation Secrets Manager 
administrators is secrets have been 
established and rotated in the past 
managed. (PCI-DSS- specified number 
v4.0) of days. The rule is 

NON_COMPLIANT if 
a secret has not been 
rotated for more than 
maxDaysSinceRotati 
on number of days. 
The default value is 
90 days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14187



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.11 Strong authentic iam-policy-in-use Ensure that an 
ation for users and IAM policy ARN is 
administrators is attached to an IAM 
established and user, or a group with 
managed. (PCI-DSS- one or more IAM 
v4.0) users, or an IAM role 

with one or more 
trusted entity.

8.3.11 Strong authentic ec2-no-amazon-key- Ensure that running 
ation for users and pair Amazon Elastic 
administrators is Compute Cloud 
established and (EC2) instances 
managed. (PCI-DSS- are not launched 
v4.0) using amazon key 

pairs. The rule is 
NON_COMPLIANT if a 
running EC2 instance 
is launched with a key 
pair.

8.3.2 Strong authentic athena-workgroup-e Ensure that an 
ation for users and ncrypted-at-rest Amazon Athena 
administrators is workgroup is 
established and encrypted at rest. The 
managed. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if encryptio 

n of data at rest is 
not enabled for an 
Athena workgroup.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14188



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.2 Strong authentic neptune-cluster-sn Ensure that an 
ation for users and apshot-encrypted Amazon Neptune DB 
administrators is cluster has snapshots 
established and encrypted. The rule is 
managed. (PCI-DSS- NON_COMPLIANT if a 
v4.0) Neptune cluster does 

not have snapshots 
encrypted.

8.3.2 Strong authentic redshift-cluster-kms- Ensure that Amazon 
ation for users and enabled Redshift clusters are 
administrators is using a specified AWS 
established and Key Management 
managed. (PCI-DSS- Service (AWS KMS) 
v4.0) key for encryptio 

n. The rule is 
COMPLIANT if 
encryption is enabled 
and the cluster is 
encrypted with 
the key provided 
in the kmsKeyArn 
parameter. The rule 
is NON_COMPL 
IANT if the cluster 
is not encrypted 
or encrypted with 
another key.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14189



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.2 Strong authentic codebuild-project- Ensure that an AWS 
ation for users and artifact-encryption CodeBuild project 
administrators is has encryption 
established and enabled for all of its 
managed. (PCI-DSS- artifacts. The rule is 
v4.0) NON_COMPLIANT if 

'encryptionDisabled' 
is set to 'true' for any 
primary or secondary 
(if present) artifact 
configurations.

8.3.2 Strong authentic codebuild-project-s3- Ensure that an AWS 
ation for users and logs-encrypted CodeBuild project 
administrators is configured with 
established and Amazon S3 Logs has 
managed. (PCI-DSS- encryption enabled 
v4.0) for its logs. The rule 

is NON_COMPLIANT 
if'encryptionDisab 
led' is set to'true' in 
a S3LogsConfig of a 
CodeBuild project.

8.3.2 Strong authentic dax-encryption-ena Ensure that Amazon 
ation for users and bled DynamoDB Accelerat 
administrators is or (DAX) clusters are 
established and encrypted. The rule 
managed. (PCI-DSS- is NON_COMPLIANT 
v4.0) if a DAX cluster is not 

encrypted.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14190



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.2 Strong authentic dms-redis-tls-enab Ensure that AWS 
ation for users and led Database Migration 
administrators is Service (AWS DMS) 
established and endpoints for Redis 
managed. (PCI-DSS- data stores are 
v4.0) enabled for TLS/SSL 

encryption of data 
communicated with 
other endpoints. The 
rule is NON_COMPL 
IANT if TLS/SSL 
encryption is not 
enabled.

8.3.2 Strong authentic eks-secrets-encryp Ensure that Amazon 
ation for users and ted Elastic Kubernetes 
administrators is Service clusters are 
established and configured to have 
managed. (PCI-DSS- Kubernetes secrets 
v4.0) encrypted using AWS 

Key Management 
Service (KMS) keys.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14191



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.2 Strong authentic api-gw-cache-enabl Ensure that all 
ation for users and ed-and-encrypted methods in Amazon 
administrators is API Gateway 
established and stages have cache 
managed. (PCI-DSS- enabled and cache 
v4.0) encrypted. The rule 

is NON_COMPL 
IANT if any method 
in an Amazon API 
Gateway stage is not 
configured to cache 
or the cache is not 
encrypted.

8.3.2 Strong authentic docdb-cluster-encr Ensure that storage 
ation for users and ypted encryption is enabled 
administrators is for your Amazon 
established and DocumentDB (with 
managed. (PCI-DSS- MongoDB compatibi 
v4.0) lity) clusters. The rule 

is NON_COMPLIANT 
if storage encryption 
is not enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14192



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.2 Strong authentic dynamodb-table-enc Ensure that Amazon 
ation for users and rypted-kms DynamoDB table is 
administrators is encrypted with AWS 
established and Key Management 
managed. (PCI-DSS- Service (KMS). The 
v4.0) rule is NON_COMPL 

IANT if Amazon 
DynamoDB table is 
not encrypted with 
AWS KMS. The rule 
is also NON_COMPL 
IANT if the encrypted 
AWS KMS key is not 
present in kmsKeyArn 
s input parameter.

8.3.2 Strong authentic dynamodb-table-enc Ensure that the 
ation for users and ryption-enabled Amazon DynamoDB 
administrators is tables are encrypted 
established and and checks their 
managed. (PCI-DSS- status. The rule is 
v4.0) COMPLIANT if the 

status is enabled or 
enabling.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14193



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.2 Strong authentic cloudfront-no-depr Ensure that 
ation for users and ecated-ssl-protocols CloudFront distribut 
administrators is ions are not using 
established and deprecated SSL 
managed. (PCI-DSS- protocols for HTTPS 
v4.0) communication 

between CloudFron 
t edge locations and 
custom origins. This 
rule is NON_COMPL 
IANT for a CloudFron 
t distribution if 
any'OriginSslProto 
cols' includes'SSLv3'.

8.3.2 Strong authentic cloudfront-traffic-to- Ensure that Amazon 
ation for users and origin-encrypted CloudFront distribut 
administrators is ions are encryptin 
established and g traffic to custom 
managed. (PCI-DSS- origins. The rule is 
v4.0) NON_COMPLIANT 

if'OriginProtocolP 
olicy' is'http-only' or 
if'OriginProtocolP 
olicy' is'match-viewer' 
and'ViewerProtocol 
Policy' is'allow-all'.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14194



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.2 Strong authentic cloudfront-viewer- Ensure that your 
ation for users and policy-https Amazon CloudFron 
administrators is t distributions use 
established and HTTPS (directly or 
managed. (PCI-DSS- via a redirection). The 
v4.0) rule is NON_COMPL 

IANT if the value of 
ViewerProtocolPoli 
cy is set to 'allow-al 
l' for the DefaultCa 
cheBehavior or for 
the CacheBehaviors.

8.3.2 Strong authentic codebuild-project- Ensure that the 
ation for users and envvar-awscred-che project DOES NOT 
administrators is ck contain environment 
established and variables AWS_ACCES 
managed. (PCI-DSS- S_KEY_ID and 
v4.0) AWS_SECRE 

T_ACCESS_KEY. The 
rule is NON_COMPL 
IANT when the 
project environme 
nt variables contains 
plaintext credentials.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14195



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.2 Strong authentic elb-acm-certificate- Ensure that the 
ation for users and required Classic Load 
administrators is Balancers use SSL 
established and certificates provided 
managed. (PCI-DSS- by AWS Certifica 
v4.0) te Manager. To use 

this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

8.3.2 Strong authentic dax-tls-endpoint-e Ensure that your 
ation for users and ncryption Amazon DynamoDB 
administrators is Accelerator (DAX) 
established and cluster has ClusterEn 
managed. (PCI-DSS- dpointEncryptionTy 
v4.0) pe set to TLS. The 

rule is NON_COMPL 
IANT if a DAX cluster 
is not encrypted 
by transport layer 
security (TLS).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14196



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.2 Strong authentic eks-cluster-secrets- Ensure that Amazon 
ation for users and encrypted EKS clusters are not 
administrators is configured to have 
established and Kubernetes secrets 
managed. (PCI-DSS- encrypted using 
v4.0) AWS KMS. The rule is 

NON_COMPLIANT if 
an EKS cluster does 
not have an encryptio 
nConfig resource or 
if encryptionConfig 
does not name 
secrets as a resource.

8.3.2 Strong authentic kinesis-stream-enc Ensure that Amazon 
ation for users and rypted Kinesis streams are 
administrators is encrypted at rest 
established and with server-side 
managed. (PCI-DSS- encryption. The rule 
v4.0) is NON_COMPLIANT 

for a Kinesis stream if 
'StreamEncryption' is 
not present.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14197



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.2 Strong authentic msk-in-cluster-node- Ensure that an 
ation for users and require-tls Amazon MSK cluster 
administrators is enforces encryptio 
established and n in transit using 
managed. (PCI-DSS- HTTPS (TLS) with the 
v4.0) broker nodes of the 

cluster. The rule is 
NON_COMPLIANT if 
plain text communica 
tion is enabled for in-
cluster broker node 
connections.

8.3.2 Strong authentic neptune-cluster-en Ensure that storage 
ation for users and crypted encryption is 
administrators is enabled for your 
established and Amazon Neptune DB 
managed. (PCI-DSS- clusters. The rule is 
v4.0) NON_COMPLIANT if 

storage encryption is 
not enabled.

8.3.2 Strong authentic dms-endpoint-ssl-c Ensure that AWS 
ation for users and onfigured Database Migration 
administrators is Service (AWS DMS) 
established and endpoints are 
managed. (PCI-DSS- configured with an 
v4.0) SSL connection. The 

rule is NON_COMPL 
IANT if AWS DMS 
does not have an SSL 
connection configure 
d.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14198



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.4 Strong authentic s3-bucket-blacklis Ensure that an 
ation for users and ted-actions-prohib Amazon Simple 
administrators is ited Storage Service 
established and (Amazon S3) bucket 
managed. (PCI-DSS- policy does not allow 
v4.0) blocklisted bucket-le 

vel and object-level 
actions on resources 
in the bucket for 
principals from other 
AWS accounts. For 
example, the rule 
checks that the 
Amazon S3 bucket 
policy does not allow 
another AWS account 
to perform any 
s3:GetBucket* actions 
and s3:DeleteObject 
on any object in the 
bucket. The rule is 
NON_COMPLIANT 
if any blocklisted 
actions are allowed 
by the Amazon S3 
bucket policy.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14199



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.4 Strong authentic s3-bucket-policy-not- Ensure that your 
ation for users and more-permissive Amazon Simple 
administrators is Storage Service (S3) 
established and bucket policies do 
managed. (PCI-DSS- not allow other inter-
v4.0) account permissio 

ns than the control 
Amazon S3 bucket 
policy that you 
provide.

8.3.4 Strong authentic shield-drt-access Ensure that the 
ation for users and Shield Response 
administrators is Team (SRT) can 
established and access your AWS 
managed. (PCI-DSS- account. The rule is 
v4.0) NON_COMPLIANT if 

AWS Shield Advanced 
is enabled but the 
role for SRT access is 
not configured.

8.3.4 Strong authentic iam-policy-in-use Ensure that an 
ation for users and IAM policy ARN is 
administrators is attached to an IAM 
established and user, or a group with 
managed. (PCI-DSS- one or more IAM 
v4.0) users, or an IAM role 

with one or more 
trusted entity.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14200



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.4 Strong authentic neptune-cluster-ia Ensure that an 
ation for users and m-database-authent Amazon Neptune 
administrators is ication cluster has AWS 
established and Identity and Access 
managed. (PCI-DSS- Management (IAM) 
v4.0) database authentic 

ation enabled. The 
rule is NON_COMPL 
IANT if an Amazon 
Neptune cluster 
does not have IAM 
database authentic 
ation enabled.

8.3.4 Strong authentic rds-cluster-iam-au Ensure that an 
ation for users and thentication-enabled Amazon Relationa 
administrators is l Database Service 
established and (Amazon RDS) cluster 
managed. (PCI-DSS- has AWS Identity and 
v4.0) Access Management 

(IAM) authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
Cluster does not have 
IAM authentication 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14201



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.4 Strong authentic ec2-instance-profile- Ensure that an EC2 
ation for users and attached instance has an AWS 
administrators is Identity and Access 
established and Management (IAM) 
managed. (PCI-DSS- profile attached 
v4.0) to it. The rule is 

NON_COMPLIANT 
if no IAM profile is 
attached to the EC2 
instance.

8.3.4 Strong authentic backup-recovery-po Ensure that a backup 
ation for users and int-manual-deletion- vault has an attached 
administrators is disabled resource-based 
established and policy which prevents 
managed. (PCI-DSS- deletion of recovery 
v4.0) points. The rule 

is NON_COMPL 
IANT if the Backup 
Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14202



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.4 Strong authentic rds-instance-iam-a Ensure that an 
ation for users and uthentication-enab Amazon Relationa 
administrators is led l Database Service 
established and (Amazon RDS) 
managed. (PCI-DSS- instance has AWS 
v4.0) Identity and Access 

Management (IAM) 
authentication 
enabled. The rule is 
NON_COMPLIANT 
if an Amazon RDS 
instance does not 
have IAM authentic 
ation enabled.

8.3.5 Strong authentic access-keys-rotated Ensure that active 
ation for users and IAM access keys are 
administrators is rotated (changed) 
established and within the number 
managed. (PCI-DSS- of days specified 
v4.0) in maxAccess 

KeyAge. The rule is 
NON_COMPLIANT if 
access keys are not 
rotated within the 
specified time period. 
The default value is 
90 days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14203



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.5 Strong authentic secretsmanager-sch Ensure that AWS 
ation for users and eduled-rotation-su Secrets Manager 
administrators is ccess-check secrets rotated 
established and successfully according 
managed. (PCI-DSS- to the rotation 
v4.0) schedule. Secrets 

Manager calculates 
the date the rotation 
should happen. The 
rule is NON_COMPL 
IANT if the date 
passes and the secret 
isn't rotated.

8.3.5 Strong authentic secretsmanager-sec Ensure that AWS 
ation for users and ret-periodic-rotation Secrets Manager 
administrators is secrets have been 
established and rotated in the past 
managed. (PCI-DSS- specified number 
v4.0) of days. The rule is 

NON_COMPLIANT if 
a secret has not been 
rotated for more than 
maxDaysSinceRotati 
on number of days. 
The default value is 
90 days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14204



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.7 Strong authentic access-keys-rotated Ensure that active 
ation for users and IAM access keys are 
administrators is rotated (changed) 
established and within the number 
managed. (PCI-DSS- of days specified 
v4.0) in maxAccess 

KeyAge. The rule is 
NON_COMPLIANT if 
access keys are not 
rotated within the 
specified time period. 
The default value is 
90 days.

8.3.7 Strong authentic secretsmanager-sch Ensure that AWS 
ation for users and eduled-rotation-su Secrets Manager 
administrators is ccess-check secrets rotated 
established and successfully according 
managed. (PCI-DSS- to the rotation 
v4.0) schedule. Secrets 

Manager calculates 
the date the rotation 
should happen. The 
rule is NON_COMPL 
IANT if the date 
passes and the secret 
isn't rotated.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14205



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.7 Strong authentic secretsmanager-sec Ensure that AWS 
ation for users and ret-periodic-rotation Secrets Manager 
administrators is secrets have been 
established and rotated in the past 
managed. (PCI-DSS- specified number 
v4.0) of days. The rule is 

NON_COMPLIANT if 
a secret has not been 
rotated for more than 
maxDaysSinceRotati 
on number of days. 
The default value is 
90 days.

8.3.9 Strong authentic access-keys-rotated Ensure that active 
ation for users and IAM access keys are 
administrators is rotated (changed) 
established and within the number 
managed. (PCI-DSS- of days specified 
v4.0) in maxAccess 

KeyAge. The rule is 
NON_COMPLIANT if 
access keys are not 
rotated within the 
specified time period. 
The default value is 
90 days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14206



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.3.9 Strong authentic secretsmanager-sch Ensure that AWS 
ation for users and eduled-rotation-su Secrets Manager 
administrators is ccess-check secrets rotated 
established and successfully according 
managed. (PCI-DSS- to the rotation 
v4.0) schedule. Secrets 

Manager calculates 
the date the rotation 
should happen. The 
rule is NON_COMPL 
IANT if the date 
passes and the secret 
isn't rotated.

8.3.9 Strong authentic secretsmanager-sec Ensure that AWS 
ation for users and ret-periodic-rotation Secrets Manager 
administrators is secrets have been 
established and rotated in the past 
managed. (PCI-DSS- specified number 
v4.0) of days. The rule is 

NON_COMPLIANT if 
a secret has not been 
rotated for more than 
maxDaysSinceRotati 
on number of days. 
The default value is 
90 days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14207



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.4.1 Multi-factor s3-bucket-mfa-dele Ensure that MFA 
authentication (MFA) te-enabled Delete is enabled in 
is implemented to the Amazon Simple 
secure access into the Storage Service 
CDE. (PCI-DSS-v4.0) (Amazon S3) bucket 

versioning configura 
tion. The rule is 
NON_COMPLIANT 
if MFA Delete is not 
enabled.

8.4.2 Multi-factor s3-bucket-mfa-dele Ensure that MFA 
authentication (MFA) te-enabled Delete is enabled in 
is implemented to the Amazon Simple 
secure access into the Storage Service 
CDE. (PCI-DSS-v4.0) (Amazon S3) bucket 

versioning configura 
tion. The rule is 
NON_COMPLIANT 
if MFA Delete is not 
enabled.

8.4.3 Multi-factor s3-bucket-mfa-dele Ensure that MFA 
authentication (MFA) te-enabled Delete is enabled in 
is implemented to the Amazon Simple 
secure access into the Storage Service 
CDE. (PCI-DSS-v4.0) (Amazon S3) bucket 

versioning configura 
tion. The rule is 
NON_COMPLIANT 
if MFA Delete is not 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14208



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.6.3 Use of application access-keys-rotated Ensure that active 
and system accounts IAM access keys are 
and associated rotated (changed) 
authentication within the number 
factors is strictly of days specified 
managed. (PCI-DSS- in maxAccess 
v4.0) KeyAge. The rule is 

NON_COMPLIANT if 
access keys are not 
rotated within the 
specified time period. 
The default value is 
90 days.

8.6.3 Use of application secretsmanager-sch Ensure that AWS 
and system accounts eduled-rotation-su Secrets Manager 
and associated ccess-check secrets rotated 
authentication successfully according 
factors is strictly to the rotation 
managed. (PCI-DSS- schedule. Secrets 
v4.0) Manager calculates 

the date the rotation 
should happen. The 
rule is NON_COMPL 
IANT if the date 
passes and the secret 
isn't rotated.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14209



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

8.6.3 Use of application secretsmanager-sec Ensure that AWS 
and system accounts ret-periodic-rotation Secrets Manager 
and associated secrets have been 
authentication rotated in the past 
factors is strictly specified number 
managed. (PCI-DSS- of days. The rule is 
v4.0) NON_COMPLIANT if 

a secret has not been 
rotated for more than 
maxDaysSinceRotati 
on number of days. 
The default value is 
90 days.

A1.1.2 Multi-tenant service neptune-cluster-sn Ensure that an 
providers protect and apshot-public-proh Amazon Neptune 
separate all customer ibited manual DB cluster 
environments and snapshot is not 
data. (PCI-DSS-v4.0) public. The rule is 

NON_COMPLIANT 
if any existing and 
new Neptune cluster 
snapshot is public.

A1.1.2 Multi-tenant service docdb-cluster-snap Ensure that Amazon 
providers protect and shot-public-prohib DocumentDB manual 
separate all customer ited cluster snapshots 
environments and are not public. The 
data. (PCI-DSS-v4.0) rule is NON_COMPL 

IANT if any Amazon 
DocumentDB manual 
cluster snapshots are 
public.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14210



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.2 Multi-tenant service backup-recovery-po Ensure that a backup 
providers protect and int-manual-deletion- vault has an attached 
separate all customer disabled resource-based 
environments and policy which prevents 
data. (PCI-DSS-v4.0) deletion of recovery 

points. The rule 
is NON_COMPL 
IANT if the Backup 
Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14211



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.2 Multi-tenant service emr-block-public-a Ensure that an 
providers protect and ccess account with Amazon 
separate all customer EMR has block public 
environments and access settings 
data. (PCI-DSS-v4.0) enabled. The rule is 

NON_COMPLIANT if 
BlockPublicSecurit 
yGroupRules is false, 
or if true, ports other 
than Port 22 are 
listed in Permitted 
PublicSecurityGrou 
pRuleRanges.

A1.1.2 Multi-tenant service s3-access-point-pu Ensure that Amazon 
providers protect and blic-access-blocks S3 access points have 
separate all customer block public access 
environments and settings enabled. The 
data. (PCI-DSS-v4.0) rule is NON_COMPL 

IANT if block public 
access settings are 
not enabled for S3 
access points.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14212



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.2 Multi-tenant service s3-account-level-p Ensure that the 
providers protect and ublic-access-blocks required public 
separate all customer access block settings 
environments and are configured 
data. (PCI-DSS-v4.0) from account level. 

The rule is only 
NON_COMPLIANT 
when the fields set 
below do not match 
the corresponding 
fields in the configura 
tion item.

A1.1.2 Multi-tenant service s3-bucket-mfa-dele Ensure that MFA 
providers protect and te-enabled Delete is enabled in 
separate all customer the Amazon Simple 
environments and Storage Service 
data. (PCI-DSS-v4.0) (Amazon S3) bucket 

versioning configura 
tion. The rule is 
NON_COMPLIANT 
if MFA Delete is not 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14213



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.3 Multi-tenant service api-gw-endpoint-ty Ensure that Amazon 
providers protect and pe-check API Gateway APIs are 
separate all customer of the type specified 
environments and in the rule parameter 
data. (PCI-DSS-v4.0) 'endpointConfigura 

tionType'. The rule 
returns NON_COMPL 
IANT if the REST 
API does not match 
the endpoint type 
configured in the rule 
parameter.

A1.1.3 Multi-tenant service cloudfront-associa Ensure that Amazon 
providers protect and ted-with-waf CloudFront distribut 
separate all customer ions are associate 
environments and d with either web 
data. (PCI-DSS-v4.0) application firewall 

(WAF) or WAFv2 web 
access control lists 
(ACLs). The rule is 
NON_COMPLIANT if a 
CloudFront distribut 
ion is not associated 
with a WAF web ACL.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14214



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.3 Multi-tenant service cloudfront-custom- Ensure that the 
providers protect and ssl-certificate certificate associate 
separate all customer d with an Amazon 
environments and CloudFront distribut 
data. (PCI-DSS-v4.0) ion is not the default 

SSL certificate. The 
rule is NON_COMPL 
IANT if a CloudFront 
distribution uses the 
default SSL certifica 
te.

A1.1.3 Multi-tenant service netfw-policy-defau Ensure that an AWS 
providers protect and lt-action-fragment- Network Firewall 
separate all customer packets policy is configured 
environments and with a user defined 
data. (PCI-DSS-v4.0) stateless default 

action for fragmente 
d packets. The rule 
is NON_COMPLIANT 
if stateless default 
action for fragmente 
d packets does not 
match with user 
defined default 
action.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14215



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.3 Multi-tenant service rds-db-security-gr Ensure that the 
providers protect and oup-not-allowed Amazon Relationa 
separate all customer l Database Service 
environments and (Amazon RDS) DB 
data. (PCI-DSS-v4.0) security groups is the 

default one. The rule 
is NON_COMPLIANT 
if there are any DB 
security groups that 
are not the default 
DB security group.

A1.1.3 Multi-tenant service ec2-transit-gatewa Ensure that Amazon 
providers protect and y-auto-vpc-attach- Elastic Compute 
separate all customer disabled Cloud (Amazon EC2) 
environments and Transit Gateways do 
data. (PCI-DSS-v4.0) not have 'AutoAcce 

ptSharedAttachment 
s' enabled. The rule is 
NON_COMPLIANT for 
a Transit Gateway if 
'AutoAcceptSharedA 
ttachments' is set to 
'enable'.

A1.1.3 Multi-tenant service eks-endpoint-no-pu Ensure that the 
providers protect and blic-access Amazon Elastic 
separate all customer Kubernetes Service 
environments and (Amazon EKS) 
data. (PCI-DSS-v4.0) endpoint is not 

publicly accessibl 
e. The rule is 
NON_COMPLIANT 
if the endpoint is 
publicly accessible.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14216



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.3 Multi-tenant service restricted-ssh Note: For this rule, 
providers protect and the rule identifie 
separate all customer r (INCOMING 
environments and _SSH_DISABLED) 
data. (PCI-DSS-v4.0) and rule name 

(restricted-ssh) are 
different. Ensure 
that the incoming 
SSH traffic for the 
security groups is 
accessible. The rule 
is COMPLIANT if the 
IP addresses of the 
incoming SSH traffic 
in the security groups 
are restricted (CIDR 
other than 0.0.0.0/0 
or ::/0). Otherwise, 
NON_COMPLIANT.

A1.1.3 Multi-tenant service appsync-associated- Ensure that AWS 
providers protect and with-waf AppSync APIs are 
separate all customer associated with 
environments and AWS WAFv2 web 
data. (PCI-DSS-v4.0) access control lists 

(ACLs). The rule is 
NON_COMPLIANT for 
an AWS AppSync API 
if it is not associated 
with a web ACL.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14217



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.3 Multi-tenant service docdb-cluster-snap Ensure that Amazon 
providers protect and shot-public-prohib DocumentDB manual 
separate all customer ited cluster snapshots 
environments and are not public. The 
data. (PCI-DSS-v4.0) rule is NON_COMPL 

IANT if any Amazon 
DocumentDB manual 
cluster snapshots are 
public.

A1.1.3 Multi-tenant service codebuild-project- Ensure that the 
providers protect and source-repo-url-check Bitbucket source 
separate all customer repository URL 
environments and DOES NOT contain 
data. (PCI-DSS-v4.0) sign-in credentials 

or not. The rule is 
NON_COMPLIANT if 
the URL contains any 
sign-in information 
and COMPLIANT if it 
doesn't.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14218



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.3 Multi-tenant service elb-acm-certificate- Ensure that the 
providers protect and required Classic Load 
separate all customer Balancers use SSL 
environments and certificates provided 
data. (PCI-DSS-v4.0) by AWS Certifica 

te Manager. To use 
this rule, use an SSL 
or HTTPS listener 
with your Classic 
Load Balancer. Note 
- this rule is only 
applicable to Classic 
Load Balancers. 
This rule does not 
check Applicati 
on Load Balancers 
and Network Load 
Balancers.

A1.1.3 Multi-tenant service emr-block-public-a Ensure that an 
providers protect and ccess account with Amazon 
separate all customer EMR has block public 
environments and access settings 
data. (PCI-DSS-v4.0) enabled. The rule is 

NON_COMPLIANT if 
BlockPublicSecurit 
yGroupRules is false, 
or if true, ports other 
than Port 22 are 
listed in Permitted 
PublicSecurityGrou 
pRuleRanges.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14219



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.3 Multi-tenant service nacl-no-unrestricted- Ensure that default 
providers protect and ssh-rdp ports for SSH/RDP 
separate all customer ingress traffic for 
environments and network access 
data. (PCI-DSS-v4.0) control lists (NACLs) 

are restricted. The 
rule is NON_COMPL 
IANT if a NACL 
inbound entry allows 
a source TCP or UDP 
CIDR block for ports 
22 or 3389.

A1.1.3 Multi-tenant service waf-global-webacl- Ensure that a WAF 
providers protect and not-empty Global Web ACL 
separate all customer contains some 
environments and WAF rules or rule 
data. (PCI-DSS-v4.0) groups. This rule is 

NON_COMPLIANT if 
a Web ACL does not 
contain any WAF rule 
or rule group.

A1.1.3 Multi-tenant service waf-global-rulegro Ensure that an AWS 
providers protect and up-not-empty WAF Classic rule 
separate all customer group contains some 
environments and rules. The rule is 
data. (PCI-DSS-v4.0) NON_COMPLIANT 

if there are no rules 
present within a rule 
group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14220



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.3 Multi-tenant service waf-global-rule-not- Ensure that an 
providers protect and empty AWS WAF global 
separate all customer rule contains some 
environments and conditions. The rule 
data. (PCI-DSS-v4.0) is NON_COMPLIANT 

if no conditions are 
present within the 
WAF global rule.

A1.1.3 Multi-tenant service ec2-client-vpn-not- Ensure that the 
providers protect and authorize-all AWS Client VPN 
separate all customer authorization rules 
environments and does not authorize 
data. (PCI-DSS-v4.0) connection access for 

all clients. The rule is 
NON_COMPLIANT if 
'AccessAll' is present 
and set to true.

A1.1.3 Multi-tenant service internet-gateway-a Ensure that internet 
providers protect and uthorized-vpc-only gateways are 
separate all customer attached to an 
environments and authorized virtual 
data. (PCI-DSS-v4.0) private cloud 

(Amazon VPC). The 
rule is NON_COMPL 
IANT if internet 
gateways are 
attached to an 
unauthorized VPC.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14221



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.1.3 Multi-tenant service s3-access-point-pu Ensure that Amazon 
providers protect and blic-access-blocks S3 access points have 
separate all customer block public access 
environments and settings enabled. The 
data. (PCI-DSS-v4.0) rule is NON_COMPL 

IANT if block public 
access settings are 
not enabled for S3 
access points.

A1.1.3 Multi-tenant service s3-account-level-p Ensure that the 
providers protect and ublic-access-blocks required public 
separate all customer access block settings 
environments and are configured 
data. (PCI-DSS-v4.0) from account level. 

The rule is only 
NON_COMPLIANT 
when the fields set 
below do not match 
the corresponding 
fields in the configura 
tion item.

A1.2.1 Multi-tenant service api-gwv2-access-lo Ensure that Amazon 
providers facilitate gs-enabled API Gateway V2 
logging and incident stages have access 
response for all logging enabled. The 
customers. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if 'accessLo 

gSettings' is not 
present in Stage 
configuration.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14222



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.2.1 Multi-tenant service api-gw-xray-enabled Ensure that AWS 
providers facilitate X-Ray tracing is 
logging and incident enabled on Amazon 
response for all API Gateway REST 
customers. (PCI-DSS- APIs. The rule is 
v4.0) COMPLIANT if X-Ray 

tracing is enabled 
and NON_COMPL 
IANT otherwise.

A1.2.1 Multi-tenant service cloudfront-accessl Ensure that Amazon 
providers facilitate ogs-enabled CloudFront distribut 
logging and incident ions are configure 
response for all d to deliver access 
customers. (PCI-DSS- logs to an Amazon 
v4.0) S3 bucket. The rule is 

NON_COMPLIANT if a 
CloudFront distribut 
ion does not have 
logging configured.

A1.2.1 Multi-tenant service cloudtrail-security- Ensure that there 
providers facilitate trail-enabled is at least one AWS 
logging and incident CloudTrail trail 
response for all defined with security 
customers. (PCI-DSS- best practices. This 
v4.0) rule is COMPLIANT if 

there is at least one 
trail that meets all of 
the following:

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14223



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.2.1 Multi-tenant service neptune-cluster-cl Ensure that an 
providers facilitate oudwatch-log-expor Amazon Neptune 
logging and incident t-enabled cluster has 
response for all CloudWatch log 
customers. (PCI-DSS- export enabled for 
v4.0) audit logs. The rule is 

NON_COMPLIANT if a 
Neptune cluster does 
not have CloudWatc 
h log export enabled 
for audit logs.

A1.2.1 Multi-tenant service ecs-task-definition- Ensure that logConfig 
providers facilitate log-configuration uration is set on 
logging and incident active ECS Task 
response for all Definitions. This 
customers. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if an active 

ECSTaskDefinition 
does not have the 
logConfiguration 
resource defined 
or the value for 
logConfiguration is 
null in at least one 
container definition.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14224



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.2.1 Multi-tenant service cloudtrail-enabled Note: For this rule, 
providers facilitate the rule identifie 
logging and incident r (CLOUD_TR 
response for all AIL_ENABLED) and 
customers. (PCI-DSS- rule name (cloudtrail-
v4.0) enabled) are different 

. Ensure that an AWS 
CloudTrail trail is 
enabled in your AWS 
account. The rule is 
NON_COMPLIANT if 
a trail is not enabled. 
Optionally, the rule 
checks a specific 
S3 bucket, Amazon 
Simple Notification 
Service (Amazon SNS) 
topic, and CloudWatc 
h log group.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14225



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.2.1 Multi-tenant service multi-region-cloud Note: for this rule, 
providers facilitate trail-enabled the rule identifie 
logging and incident r (MULTI_RE 
response for all GION_CLOU 
customers. (PCI-DSS- D_TRAIL_ENABLED) 
v4.0) and rule name 

(multi-region-clou 
dtrail-enabled) are 
different. Ensure 
that there is at least 
one multi-region 
AWS CloudTrail. The 
rule is NON_COMPL 
IANT if the trails 
do not match input 
parameters. The rule 
is NON_COMPLIANT 
if the ExcludeMa 
nagementEventSourc 
es field is not empty 
or if AWS CloudTrai 
l is configured to 
exclude managemen 
t events such as 
AWS KMS events or 
Amazon RDS Data 
API events.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14226



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.2.1 Multi-tenant service appsync-logging-en Ensure that an AWS 
providers facilitate abled AppSync API has 
logging and incident logging enabled. The 
response for all rule is NON_COMPL 
customers. (PCI-DSS- IANT if logging is not 
v4.0) enabled, or 'fieldLog 

Level' is neither 
ERROR nor ALL.

A1.2.1 Multi-tenant service waf-classic-logging- Ensure that logging is 
providers facilitate enabled enabled on AWS WAF 
logging and incident classic global web 
response for all access control lists 
customers. (PCI-DSS- (web ACLs). The rule 
v4.0) is NON_COMPLIANT 

for a global web ACL, 
if it does not have 
logging enabled.

A1.2.1 Multi-tenant service mq-cloudwatch-audi Ensure that Amazon 
providers facilitate t-logging-enabled MQ brokers have 
logging and incident Amazon CloudWatc 
response for all h audit logging 
customers. (PCI-DSS- enabled. The rule is 
v4.0) NON_COMPLIANT 

if a broker does not 
have audit logging 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14227



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.2.1 Multi-tenant service mq-cloudwatch-audi Ensure that an 
providers facilitate t-log-enabled Amazon MQ broker 
logging and incident has CloudWatch audit 
response for all logging enabled. The 
customers. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if the broker 

does not have audit 
logging enabled.

A1.2.1 Multi-tenant service eks-cluster-logging- Ensure that an 
providers facilitate enabled Amazon Elastic 
logging and incident Kubernetes Service 
response for all (Amazon EKS) cluster 
customers. (PCI-DSS- is configured with 
v4.0) logging enabled. The 

rule is NON_COMPL 
IANT if logging for 
Amazon EKS clusters 
is not enabled for all 
log types.

A1.2.1 Multi-tenant service elastic-beanstalk- Ensure that AWS 
providers facilitate logs-to-cloudwatch Elastic Beanstalk 
logging and incident environments 
response for all are configured 
customers. (PCI-DSS- to send logs to 
v4.0) Amazon CloudWatc 

h Logs. The rule 
is NON_COMPL 
IANT if the value 
of `StreamLogs` is 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14228



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A1.2.1 Multi-tenant service step-functions-sta Ensure that AWS 
providers facilitate te-machine-logging- Step Functions 
logging and incident enabled machine has logging 
response for all enabled. The rule is 
customers. (PCI-DSS- NON_COMPLIANT if 
v4.0) a state machine does 

not have logging 
enabled or the 
logging configura 
tion is not at the 
minimum level 
provided.

A1.2.1 Multi-tenant service netfw-logging-enab Ensure that AWS 
providers facilitate led Network Firewall 
logging and incident firewalls have logging 
response for all enabled. The rule is 
customers. (PCI-DSS- NON_COMPLIANT if 
v4.0) a logging type is not 

configured. You can 
specify which logging 
type you want the 
rule to check.

A1.2.3 Multi-tenant service security-account-i Ensure that you have 
providers facilitate nformation-provided provided security 
logging and incident contact information 
response for all for your AWS account 
customers. (PCI-DSS- contacts. The rule is 
v4.0) NON_COMPLIANT 

if security contact 
information within 
the account is not 
provided.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14229



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.2.5.1 PCI DSS scope is macie-auto-sensitive- Ensure that 
documented and data-discovery-check automated sensitive 
validated. (PCI-DSS- data discovery is 
v4.0) enabled for Amazon 

Macie. The rule is 
NON_COMPLIANT if 
automated sensitive 
data discovery 
is disabled. The 
rule is APPLICABL 
E for administr 
ator accounts and 
NOT_APPLICABLE for 
member accounts.

A3.2.5.1 PCI DSS scope is macie-status-check Ensure that Amazon 
documented and Macie is enabled in 
validated. (PCI-DSS- your account per 
v4.0) region. The rule 

is NON_COMPL 
IANT if the 'status' 
attribute is not set to 
'ENABLED'.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14230



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.2.5.2 PCI DSS scope is macie-auto-sensitive- Ensure that 
documented and data-discovery-check automated sensitive 
validated. (PCI-DSS- data discovery is 
v4.0) enabled for Amazon 

Macie. The rule is 
NON_COMPLIANT if 
automated sensitive 
data discovery 
is disabled. The 
rule is APPLICABL 
E for administr 
ator accounts and 
NOT_APPLICABLE for 
member accounts.

A3.2.5.2 PCI DSS scope is macie-status-check Ensure that Amazon 
documented and Macie is enabled in 
validated. (PCI-DSS- your account per 
v4.0) region. The rule 

is NON_COMPL 
IANT if the 'status' 
attribute is not set to 
'ENABLED'.

A3.3.1 PCI DSS is incorpora api-gw-xray-enabled Ensure that AWS 
ted into business-as- X-Ray tracing is 
usual (BAU) activities. enabled on Amazon 
(PCI-DSS-v4.0) API Gateway REST 

APIs. The rule is 
COMPLIANT if X-Ray 
tracing is enabled 
and NON_COMPL 
IANT otherwise.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14231



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.3.1 PCI DSS is incorpora cloudformation-sta Ensure that your 
ted into business-as- ck-notification-check CloudFormation 
usual (BAU) activities. stacks send event 
(PCI-DSS-v4.0) notifications to 

an Amazon SNS 
topic. Optionally 
ensure that specified 
Amazon SNS topics 
are used. The rule is 
NON_COMPLIANT 
if CloudFormation 
stacks do not send 
notifications.

A3.3.1 PCI DSS is incorpora ec2-instance-detai Ensure that detailed 
ted into business-as- led-monitoring-ena monitoring is 
usual (BAU) activities. bled enabled for EC2 
(PCI-DSS-v4.0) instances. The rule is 

NON_COMPLIANT if 
detailed monitoring 
is not enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14232



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.3.1 PCI DSS is incorpora cloudwatch-alarm-a Ensure that 
ted into business-as- ction-check CloudWatch alarms 
usual (BAU) activities. have an action 
(PCI-DSS-v4.0) configured for the 

ALARM, INSUFFICI 
ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

A3.3.1 PCI DSS is incorpora cloudwatch-alarm-a Ensure that 
ted into business-as- ction-check CloudWatch alarms 
usual (BAU) activities. have an action 
(PCI-DSS-v4.0) configured for the 

ALARM, INSUFFICI 
ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14233



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.3.1 PCI DSS is incorpora cloudwatch-alarm-a Ensure that 
ted into business-as- ction-check CloudWatch alarms 
usual (BAU) activities. have an action 
(PCI-DSS-v4.0) configured for the 

ALARM, INSUFFICI 
ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

A3.3.1 PCI DSS is incorpora cloudwatch-alarm-a Ensure that 
ted into business-as- ction-check CloudWatch alarms 
usual (BAU) activities. have an action 
(PCI-DSS-v4.0) configured for the 

ALARM, INSUFFICI 
ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14234



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.3.1 PCI DSS is incorpora cloudwatch-alarm-r Ensure that a 
ted into business-as- esource-check resource type has a 
usual (BAU) activities. CloudWatch alarm 
(PCI-DSS-v4.0) for the named metric. 

For resource type, 
you can specify 
EBS volumes, EC2 
instances, Amazon 
RDS clusters, or S3 
buckets. The rule is 
COMPLIANT if the 
named metric has 
a resource ID and 
CloudWatch alarm.

A3.3.1 PCI DSS is incorpora cloudwatch-alarm-s Ensure that 
ted into business-as- ettings-check CloudWatch alarms 
usual (BAU) activities. with the given metric 
(PCI-DSS-v4.0) name have the 

specified settings.

A3.3.1 PCI DSS is incorpora wafv2-rulegroup-lo Ensure that Amazon 
ted into business-as- gging-enabled CloudWatch security 
usual (BAU) activities. metrics collectio 
(PCI-DSS-v4.0) n on AWS WAFv2 

rule groups is 
enabled. The rule is 
NON_COMPLIANT if 
the 'VisibilityConfig. 
CloudWatchMetricsE 
nabled' field is set to 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14235



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.3.1 PCI DSS is incorpora sns-topic-message- Ensure that Amazon 
ted into business-as- delivery-notification- Simple Notification 
usual (BAU) activities. enabled Service (SNS) logging 
(PCI-DSS-v4.0) is enabled for the 

delivery status of 
notification messages 
sent to a topic for 
the endpoints. The 
rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

A3.4.1 Logical access to neptune-cluster-sn Ensure that an 
the cardholder apshot-public-proh Amazon Neptune 
data environment ibited manual DB cluster 
is controlled and snapshot is not 
managed. (PCI-DSS- public. The rule is 
v4.0) NON_COMPLIANT 

if any existing and 
new Neptune cluster 
snapshot is public.

A3.4.1 Logical access to docdb-cluster-snap Ensure that Amazon 
the cardholder shot-public-prohib DocumentDB manual 
data environment ited cluster snapshots 
is controlled and are not public. The 
managed. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if any Amazon 

DocumentDB manual 
cluster snapshots are 
public.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14236



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.4.1 Logical access to backup-recovery-po Ensure that a backup 
the cardholder int-manual-deletion- vault has an attached 
data environment disabled resource-based 
is controlled and policy which prevents 
managed. (PCI-DSS- deletion of recovery 
v4.0) points. The rule 

is NON_COMPL 
IANT if the Backup 
Vault does not 
have resource- 
based policies or 
has policies without 
a suitable 'Deny' 
statement (statemen 
t with backup:De 
leteRecoveryPoint, 
backup:UpdateRecov 
eryPointLifecycle, 
and backup:Pu 
tBackupVaultAccess 
Policy permissions).

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14237



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.4.1 Logical access to emr-block-public-a Ensure that an 
the cardholder ccess account with Amazon 
data environment EMR has block public 
is controlled and access settings 
managed. (PCI-DSS- enabled. The rule is 
v4.0) NON_COMPLIANT if 

BlockPublicSecurit 
yGroupRules is false, 
or if true, ports other 
than Port 22 are 
listed in Permitted 
PublicSecurityGrou 
pRuleRanges.

A3.4.1 Logical access to secretsmanager-sec Ensure that AWS 
the cardholder ret-unused Secrets Manager 
data environment secrets have been 
is controlled and accessed within a 
managed. (PCI-DSS- specified number 
v4.0) of days. The rule is 

NON_COMPLIANT if 
a secret has not been 
accessed in 'unusedFo 
rDays' number of 
days. The default 
value is 90 days.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14238



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.4.1 Logical access to s3-access-point-pu Ensure that Amazon 
the cardholder blic-access-blocks S3 access points have 
data environment block public access 
is controlled and settings enabled. The 
managed. (PCI-DSS- rule is NON_COMPL 
v4.0) IANT if block public 

access settings are 
not enabled for S3 
access points.

A3.4.1 Logical access to s3-account-level-p Ensure that the 
the cardholder ublic-access-blocks required public 
data environment access block settings 
is controlled and are configured 
managed. (PCI-DSS- from account level. 
v4.0) The rule is only 

NON_COMPLIANT 
when the fields set 
below do not match 
the corresponding 
fields in the configura 
tion item.

A3.4.1 Logical access to s3-bucket-mfa-dele Ensure that MFA 
the cardholder te-enabled Delete is enabled in 
data environment the Amazon Simple 
is controlled and Storage Service 
managed. (PCI-DSS- (Amazon S3) bucket 
v4.0) versioning configura 

tion. The rule is 
NON_COMPLIANT 
if MFA Delete is not 
enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14239



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.5.1 Suspicious events api-gw-xray-enabled Ensure that AWS 
are identified and X-Ray tracing is 
responded to. (PCI- enabled on Amazon 
DSS-v4.0) API Gateway REST 

APIs. The rule is 
COMPLIANT if X-Ray 
tracing is enabled 
and NON_COMPL 
IANT otherwise.

A3.5.1 Suspicious events cloudformation-sta Ensure that your 
are identified and ck-notification-check CloudFormation 
responded to. (PCI- stacks send event 
DSS-v4.0) notifications to 

an Amazon SNS 
topic. Optionally 
ensure that specified 
Amazon SNS topics 
are used. The rule is 
NON_COMPLIANT 
if CloudFormation 
stacks do not send 
notifications.

A3.5.1 Suspicious events ec2-instance-detai Ensure that detailed 
are identified and led-monitoring-ena monitoring is 
responded to. (PCI- bled enabled for EC2 
DSS-v4.0) instances. The rule is 

NON_COMPLIANT if 
detailed monitoring 
is not enabled.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14240



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.5.1 Suspicious events cloudwatch-alarm-a Ensure that 
are identified and ction-check CloudWatch alarms 
responded to. (PCI- have an action 
DSS-v4.0) configured for the 

ALARM, INSUFFICI 
ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

A3.5.1 Suspicious events cloudwatch-alarm-a Ensure that 
are identified and ction-check CloudWatch alarms 
responded to. (PCI- have an action 
DSS-v4.0) configured for the 

ALARM, INSUFFICI 
ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14241



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.5.1 Suspicious events cloudwatch-alarm-a Ensure that 
are identified and ction-check CloudWatch alarms 
responded to. (PCI- have an action 
DSS-v4.0) configured for the 

ALARM, INSUFFICI 
ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

A3.5.1 Suspicious events cloudwatch-alarm-a Ensure that 
are identified and ction-check CloudWatch alarms 
responded to. (PCI- have an action 
DSS-v4.0) configured for the 

ALARM, INSUFFICI 
ENT_DATA, or OK 
state. Optionall 
y ensure that any 
actions match a 
named ARN. The 
rule is NON_COMPL 
IANT if there is no 
action specified for 
the alarm or optional 
parameter.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14242



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.5.1 Suspicious events cloudwatch-alarm-r Ensure that a 
are identified and esource-check resource type has a 
responded to. (PCI- CloudWatch alarm 
DSS-v4.0) for the named metric. 

For resource type, 
you can specify 
EBS volumes, EC2 
instances, Amazon 
RDS clusters, or S3 
buckets. The rule is 
COMPLIANT if the 
named metric has 
a resource ID and 
CloudWatch alarm.

A3.5.1 Suspicious events cloudwatch-alarm-s Ensure that 
are identified and ettings-check CloudWatch alarms 
responded to. (PCI- with the given metric 
DSS-v4.0) name have the 

specified settings.

A3.5.1 Suspicious events wafv2-rulegroup-lo Ensure that Amazon 
are identified and gging-enabled CloudWatch security 
responded to. (PCI- metrics collectio 
DSS-v4.0) n on AWS WAFv2 

rule groups is 
enabled. The rule is 
NON_COMPLIANT if 
the 'VisibilityConfig. 
CloudWatchMetricsE 
nabled' field is set to 
false.

Operational Best Practices for PCI DSS 4.0 (Including global resource types) 14243



AWS Config Developer Guide

Control ID Control Description AWS Config Rule Guidance

A3.5.1 Suspicious events sns-topic-message- Ensure that Amazon 
are identified and delivery-notification- Simple Notification 
responded to. (PCI- enabled Service (SNS) logging 
DSS-v4.0) is enabled for the 

delivery status of 
notification messages 
sent to a topic for 
the endpoints. The 
rule is NON_COMPL 
IANT if the delivery 
status notification 
for messages is not 
enabled.

Template

The template is available on GitHub: Operational Best Practices for PCI DSS 4.0 (Including global 
resource types).

Operational Best Practices for Publicly Accessible Resources

This conformance pack helps identify resources that may be publicly accessible.

For a list of all managed rules supported by AWS Config, see List of AWS Config Managed Rules.

See the Parameters section in the following template for the names and descriptions of the 
required parameters.

The template is available on GitHub: Operational Best Practices for Publicly Accessible Resources.

Operational Best Practices for RBI Cyber Security Framework for UCBs

Conformance packs provide a general-purpose compliance framework designed to enable you 
to create security, operational or cost-optimization governance checks using managed or custom 
AWS Config rules and AWS Config remediation actions. Conformance Packs, as sample templates, 
are not designed to fully ensure compliance with a specific governance or compliance standard. 

Operational Best Practices for Publicly Accessible Resources 14244